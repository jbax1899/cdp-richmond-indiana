/*! For license information please see main.2d0b5118.chunk.js.LICENSE.txt */
(this["webpackJsonpcdp-richmond-(in)"]=this["webpackJsonpcdp-richmond-(in)"]||[]).push([[0],{145:function(e,t,n){"use strict";(function(e,r){n.d(t,"a",function(){return $y}),n.d(t,"b",function(){return X});var i=n(169),s=n(91),o=n(10),a=n(0),c=n.n(a),l=n(11),u=n(28),h=n(7),d=n(83),m=n(170),p=n.n(m),f=n(171),g=n(172),y=n(98),v=n.n(y),b=n(74),_=n(139),w=n(153),E=n(294),S=n(92),I=n(43),C=n(73),T=n(181),k=n(101),x=n(138),N=n.n(x),A=n(102),R=n(99);const D=["keyGrams"];"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof e||"undefined"!==typeof self&&self;var O,P,M,j,L,V={exports:{}},B={},F=c.a,U=60103;if(B.Fragment=60107,"function"===typeof Symbol&&Symbol.for){var z=Symbol.for;U=z("react.element"),B.Fragment=z("react.fragment")}var q=F.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,G=Object.prototype.hasOwnProperty,H={key:!0,ref:!0,__self:!0,__source:!0};function W(e,t,n){var r,i={},s=null,o=null;for(r in void 0!==n&&(s=""+n),void 0!==t.key&&(s=""+t.key),void 0!==t.ref&&(o=t.ref),t)G.call(t,r)&&!H.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:U,type:e,key:s,ref:o,props:i,_owner:q.current}}B.jsx=W,B.jsxs=W,V.exports=B;const K=V.exports.jsx,Q=V.exports.jsxs,Y=V.exports.Fragment,J=Object(a.createContext)({firebaseConfig:{options:{projectId:"cdp-seattle-staging-dbengvtn"},settings:{}},municipality:{name:"Seattle Staging",timeZone:"America/Los_Angeles",footerLinksSections:[]}}),X=e=>{let{appConfig:t,children:n}=e;return K(J.Provider,{value:t,children:n})},Z=()=>{const e=Object(a.useContext)(J);if(void 0===e)throw new Error("useAppConfigContext must be used within a AppConfigProvider");return e},$=Object(a.createContext)({language:"en",setLanguage:()=>{}}),ee=e=>{let{languageConfig:t,children:n}=e;return K($.Provider,{value:t,children:n})},te=()=>{const e=Object(a.useContext)($);if(void 0===e)throw new Error("useLanguageConfigContext must be used within a LanguageConfigProvider");return e};function ne(e){Object(a.useEffect)(()=>{if(null==e||""===e)return;const t=document.title;return document.title=e,()=>{document.title=t}},[e])}const re=new p.a({en:{number_approved:"{number} Approved",number_rejected:"{number} Rejected",number_non_voting:"{number} Non-Voting",meeting_votes_caption:"Click each row to see how council members voted",legislation:"Legislation",council_decision:"Council Decision",votes:"Votes",meeting:"Meeting",persons_vote:"{name}'s Vote",en:"English",es:"Espa\xf1ol",de:"Deutsche",keywords:"Keywords",select_language:"Select Language",same:"same",committee:"Committee",chair:"Chair",tenure:"Tenure",bills_sponsored:"bill(s) sponsored",see_documents:"See Documents",jump_to_sentence_video:"Jump to sentence in video",jump_to_sentence_transcript:"Jump to sentence in transcript",search_transcript:"Search transcript",search_transcript_placeholder:"Search transcript...",number_of_results:"{number} result(s)",clear:"Clear",save:"Save",about:"About",search:"Search",advanced_options:"Advanced Options",copyright_notice:"Copyright \xa9 Individual contributors, {date_range}.",content_license_prefix:"Content available under a ",content_license_link:"https://creativecommons.org/licenses/by/4.0/",content_license_link_text:"Creative Commons Attribution 4.0 International License",tools_license_prefix:"Council Data Project tools are licensed under ",styled_using_prefix:"Styled using ",artwork_provided_by_prefix:"Artwork provided by ",passed:"Passed",failed:"Failed",approve:"Approve",reject:"Reject",abstain_approve:"Abstain (Approve)",abstain_non_voting:"Abstain (Non-Voting)",abstain_reject:"Abstain (Reject)",absent_approve:"Absent (Approve)",absent_non_voting:"Absent (Non-Voting)",absent_reject:"Absent (Reject)",rejected:"Rejected",adopted:"Adopted",in_progress:"In Progress",example_prefix:"Example: ",search_topic_placeholder:"Search for a topic...",search_municipality_name:"Search {municipality_name}",events:"Events",links:"Links",people:"People",council_data_project:"Council Data Project",transcript:"Transcript",agenda:"Agenda",session:"Session",date:"Date",newest_first:"Newest First",oldest_first:"Oldest First",most_relevant_first:"Most relevant first",closest_match_first:"Closest match first",most_relevant:"Most relevant",search_results:"Search Results",event_search_results:"Event search results",no_results_found:"No results found",show_more:"Show more...",legislation_sponsored:"Legislation Sponsored",menu:"Menu",persons_voting_record:"{person_name}'s Voting Record",contact:"Contact",terms:"Terms",committee_membership:"Committee Membership",former_committee_membership:"Former Committee Membership",committees:"Committees",visit_persons_website:"Visit {person_name}'s website",alternate:"Alternate",councilmember:"Councilmember",member:"Member",council_president:"Council President",vice_chair:"Vice Chair",supervisor:"Supervisor",active:"active",inactive:"inactive",latest_vote:"Latest Vote",history:"History",minutes:"Minutes",no_minutes_recorded:"No minutes recorded.",go_to_matter_details:"Go to Full Legislation Details",disclaimer_start:"To provide event transcripts at low-cost, Council Data Project uses",disclaimer_end:"for transcription. Event transcripts may include errors.",disclaimer_footer_start:"In many cases, Council Data Project utilizes a fine-tuned",disclaimer_footer_end:"model for generation of event transcripts. We understand that transcripts may include errors. If you are a machine learning expert and wish to help improve our system for generating transcripts, please reach out to us on GitHub."},de:{number_approved:"{number} Genehmigt",number_rejected:"{number} Abgelehnt",number_non_voting:"{number} Nicht-Abstimmen",meeting_votes_caption:"Klicken Sie auf jede Zeile, um zu sehen, wie die Ratsmitglieder abgestimmt haben",legislation:"Gesetzgebung",council_decision:"Beschluss des Rates",votes:"Stimmen",meeting:"Treffen",persons_vote:"{name}s Stimee",en:"English",es:"Espa\xf1ol",de:"Deutsche",keywords:"Schl\xfcsselw\xf6rter",select_language:"Sprache ausw\xe4hlen",same:"gleich",committee:"Komitee",chair:"Vorsitzende",tenure:"Amtszeit",bills_sponsored:"Rechnung(en) gesponsert",see_documents:"Siehe Dokumente",jump_to_sentence_video:"Zum Satz im Video springen",jump_to_sentence_transcript:"Zum Satz im Transkript springen",search_transcript:"Transkript suchen",search_transcript_placeholder:"Transkript suchen...",number_of_results:"{number} Ergebnis(e)",clear:"L\xf6schen",save:"Speichern",about:"\xdcber",search:"Suche",advanced_options:"Erweiterte Optionen",copyright_notice:"Urheberrechte \xa9 Einzelne mitwirkende, {date_range}",content_license_prefix:"Inhalt verf\xfcgbar unter a ",content_license_link:"https://creativecommons.org/licenses/by/4.0/deed.en",content_license_link_text:"Creative Commons Namensnennung 4.0 International License",tools_license_prefix:"Council Data Project werkzeuge sind lizenziert unter ",styled_using_prefix:"Gestylt mit ",artwork_provided_by_prefix:"Kunstwerk zur Verf\xfcgung gestellt von ",passed:"Bestanden",failed:"Fehlgeschlagen",approve:"Genehmigen",reject:"Ablehnen",abstain_approve:"Verzichten (Genehmigt)",abstain_non_voting:"Verzichten (Nicht-Abstimmen)",abstain_reject:"Verzichten (Abgelehnt)",absent_approve:"Abwesend (Genehmigt)",absent_non_voting:"Abwesend (Nicht-Abstimmen)",absent_reject:"Abwesend (Abgelehnt)",rejected:"Abgelehnt",adopted:"Angenommen",in_progress:"In Bearbeitung",example_prefix:"Beispiel:",search_topic_placeholder:"Thema suchen...",search_municipality_name:"{municipality_name} suchen",events:"Veranstaltungen",links:"Links",people:"Menschen",council_data_project:"Council Data Project",transcript:"Transkript",agenda:"Agenda",session:"Sitzung",date:"Datum",newest_first:"Neusten zuerst",oldest_first:"\xc4ltesten zuerst",most_relevant_first:"Das Wichtigste zuerst",closest_match_first:"N\xe4chste \xdcbereinstimmung zuerst",most_relevant:"Relevanteste",search_results:"Suchergebnisse",event_search_results:"Ergebnisse der Suche nach Ereignissen",no_results_found:"Keine Ergebnisse",show_more:"Zeig mehr...",legislation_sponsored:"Gesetzgebung gesponsert",menu:"Speisekarte",persons_voting_record:"{person_name}s Abstimmungsprotokoll",contact:"Kontakt",terms:"Begriffe",committee_membership:"Ausschussmitgliedschaft",former_committee_membership:"Ehemalige Ausschussmitgliedschaft",committees:"Aussch\xfcsse",visit_persons_website:"Besuchen Sie {person_name}s Website",alternate:"Wechseln",councilmember:"Stadtrat/in",member:"Mitglied",council_president:"Pr\xe4sident des Rates",vice_chair:"Stellvertretender Vorsitzender",supervisor:"Supervisor/in",active:"aktiv",inactive:"inaktiv",latest_vote:"Letzte Abstimmung",history:"Geschichte",minutes:"Protokoll",no_minutes_recorded:"Keine Protokolle erfasst.",go_to_matter_details:"Gehen Sie zu den vollst\xe4ndigen Rechtsvorschriften",disclaimer_start:"Um Transkripte von Veranstaltungen kosteng\xfcnstig bereitzustellen, verwendet Council Data Project",disclaimer_end:"f\xfcr die Transkription. Ereignisprotokolle k\xf6nnen Fehler enthalten.",disclaimer_footer_start:"In vielen F\xe4llen verwendet Council Data Project ein fein abgestimmtes",disclaimer_footer_end:"Modell zur Generierung von Ereignisprotokollen. Wir verstehen, dass Transkripte Fehler enthalten k\xf6nnen. Wenn Sie ein Experte f\xfcr maschinelles Lernen sind und dabei helfen m\xf6chten, unser System zum Generieren von Transkripten zu verbessern, kontaktieren Sie uns bitte auf GitHub."},es:{number_approved:"{number} Aprobado",number_rejected:"{number} Rechazado",number_non_voting:"{number} sin derecho a voto",meeting_votes_caption:"Haga clic en cada fila para ver c\xf3mo votaron los miembros del consejo",legislation:"Legislaci\xf3n",council_decision:"Decisi\xf3n del Consejo",votes:"Votos",meeting:"Cita",persons_vote:"Voto de {name}",en:"English",es:"Espa\xf1ol",de:"Deutsche",keywords:"Palabras clave",select_language:"Seleccione el Idioma",same:"Mismo",committee:"Comit\xe9",chair:"presidente",tenure:"Tenencia",bills_sponsored:"factura (s) patrocinada",see_documents:"Ver Documentos",jump_to_sentence_video:"Saltar a la oraci\xf3n en el video",jump_to_sentence_transcript:"Saltar a la oraci\xf3n en la transcripci\xf3n",search_transcript:"Buscar transcripci\xf3n",search_transcript_placeholder:"Buscar transcripci\xf3n ...",number_of_results:"{number} resultado (s)",clear:"Despejar",save:"Ahorrar",about:"Acerca de",search:"Buscar",advanced_options:"Opciones Avanzadas",copyright_notice:"Derechos de autor \xa9 Contribuyentes individuales, {date_range}.",content_license_prefix:"Contenido disponible bajo un ",content_license_link:"https://creativecommons.org/licenses/by/4.0/deed.es",content_license_link_text:"Creative Commons Atribuci\xf3n 4.0 Internacional License",tools_license_prefix:"Council Data Project las herramientas tienen licencia bajo ",styled_using_prefix:"Dise\xf1ado usando ",artwork_provided_by_prefix:"Obra proporcionada por ",passed:"Pas\xf3",failed:"Fracas\xf3",approve:"Aprobar",reject:"Rechazar",abstain_approve:"Abstenerse (Aprobado)",abstain_non_voting:"Abstenerse (sin derecho a voto)",abstain_reject:"Abstenerse (Rechazado)",absent_approve:"Ausente (Aprobado)",absent_non_voting:"Ausente (sin derecho a voto)",absent_reject:"Ausente (Rechazado)",rejected:"Rechazado",adopted:"Adoptado",in_progress:"En curso",example_prefix:"Ejemplo:",search_topic_placeholder:"Buscar un tema ...",search_municipality_name:"Buscar {municipality_name}",events:"Eventos",links:"Enlaces",people:"Gente",council_data_project:"Council Data Project",transcript:"Transcripci\xf3n",agenda:"Agenda",session:"Sesi\xf3n",date:"Fecha",newest_first:"M\xe1s nuevos primero",oldest_first:"M\xe1s viejos primero",most_relevant_first:"M\xe1s relevante primero",closest_match_first:"Coincidencia m\xe1s cercana primero",most_relevant:"M\xe1s relevante",search_results:"Resultados de la B\xfasqueda",event_search_results:"Resultados de Busqueda de Eventos",no_results_found:"No hay resultados",show_more:"Mostrar m\xe1s...",legislation_sponsored:"Legislaci\xf3n patrocinada",menu:"Men\xfa",persons_voting_record:"Registro de votos de {person_name}",contact:"Contacto",terms:"T\xe9rminos",committee_membership:"Membres\xeda del Comit\xe9",former_committee_membership:"Membres\xeda Anterior del Comit\xe9",committees:"Comit\xe9s",visit_persons_website:"Visite el sitio web de {person_name}",alternate:"Alterno/a",councilmember:"Concejal/a",member:"Miembro",council_president:"Presidente/a del Consejo",vice_chair:"Vicepresidente/a",supervisor:"Supervisor/a",active:"activo/a",inactive:"inactivo/a",latest_vote:"\xdaltimo Voto",history:"Historia",minutes:"Protocolo",no_minutes_recorded:"No hay actas registradas.",go_to_matter_details:"Ir a los detalles completos de la legislaci\xf3n",disclaimer_start:"Para proporcionar transcripciones de eventos a bajo costo, Council Data Project utiliza",disclaimer_end:"para la transcripci\xf3n. Las transcripciones de eventos pueden incluir errores.",disclaimer_footer_start:"En muchos casos, Council Data Project utiliza un",disclaimer_footer_end:"modelo perfeccionado para la generaci\xf3n de transcripciones de eventos. Entendemos que las transcripciones pueden incluir errores. Si es un experto en aprendizaje autom\xe1tico y desea ayudar a mejorar nuestro sistema para generar transcripciones, comun\xedquese con nosotros en GitHub."}}),ie="320px",se="414px",oe="768px",ae="1224px",ce=h.a.div({boxSizing:"initial"}),le=h.a.div({float:"left",marginTop:"12px"}),ue=h.a.button({display:"block",["@media (min-width:".concat(oe,")")]:{display:"none"}}),he=h.a.div(e=>({display:e.isVisible?"block":"none",["@media (min-width:".concat(oe,")")]:{display:"block"}}));function de(e,t){const n={textDecoration:"underline"};return e===t||t.length>1&&e.includes(t)?n:{}}const me=e=>{let{municipalityName:t}=e;const[n,r]=Object(a.useState)(!1),i=Object(l.h)().pathname;return K("header",{children:K(ce,{className:"mzp-c-navigation",children:K("div",{className:"mzp-c-navigation-l-content",children:Q("div",{className:"mzp-c-navigation-container",children:[K(ue,{className:"mzp-c-navigation-menu-button","aria-controls":"patterns.organisms.navigation.navigation",onClick:()=>r(e=>!e),children:re.menu}),K(le,{children:K("a",{className:"cdp-icon-black-bg-transparent-size-256",style:{maxHeight:"64px",maxWidth:"64px"},href:"https://councildataproject.org",title:re.council_data_project,children:re.council_data_project})}),K(he,{isVisible:n,className:"mzp-c-navigation-items",id:"patterns.organisms.navigation.navigation",children:K("div",{className:"mzp-c-navigation-container",children:K("nav",{className:"mzp-c-menu mzp-is-basic",children:Q("ul",{className:"mzp-c-menu-category-list",children:[K("li",{className:"mzp-c-menu-category",children:K(u.b,{to:"/",className:"mzp-c-menu-title",style:de(i,"/"),children:t})}),K("li",{className:"mzp-c-menu-category",children:K(u.b,{to:"/events",className:"mzp-c-menu-title",style:de(i,"/events"),children:re.events})}),K("li",{className:"mzp-c-menu-category",children:K(u.b,{to:"/people",className:"mzp-c-menu-title",style:de(i,"/people"),children:re.people})})]})})})})]})})})})};const pe=e=>{let{footerLinksSections:t}=e;return K("footer",{className:"mzp-c-footer",children:Q("div",{className:"mzp-l-content",children:[K("nav",{className:"mzp-c-footer-primary","aria-label":"footer",children:Q("div",{className:"mzp-c-footer-sections",children:[Q("section",{className:"mzp-c-footer-section",children:[K("h5",{className:"mzp-c-footer-heading",children:re.about}),Q("ul",{children:[K("li",{children:K("a",{href:"https://councildataproject.github.io/",children:"CouncilDataProject"})}),K("li",{children:K("a",{href:"https://github.com/CouncilDataProject",children:"GitHub"})})]})]}),t.map(e=>function(e){return Q("section",{className:"mzp-c-footer-section",children:[K("h5",{className:"mzp-c-footer-heading",children:e.footerLinksSectionName}),K("ul",{children:e.links.map(e=>K("li",{children:K("a",{href:e.url,children:e.label})},e.label))})]})}(e))]})}),Q("nav",{className:"mzp-c-footer-secondary",children:[Q("p",{children:[re.disclaimer_footer_start," ",K("a",{rel:"noopener noreferrer license external",target:"_blank",href:"https://cloud.google.com/speech-to-text",children:"Google Speech-to-Text"})," ",re.disclaimer_footer_end]}),Q("div",{className:"mzp-c-footer-legal mzp-c-footer-license",children:[K("p",{children:re.copyright_notice.replace("{date_range}","2017-2021")}),Q("p",{children:[re.content_license_prefix,K("a",{rel:"noopener noreferrer license external",href:re.content_license_link,target:"_blank",children:re.content_license_link_text}),".",K("br",{}),re.tools_license_prefix,K("a",{rel:"noopener noreferrer license external",href:"https://github.com/CouncilDataProject/cookiecutter-cdp-deployment/blob/main/LICENSE",target:"_blank",children:"MIT License"}),"."]}),Q("p",{children:[re.styled_using_prefix,K("a",{rel:"noopener noreferrer external",href:"https://protocol.mozilla.org/",target:"_blank",children:"Mozilla Protocol"}),".",K("br",{}),re.artwork_provided_by_prefix,K("a",{rel:"noopener noreferrer external",href:"https://undraw.co/",target:"_blank",children:"unDraw"}),"."]})]})]})]})})};var fe=(e=>(e.EVENT="events",e.LEGISLATION="legislations",e))(fe||{});const ge="FILTER_CLEAR",ye="FILTER_UPDATE",ve=(e,t)=>{const n=Object.values(e).filter(e=>e).length;return n?"".concat(t," : ").concat(n):t},be=e=>Object.keys(e).filter(t=>!0===e[t]);var _e=h.a.form({marginBottom:0,"& .mzp-c-field-set":{padding:0},"& .mzp-c-choices":{paddingBottom:0}});const we=(e,t)=>-1!==e.toLowerCase().indexOf(t.toLowerCase()),Ee=h.a.label({"&::after":{boxSizing:"unset"}}),Se=e=>{let{name:t,state:n,update:r,options:i,optionQuery:s,setOptionQuery:o}=e;const c=e=>{const t=e.currentTarget.name,n=e.currentTarget.checked;r(t,n)},l=Object(a.useMemo)(()=>{let e=[...i];if(i.length>5&&o){for(const e of i)e.disabled=!we(e.label,s||"");e=[...i.filter(e=>!e.disabled),...i.filter(e=>e.disabled)]}return e},[i,s,o]);return Q(_e,{className:"mzp-c-form",children:[i.length>5&&o&&Q("div",{className:"mzp-c-field mzp-l-stretch",children:[K("label",{className:"mzp-c-field-label",htmlFor:"form-input-control-search-filter",children:"Search ".concat(t," Options")}),K("input",{className:"mzp-c-field-control",type:"text",id:"form-input-control-search-filter",value:s,onChange:e=>{const t=e.currentTarget.value;o&&o(t)}})]}),K("fieldset",{className:"mzp-c-field-set",children:K("div",{className:"mzp-c-choices",children:l.map(e=>Q("div",{className:"mzp-c-choice",children:[K("input",{className:"mzp-c-choice-control",type:"checkbox",name:e.name,id:"form-checkbox-control-".concat(e.name),checked:n[e.name]||!1,disabled:e.disabled,onChange:c}),K(Ee,{className:"mzp-c-choice-label",htmlFor:"form-checkbox-control-".concat(e.name),children:e.label})]},e.name))})})]})};function Ie(e){const{name:t,initialState:n,defaultDataValue:r,textRepFunction:i,isRequired:s,limit:c}=e,l=(e,t)=>{switch(t.type){case ye:return Object(o.a)(Object(o.a)({},e),{},{[t.payload.keyName]:t.payload.dataValue});case ge:const n=Object(o.a)({},e);return Object.keys(n).forEach(e=>n[e]=t.payload.dataValue),n;default:return e}},[u,h]=Object(a.useReducer)(l,n),[d,m]=Object(a.useState)(!1),p=()=>Object.values(u).some(e=>e!==r);return{name:t,state:u,clear:()=>{h({type:ge,payload:{dataValue:r}})},update:(e,t)=>{h({type:ye,payload:{keyName:e,dataValue:t}})},popupIsOpen:d,setPopupIsOpen:m,getTextRep:()=>i(u,t),isActive:p,isSameState:e=>{if(!Object.entries(e).length)return!p();const t=Object.keys(u);for(const n of t){if(u[n]&&!e.hasOwnProperty(n))return!1;if(u[n]!==e[n]&&e.hasOwnProperty(n))return!1}return!0},hasRequiredError:()=>!!s&&!p(),hasLimitError:()=>void 0!==c&&be(u).length>c,limit:c}}const Ce=["minimum wage","police budget","rent control","municipal broadband","police accountability","homelessness response","municipal broadband, digital equity","sodo stadium","35 ave bike lane","capitol hill megablock"],Te=h.a.div(O||(O=Object(s.a)(["\n  ","\n  @media (min-width: ",") {\n    /**Two columns template, with the first column taking up any free space*/\n    grid-template-columns: 1fr auto;\n  }\n"])),"\n  display: grid;\n  column-gap: 8px;\n  row-gap: 4px;\n  /**One column template*/\n  grid-template-columns: 1fr;\n  justify-content: start;\n",oe),ke=h.a.input(P||(P=Object(s.a)(["\n  margin-bottom: 0px !important;\n"]))),xe=h.a.p(M||(M=Object(s.a)(["\n  padding-top: 0px !important;\n  font-size: 0.775rem !important;\n  @media (min-width: ",") {\n    /**Make the example topic appear after the search button*/\n    order: 1;\n  }\n"])),oe),Ne=[{name:fe.EVENT,label:"Events",disabled:!1},{name:fe.LEGISLATION,label:"Legislations",disabled:!1}],Ae={[fe.EVENT]:!0,[fe.LEGISLATION]:!0},Re=(e,t)=>{const n=Object.keys(e).filter(t=>e[t]);let r=t;if(n.length===Object.keys(e).length)r+="(s): All";else if(n.length>0){const e=n.map(e=>{var t;const n=Ne.find(t=>t.name===e);return null!=(t=null==n?void 0:n.label)?t:""});r+="(s): ".concat(e.join(", "))}return r},De=Ce[Math.floor(Math.random()*Ce.length)],Oe=()=>{const[e,t]=Object(a.useState)(""),n=Object(l.g)(),r=Ie({name:"Search Type",initialState:Ae,defaultDataValue:!1,textRepFunction:Re,isRequired:!0});return K("div",{children:K("form",{className:"mzp-c-form",role:"search",onSubmit:t=>{t.preventDefault();const r="?q=".concat(e.trim().replace(/\s+/g,"+"));n.push({pathname:"/".concat(fe.EVENT,"/search"),search:r,state:{query:e.trim(),committees:{},dateRange:{}}})},children:Q(Te,{children:[K(ke,{type:"search",placeholder:re.search_topic_placeholder,required:!0,"aria-required":!0,disabled:!r.isActive(),value:e,onChange:e=>t(e.target.value)}),Q(xe,{className:"mzp-c-field-info",children:[re.example_prefix,De]}),K("button",{className:"mzp-c-button mzp-t-product",type:"submit",disabled:!r.isActive(),children:re.search})]})})})},Pe=h.a.div({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",flex:1,"& > *":{width:"100%"},["@media (min-width:".concat(oe,")")]:{"& > *":{width:"75%"}}}),Me=()=>{var e;const{municipality:t}=Z();return ne("Council Data Project | ".concat(null!==(e=null===t||void 0===t?void 0:t.name)&&void 0!==e?e:"Searchable"," - Searchable")),Q(Pe,{children:[K("h1",{className:"mzp-u-title-xs",children:re.search_municipality_name.replace("{municipality_name}",t.name)}),K(Oe,{})]})},je=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},Le={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,o=s?e[i+1]:0,a=i+2<e.length,c=a?e[i+2]:0,l=t>>2,u=(3&t)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),r.push(n[l],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(je(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0;++i;const o=i<e.length?n[e.charAt(i)]:64;++i;const a=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==s||null==o||null==a)throw Error();const c=t<<2|s>>4;if(r.push(c),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},Ve=function(e){return function(e){const t=je(e);return Le.encodeByteArray(t,!0)}(e).replace(/\./g,"")};const Be=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof e)return e;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,Fe=()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&function(e){try{return Le.decodeString(e,!0)}catch(n){console.error("base64Decode failed: ",n)}return null}(e[1]);return t&&JSON.parse(t)},Ue=()=>{try{return Be()||(()=>{if("undefined"===typeof r)return;const e={}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||Fe()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},ze=e=>{const t=(e=>{var t,n;return null===(n=null===(t=Ue())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]})(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]};class qe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function Ge(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Ve(JSON.stringify({alg:"none",type:"JWT"})),Ve(JSON.stringify(s)),""].join(".")}class He extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,He.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,We.prototype.create)}}class We{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(Ke,(e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")})}(r,t):"Error",s="".concat(this.serviceName,": ").concat(i," (").concat(n,").");return new He(n,s,t)}}const Ke=/\{\$([^}]+)}/g;function Qe(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(Ye(n)&&Ye(s)){if(!Qe(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Ye(e){return null!==e&&"object"===typeof e}function Je(e){return e&&e._delegate?e._delegate:e}class Xe{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ze="[DEFAULT]";class $e{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new qe;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Ze})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ze;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ze;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ze;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===Ze?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(s){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ze;return this.component?this.component.multipleInstances?e:Ze:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class et{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new $e(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var tt,nt;(nt=tt||(tt={}))[nt.DEBUG=0]="DEBUG",nt[nt.VERBOSE=1]="VERBOSE",nt[nt.INFO=2]="INFO",nt[nt.WARN=3]="WARN",nt[nt.ERROR=4]="ERROR",nt[nt.SILENT=5]="SILENT";const rt={debug:tt.DEBUG,verbose:tt.VERBOSE,info:tt.INFO,warn:tt.WARN,error:tt.ERROR,silent:tt.SILENT},it=tt.INFO,st={[tt.DEBUG]:"log",[tt.VERBOSE]:"log",[tt.INFO]:"info",[tt.WARN]:"warn",[tt.ERROR]:"error"},ot=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=st[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i=arguments.length,s=new Array(i>2?i-2:0),o=2;o<i;o++)s[o-2]=arguments[o];console[r]("[".concat(n,"]  ").concat(e.name,":"),...s)};class at{constructor(e){this.name=e,this._logLevel=it,this._logHandler=ot,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in tt))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?rt[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,tt.DEBUG,...t),this._logHandler(this,tt.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,tt.VERBOSE,...t),this._logHandler(this,tt.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,tt.INFO,...t),this._logHandler(this,tt.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,tt.WARN,...t),this._logHandler(this,tt.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,tt.ERROR,...t),this._logHandler(this,tt.ERROR,...t)}}let ct,lt;const ut=new WeakMap,ht=new WeakMap,dt=new WeakMap,mt=new WeakMap,pt=new WeakMap;let ft={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return ht.get(e);if("objectStoreNames"===t)return e.objectStoreNames||dt.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return vt(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function gt(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(lt||(lt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(bt(this),n),vt(ut.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return vt(e.apply(bt(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=e.call(bt(this),t,...r);return dt.set(s,t.sort?t.sort():[t]),vt(s)}}function yt(e){return"function"===typeof e?gt(e):(e instanceof IDBTransaction&&function(e){if(ht.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});ht.set(e,t)}(e),t=e,(ct||(ct=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,ft):e);var t}function vt(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(vt(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&ut.set(t,e)}).catch(()=>{}),pt.set(t,e),t}(e);if(mt.has(e))return mt.get(e);const t=yt(e);return t!==e&&(mt.set(e,t),pt.set(t,e)),t}const bt=e=>pt.get(e);const _t=["get","getKey","getAll","getAllKeys","count"],wt=["put","add","delete","clear"],Et=new Map;function St(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(Et.get(t))return Et.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=wt.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!_t.includes(n))return;const s=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let s=t.store;for(var o=arguments.length,a=new Array(o>1?o-1:0),c=1;c<o;c++)a[c-1]=arguments[c];return r&&(s=s.index(a.shift())),(await Promise.all([s[n](...a),i&&t.done]))[0]};return Et.set(t,s),s}ft=(e=>Object(o.a)(Object(o.a)({},e),{},{get:(t,n,r)=>St(t,n)||e.get(t,n,r),has:(t,n)=>!!St(t,n)||e.has(t,n)}))(ft);class It{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(e=>e).join(" ")}}const Ct="@firebase/app",Tt="0.8.2",kt=new at("@firebase/app"),xt="@firebase/app-compat",Nt="@firebase/analytics-compat",At="@firebase/analytics",Rt="@firebase/app-check-compat",Dt="@firebase/app-check",Ot="@firebase/auth",Pt="@firebase/auth-compat",Mt="@firebase/database",jt="@firebase/database-compat",Lt="@firebase/functions",Vt="@firebase/functions-compat",Bt="@firebase/installations",Ft="@firebase/installations-compat",Ut="@firebase/messaging",zt="@firebase/messaging-compat",qt="@firebase/performance",Gt="@firebase/performance-compat",Ht="@firebase/remote-config",Wt="@firebase/remote-config-compat",Kt="@firebase/storage",Qt="@firebase/storage-compat",Yt="@firebase/firestore",Jt="@firebase/firestore-compat",Xt="firebase",Zt="[DEFAULT]",$t={[Ct]:"fire-core",[xt]:"fire-core-compat",[At]:"fire-analytics",[Nt]:"fire-analytics-compat",[Dt]:"fire-app-check",[Rt]:"fire-app-check-compat",[Ot]:"fire-auth",[Pt]:"fire-auth-compat",[Mt]:"fire-rtdb",[jt]:"fire-rtdb-compat",[Lt]:"fire-fn",[Vt]:"fire-fn-compat",[Bt]:"fire-iid",[Ft]:"fire-iid-compat",[Ut]:"fire-fcm",[zt]:"fire-fcm-compat",[qt]:"fire-perf",[Gt]:"fire-perf-compat",[Ht]:"fire-rc",[Wt]:"fire-rc-compat",[Kt]:"fire-gcs",[Qt]:"fire-gcs-compat",[Yt]:"fire-fst",[Jt]:"fire-fst-compat","fire-js":"fire-js",[Xt]:"fire-js-all"},en=new Map,tn=new Map;function nn(e,t){try{e.container.addComponent(t)}catch(n){kt.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function rn(e){const t=e.name;if(tn.has(t))return kt.debug("There were multiple attempts to register component ".concat(t,".")),!1;tn.set(t,e);for(const n of en.values())nn(n,e);return!0}function sn(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const on=new We("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class an{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Xe("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw on.create("app-deleted",{appName:this._name})}}const cn="9.12.1";function ln(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:Zt,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!==typeof i||!i)throw on.create("bad-app-name",{appName:String(i)});if(n||(n=(()=>{var e;return null===(e=Ue())||void 0===e?void 0:e.config})()),!n)throw on.create("no-options");const s=en.get(i);if(s){if(Qe(n,s.options)&&Qe(r,s.config))return s;throw on.create("duplicate-app",{appName:i})}const o=new et(i);for(const c of tn.values())o.addComponent(c);const a=new an(n,r,o);return en.set(i,a),a}function un(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zt;const t=en.get(e);if(!t&&e===Zt)return ln();if(!t)throw on.create("no-app",{appName:e});return t}function hn(e,t,n){var r;let i=null!==(r=$t[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return s&&e.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),s&&o&&e.push("and"),o&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void kt.warn(e.join(" "))}rn(new Xe("".concat(i,"-version"),()=>({library:i,version:t}),"VERSION"))}const dn="firebase-heartbeat-store";let mn=null;function pn(){return mn||(mn=function(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=indexedDB.open(e,t),a=vt(o);return r&&o.addEventListener("upgradeneeded",e=>{r(vt(o.result),e.oldVersion,e.newVersion,vt(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",()=>i())}).catch(()=>{}),a}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(dn)}}).catch(e=>{throw on.create("idb-open",{originalErrorMessage:e.message})})),mn}async function fn(e,t){var n;try{const n=(await pn()).transaction(dn,"readwrite"),r=n.objectStore(dn);return await r.put(t,gn(e)),n.done}catch(r){if(r instanceof He)kt.warn(r.message);else{const e=on.create("idb-set",{originalErrorMessage:null===(n=r)||void 0===n?void 0:n.message});kt.warn(e.message)}}}function gn(e){return"".concat(e.name,"!").concat(e.options.appId)}class yn{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new bn(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=vn();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some(e=>e.date===t))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=vn(),{heartbeatsToSend:t,unsentEntries:n}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),_n(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),_n(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=Ve(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function vn(){return(new Date).toISOString().substring(0,10)}class bn{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return"object"===typeof indexedDB&&new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}).then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){return await async function(e){var t;try{return(await pn()).transaction(dn).objectStore(dn).get(gn(e))}catch(n){if(n instanceof He)kt.warn(n.message);else{const e=on.create("idb-get",{originalErrorMessage:null===(t=n)||void 0===t?void 0:t.message});kt.warn(e.message)}}}(this.app)||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return fn(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return fn(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function _n(e){return Ve(JSON.stringify({version:2,heartbeats:e})).length}var wn;wn="",rn(new Xe("platform-logger",e=>new It(e),"PRIVATE")),rn(new Xe("heartbeat",e=>new yn(e),"PRIVATE")),hn(Ct,Tt,wn),hn(Ct,Tt,"esm2017"),hn("fire-js","");var En,Sn="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof e?e:"undefined"!==typeof self?self:{},In=In||{},Cn=Sn||self;function Tn(){}function kn(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function xn(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var Nn="closure_uid_"+(1e9*Math.random()>>>0),An=0;function Rn(e,t,n){return e.call.apply(e.bind,arguments)}function Dn(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function On(e,t,n){return(On=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Rn:Dn).apply(null,arguments)}function Pn(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function Mn(e,t){function n(){}n.prototype=t.prototype,e.X=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Wb=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function jn(){this.s=this.s,this.o=this.o}jn.prototype.s=!1,jn.prototype.na=function(){var e;!this.s&&(this.s=!0,this.M(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,Nn)&&e[Nn]||(e[Nn]=++An))},jn.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Ln=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"===typeof e)return"string"!==typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function Vn(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function Bn(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(kn(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function Fn(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}Fn.prototype.h=function(){this.defaultPrevented=!0};var Un=function(){if(!Cn.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{Cn.addEventListener("test",Tn,t),Cn.removeEventListener("test",Tn,t)}catch(n){}return e}();function zn(e){return/^[\s\xa0]*$/.test(e)}var qn=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function Gn(e,t){return e<t?-1:e>t?1:0}function Hn(){var e=Cn.navigator;return e&&(e=e.userAgent)?e:""}function Wn(e){return-1!=Hn().indexOf(e)}function Kn(e){return Kn[" "](e),e}Kn[" "]=Tn;var Qn,Yn=Wn("Opera"),Jn=Wn("Trident")||Wn("MSIE"),Xn=Wn("Edge"),Zn=Xn||Jn,$n=Wn("Gecko")&&!(-1!=Hn().toLowerCase().indexOf("webkit")&&!Wn("Edge"))&&!(Wn("Trident")||Wn("MSIE"))&&!Wn("Edge"),er=-1!=Hn().toLowerCase().indexOf("webkit")&&!Wn("Edge");function tr(){var e=Cn.document;return e?e.documentMode:void 0}e:{var nr="",rr=function(){var e=Hn();return $n?/rv:([^\);]+)(\)|;)/.exec(e):Xn?/Edge\/([\d\.]+)/.exec(e):Jn?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):er?/WebKit\/(\S+)/.exec(e):Yn?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(rr&&(nr=rr?rr[1]:""),Jn){var ir=tr();if(null!=ir&&ir>parseFloat(nr)){Qn=String(ir);break e}}Qn=nr}var sr,or={};function ar(){return function(e){var t=or;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=e(9)}(function(){let e=0;const t=qn(String(Qn)).split("."),n=qn("9").split("."),r=Math.max(t.length,n.length);for(let o=0;0==e&&o<r;o++){var i=t[o]||"",s=n[o]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==i[0].length&&0==s[0].length)break;e=Gn(0==i[1].length?0:parseInt(i[1],10),0==s[1].length?0:parseInt(s[1],10))||Gn(0==i[2].length,0==s[2].length)||Gn(i[2],s[2]),i=i[3],s=s[3]}while(0==e)}return 0<=e})}if(Cn.document&&Jn){var cr=tr();sr=cr||(parseInt(Qn,10)||void 0)}else sr=void 0;var lr=sr;function ur(e,t){if(Fn.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if($n){e:{try{Kn(t.nodeName);var i=!0;break e}catch(s){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:hr[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&ur.X.h.call(this)}}Mn(ur,Fn);var hr={2:"touch",3:"pen",4:"mouse"};ur.prototype.h=function(){ur.X.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var dr="closure_listenable_"+(1e6*Math.random()|0),mr=0;function pr(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++mr,this.ba=this.ea=!1}function fr(e){e.ba=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function gr(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function yr(e){const t={};for(const n in e)t[n]=e[n];return t}const vr="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function br(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<vr.length;t++)n=vr[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function _r(e){this.src=e,this.g={},this.h=0}function wr(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=Ln(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(fr(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function Er(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.ba&&s.listener==t&&s.capture==!!n&&s.ha==r)return i}return-1}_r.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=Er(e,t,r,i);return-1<o?(t=e[o],n||(t.ea=!1)):((t=new pr(t,this.src,s,!!r,i)).ea=n,e.push(t)),t};var Sr="closure_lm_"+(1e6*Math.random()|0),Ir={};function Cr(e,t,n,r,i){if(r&&r.once)return kr(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)Cr(e,t[s],n,r,i);return null}return n=Pr(n),e&&e[dr]?e.N(t,n,xn(r)?!!r.capture:!!r,i):Tr(e,t,n,!1,r,i)}function Tr(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=xn(i)?!!i.capture:!!i,a=Dr(e);if(a||(e[Sr]=a=new _r(e)),(n=a.add(t,n,r,o,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=Rr;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)Un||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Ar(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function kr(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)kr(e,t[s],n,r,i);return null}return n=Pr(n),e&&e[dr]?e.O(t,n,xn(r)?!!r.capture:!!r,i):Tr(e,t,n,!0,r,i)}function xr(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)xr(e,t[s],n,r,i);else r=xn(r)?!!r.capture:!!r,n=Pr(n),e&&e[dr]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=Er(s=e.g[t],n,r,i))&&(fr(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=Dr(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Er(t,n,r,i)),(n=-1<e?t[e]:null)&&Nr(n))}function Nr(e){if("number"!==typeof e&&e&&!e.ba){var t=e.src;if(t&&t[dr])wr(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Ar(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Dr(t))?(wr(n,e),0==n.h&&(n.src=null,t[Sr]=null)):fr(e)}}}function Ar(e){return e in Ir?Ir[e]:Ir[e]="on"+e}function Rr(e,t){if(e.ba)e=!0;else{t=new ur(t,this);var n=e.listener,r=e.ha||e.src;e.ea&&Nr(e),e=n.call(r,t)}return e}function Dr(e){return(e=e[Sr])instanceof _r?e:null}var Or="__closure_events_fn_"+(1e9*Math.random()>>>0);function Pr(e){return"function"===typeof e?e:(e[Or]||(e[Or]=function(t){return e.handleEvent(t)}),e[Or])}function Mr(){jn.call(this),this.i=new _r(this),this.P=this,this.I=null}function jr(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"===typeof t)t=new Fn(t,e);else if(t instanceof Fn)t.target=t.target||e;else{var i=t;br(t=new Fn(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=Lr(o,r,!0,t)&&i}if(i=Lr(o=t.g=e,r,!0,t)&&i,i=Lr(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=Lr(o=t.g=n[s],r,!1,t)&&i}function Lr(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.ba&&o.capture==n){var a=o.listener,c=o.ha||o.src;o.ea&&wr(e.i,o),i=!1!==a.call(c,r)&&i}}return i&&!r.defaultPrevented}Mn(Mr,jn),Mr.prototype[dr]=!0,Mr.prototype.removeEventListener=function(e,t,n,r){xr(this,e,t,n,r)},Mr.prototype.M=function(){if(Mr.X.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)fr(n[r]);delete t.g[e],t.h--}}this.I=null},Mr.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Mr.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var Vr=Cn.JSON.stringify;function Br(){var e=Wr;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Fr,Ur=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new zr,e=>e.reset());class zr{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function qr(e){Cn.setTimeout(()=>{throw e},0)}function Gr(e,t){Fr||function(){var e=Cn.Promise.resolve(void 0);Fr=function(){e.then(Kr)}}(),Hr||(Fr(),Hr=!0),Wr.add(e,t)}var Hr=!1,Wr=new class{constructor(){this.h=this.g=null}add(e,t){const n=Ur.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}};function Kr(){for(var e;e=Br();){try{e.h.call(e.g)}catch(n){qr(n)}var t=Ur;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Hr=!1}function Qr(e,t){Mr.call(this),this.h=e||1,this.g=t||Cn,this.j=On(this.lb,this),this.l=Date.now()}function Yr(e){e.ca=!1,e.R&&(e.g.clearTimeout(e.R),e.R=null)}function Jr(e,t,n){if("function"===typeof e)n&&(e=On(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=On(e.handleEvent,e)}return 2147483647<Number(t)?-1:Cn.setTimeout(e,t||0)}function Xr(e){e.g=Jr(()=>{e.g=null,e.i&&(e.i=!1,Xr(e))},e.j);const t=e.h;e.h=null,e.m.apply(null,t)}Mn(Qr,Mr),(En=Qr.prototype).ca=!1,En.R=null,En.lb=function(){if(this.ca){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-e):(this.R&&(this.g.clearTimeout(this.R),this.R=null),jr(this,"tick"),this.ca&&(Yr(this),this.start()))}},En.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},En.M=function(){Qr.X.M.call(this),Yr(this),delete this.g};class Zr extends jn{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Xr(this)}M(){super.M(),this.g&&(Cn.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $r(e){jn.call(this),this.h=e,this.g={}}Mn($r,jn);var ei=[];function ti(e,t,n,r){Array.isArray(n)||(n&&(ei[0]=n.toString()),n=ei);for(var i=0;i<n.length;i++){var s=Cr(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function ni(e){gr(e.g,function(e,t){this.g.hasOwnProperty(t)&&Nr(e)},e),e.g={}}function ri(){this.g=!0}function ii(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return Vr(n)}catch(a){return t}}(e,n)+(r?" "+r:"")})}$r.prototype.M=function(){$r.X.M.call(this),ni(this)},$r.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ri.prototype.Aa=function(){this.g=!1},ri.prototype.info=function(){};var si={},oi=null;function ai(){return oi=oi||new Mr}function ci(e){Fn.call(this,si.Pa,e)}function li(e){const t=ai();jr(t,new ci(t))}function ui(e,t){Fn.call(this,si.STAT_EVENT,e),this.stat=t}function hi(e){const t=ai();jr(t,new ui(t,e))}function di(e,t){Fn.call(this,si.Qa,e),this.size=t}function mi(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return Cn.setTimeout(function(){e()},t)}si.Pa="serverreachability",Mn(ci,Fn),si.STAT_EVENT="statevent",Mn(ui,Fn),si.Qa="timingevent",Mn(di,Fn);var pi={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},fi={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function gi(){}function yi(e){return e.h||(e.h=e.i())}function vi(){}gi.prototype.h=null;var bi,_i={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function wi(){Fn.call(this,"d")}function Ei(){Fn.call(this,"c")}function Si(){}function Ii(e,t,n,r){this.l=e,this.j=t,this.m=n,this.U=r||1,this.S=new $r(this),this.O=Ti,e=Zn?125:void 0,this.T=new Qr(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new Ci}function Ci(){this.i=null,this.g="",this.h=!1}Mn(wi,Fn),Mn(Ei,Fn),Mn(Si,gi),Si.prototype.g=function(){return new XMLHttpRequest},Si.prototype.i=function(){return{}},bi=new Si;var Ti=45e3,ki={},xi={};function Ni(e,t,n){e.K=1,e.v=Qi(qi(t)),e.s=n,e.P=!0,Ai(e,null)}function Ai(e,t){e.F=Date.now(),Pi(e),e.A=qi(e.v);var n=e.A,r=e.U;Array.isArray(r)||(r=[String(r)]),as(n.i,"t",r),e.C=0,n=e.l.H,e.h=new Ci,e.g=co(e.l,n?t:null,!e.s),0<e.N&&(e.L=new Zr(On(e.La,e,e.g),e.N)),ti(e.S,e.g,"readystatechange",e.ib),t=e.H?yr(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.da(e.A,e.u,e.s,t)):(e.u="GET",e.g.da(e.A,e.u,null,t)),li(),function(e,t,n,r,i,s){e.info(function(){if(e.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&"type"==h[1]?o+(u+"=")+l+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o})}(e.j,e.u,e.A,e.m,e.U,e.s)}function Ri(e){return!!e.g&&("GET"==e.u&&2!=e.K&&e.l.Da)}function Di(e,t,n){let r,i=!0;for(;!e.I&&e.C<n.length;){if(r=Oi(e,n),r==xi){4==t&&(e.o=4,hi(14),i=!1),ii(e.j,e.m,null,"[Incomplete Response]");break}if(r==ki){e.o=4,hi(15),ii(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}ii(e.j,e.m,r,null),Bi(e,r)}Ri(e)&&r!=xi&&r!=ki&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,hi(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.$&&(e.$=!0,(t=e.l).g==e&&t.$&&!t.K&&(t.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),eo(t),t.K=!0,hi(11))):(ii(e.j,e.m,n,"[Invalid Chunked Response]"),Vi(e),Li(e))}function Oi(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?xi:(n=Number(t.substring(n,r)),isNaN(n)?ki:(r+=1)+n>t.length?xi:(t=t.substr(r,n),e.C=r+n,t))}function Pi(e){e.V=Date.now()+e.O,Mi(e,e.O)}function Mi(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=mi(On(e.gb,e),t)}function ji(e){e.B&&(Cn.clearTimeout(e.B),e.B=null)}function Li(e){0==e.l.G||e.I||ro(e.l,e)}function Vi(e){ji(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,Yr(e.T),ni(e.S),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function Bi(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||fs(n.h,e)))if(!e.J&&fs(n.h,e)&&3==n.G){try{var r=n.Fa.g.parse(t)}catch(l){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;no(n),Ws(n)}$s(n),hi(18)}}else n.Ba=i[1],0<n.Ba-n.T&&37500>i[2]&&n.L&&0==n.A&&!n.v&&(n.v=mi(On(n.cb,n),6e3));if(1>=ps(n.h)&&n.ja){try{n.ja()}catch(l){}n.ja=void 0}}else so(n,11)}else if((e.J||n.g==e)&&no(n),!zn(t))for(i=n.Fa.g.parse(t),t=0;t<i.length;t++){let l=i[t];if(n.T=l[0],l=l[1],2==n.G)if("c"==l[0]){n.I=l[1],n.ka=l[2];const t=l[3];null!=t&&(n.ma=t,n.j.info("VER="+n.ma));const i=l[4];null!=i&&(n.Ca=i,n.j.info("SVER="+n.Ca));const u=l[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.J=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(gs(s,s.h),s.h=null))}if(r.D){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.za=e,Ki(r.F,r.D,e))}}n.G=3,n.l&&n.l.xa(),n.$&&(n.P=Date.now()-e.F,n.j.info("Handshake RTT: "+n.P+"ms"));var o=e;if((r=n).sa=ao(r,r.H?r.ka:null,r.V),o.J){ys(r.h,o);var a=o,c=r.J;c&&a.setTimeout(c),a.B&&(ji(a),Pi(a)),r.g=o}else Zs(r);0<n.i.length&&Qs(n)}else"stop"!=l[0]&&"close"!=l[0]||so(n,7);else 3==n.G&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?so(n,7):Hs(n):"noop"!=l[0]&&n.l&&n.l.wa(l),n.A=0)}li()}catch(l){}}function Fi(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(kn(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.oa&&"function"==typeof e.oa)return e.oa();if(!e.W||"function"!=typeof e.W){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(kn(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.W&&"function"==typeof e.W)return e.W();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(kn(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}(En=Ii.prototype).setTimeout=function(e){this.O=e},En.ib=function(e){e=e.target;const t=this.L;t&&3==Bs(e)?t.l():this.La(e)},En.La=function(e){try{if(e==this.g)e:{const u=Bs(this.g);var t=this.g.Ea();this.g.aa();if(!(3>u)&&(3!=u||Zn||this.g&&(this.h.h||this.g.fa()||Fs(this.g)))){this.I||4!=u||7==t||li(),ji(this);var n=this.g.aa();this.Y=n;t:if(Ri(this)){var r=Fs(this.g);e="";var i=r.length,s=4==Bs(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Vi(this),Li(this);var o="";break t}this.h.i=new Cn.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:s&&t==i-1});r.splice(0,i),this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=200==n,function(e,t,n,r,i,s,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o})}(this.j,this.u,this.A,this.m,this.U,u,n),this.i){if(this.Z&&!this.J){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!zn(a)){var l=a;break t}}l=null}if(!(n=l)){this.i=!1,this.o=3,hi(12),Vi(this),Li(this);break e}ii(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Bi(this,n)}this.P?(Di(this,u,o),Zn&&this.i&&3==u&&(ti(this.S,this.T,"tick",this.hb),this.T.start())):(ii(this.j,this.m,o,null),Bi(this,o)),4==u&&Vi(this),this.i&&!this.I&&(4==u?ro(this.l,this):(this.i=!1,Pi(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,hi(12)):(this.o=0,hi(13)),Vi(this),Li(this)}}}catch(u){}},En.hb=function(){if(this.g){var e=Bs(this.g),t=this.g.fa();this.C<t.length&&(ji(this),Di(this,e,t),this.i&&4!=e&&Pi(this))}},En.cancel=function(){this.I=!0,Vi(this)},En.gb=function(){this.B=null;const e=Date.now();0<=e-this.V?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.K&&(li(),hi(17)),Vi(this),this.o=2,Li(this)):Mi(this,this.V-e)};var Ui=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function zi(e,t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof zi){this.h=void 0!==t?t:e.h,Gi(this,e.j),this.s=e.s,this.g=e.g,Hi(this,e.m),this.l=e.l,t=e.i;var n=new rs;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),Wi(this,n),this.o=e.o}else e&&(n=String(e).match(Ui))?(this.h=!!t,Gi(this,n[1]||"",!0),this.s=Yi(n[2]||""),this.g=Yi(n[3]||"",!0),Hi(this,n[4]),this.l=Yi(n[5]||"",!0),Wi(this,n[6]||"",!0),this.o=Yi(n[7]||"")):(this.h=!!t,this.i=new rs(null,this.h))}function qi(e){return new zi(e)}function Gi(e,t,n){e.j=n?Yi(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Hi(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Wi(e,t,n){t instanceof rs?(e.i=t,function(e,t){t&&!e.j&&(is(e),e.i=null,e.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(ss(this,t),as(this,n,e))},e)),e.j=t}(e.i,e.h)):(n||(t=Ji(t,ts)),e.i=new rs(t,e.h))}function Ki(e,t,n){e.i.set(t,n)}function Qi(e){return Ki(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Yi(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Ji(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,Xi),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Xi(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}zi.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Ji(t,Zi,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Ji(t,Zi,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(Ji(n,"/"==n.charAt(0)?es:$i,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Ji(n,ns)),e.join("")};var Zi=/[#\/\?@]/g,$i=/[#\?:]/g,es=/[#\?]/g,ts=/[#\?@]/g,ns=/#/g;function rs(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function is(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function ss(e,t){is(e),t=cs(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function os(e,t){return is(e),t=cs(e,t),e.g.has(t)}function as(e,t,n){ss(e,t),0<n.length&&(e.i=null,e.g.set(cs(e,t),Vn(n)),e.h+=n.length)}function cs(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(En=rs.prototype).add=function(e,t){is(this),this.i=null,e=cs(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},En.forEach=function(e,t){is(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},En.oa=function(){is(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},En.W=function(e){is(this);let t=[];if("string"===typeof e)os(this,e)&&(t=t.concat(this.g.get(cs(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},En.set=function(e,t){return is(this),this.i=null,os(this,e=cs(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},En.get=function(e,t){return e&&0<(e=this.W(e)).length?String(e[0]):t},En.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const s=encodeURIComponent(String(r)),o=this.W(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),e.push(i)}}return this.i=e.join("&")};var ls=class{constructor(e,t){this.h=e,this.g=t}};function us(e){this.l=e||ds,Cn.PerformanceNavigationTiming?e=0<(e=Cn.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(Cn.g&&Cn.g.Ga&&Cn.g.Ga()&&Cn.g.Ga().$b),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var hs,ds=10;function ms(e){return!!e.h||!!e.g&&e.g.size>=e.j}function ps(e){return e.h?1:e.g?e.g.size:0}function fs(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function gs(e,t){e.g?e.g.add(t):e.h=t}function ys(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function vs(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return Vn(e.i)}function bs(){}function _s(){this.g=new bs}function ws(e,t,n){const r=n||"";try{Fi(e,function(e,n){let i=e;xn(e)&&(i=Vr(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function Es(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(s){}}function Ss(e){this.l=e.ac||null,this.j=e.jb||!1}function Is(e,t){Mr.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=Cs,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}us.prototype.cancel=function(){if(this.i=vs(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}},bs.prototype.stringify=function(e){return Cn.JSON.stringify(e,void 0)},bs.prototype.parse=function(e){return Cn.JSON.parse(e,void 0)},Mn(Ss,gi),Ss.prototype.g=function(){return new Is(this.l,this.j)},Ss.prototype.i=(hs={},function(){return hs}),Mn(Is,Mr);var Cs=0;function Ts(e){e.j.read().then(e.Ta.bind(e)).catch(e.ga.bind(e))}function ks(e){e.readyState=4,e.l=null,e.j=null,e.A=null,xs(e)}function xs(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(En=Is.prototype).open=function(e,t){if(this.readyState!=Cs)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,xs(this)},En.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||Cn).fetch(new Request(this.B,t)).then(this.Wa.bind(this),this.ga.bind(this))},En.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,ks(this)),this.readyState=Cs},En.Wa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,xs(this)),this.g&&(this.readyState=3,xs(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if("undefined"!==typeof Cn.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Ts(this)}else e.text().then(this.Va.bind(this),this.ga.bind(this))},En.Ta=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?ks(this):xs(this),3==this.readyState&&Ts(this)}},En.Va=function(e){this.g&&(this.response=this.responseText=e,ks(this))},En.Ua=function(e){this.g&&(this.response=e,ks(this))},En.ga=function(){this.g&&ks(this)},En.setRequestHeader=function(e,t){this.v.append(e,t)},En.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},En.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Is.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Ns=Cn.JSON.parse;function As(e){Mr.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Rs,this.K=this.L=!1}Mn(As,Mr);var Rs="",Ds=/^https?$/i,Os=["POST","PUT"];function Ps(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Ms(e),Ls(e)}function Ms(e){e.D||(e.D=!0,jr(e,"complete"),jr(e,"error"))}function js(e){if(e.h&&"undefined"!=typeof In&&(!e.C[1]||4!=Bs(e)||2!=e.aa()))if(e.v&&4==Bs(e))Jr(e.Ha,0,e);else if(jr(e,"readystatechange"),4==Bs(e)){e.h=!1;try{const c=e.aa();e:switch(c){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===c){var i=String(e.H).match(Ui)[1]||null;if(!i&&Cn.self&&Cn.self.location){var s=Cn.self.location.protocol;i=s.substr(0,s.length-1)}r=!Ds.test(i?i.toLowerCase():"")}n=r}if(n)jr(e,"complete"),jr(e,"success");else{e.m=6;try{var o=2<Bs(e)?e.g.statusText:""}catch(a){o=""}e.j=o+" ["+e.aa()+"]",Ms(e)}}finally{Ls(e)}}}function Ls(e,t){if(e.g){Vs(e);const r=e.g,i=e.C[0]?Tn:null;e.g=null,e.C=null,t||jr(e,"ready");try{r.onreadystatechange=i}catch(n){}}}function Vs(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(Cn.clearTimeout(e.A),e.A=null)}function Bs(e){return e.g?e.g.readyState:0}function Fs(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case Rs:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Us(e){let t="";return gr(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function zs(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Us(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):Ki(e,t,n))}function qs(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Gs(e){this.Ca=0,this.i=[],this.j=new ri,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=qs("failFast",!1,e),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=qs("baseRetryDelayMs",5e3,e),this.bb=qs("retryDelaySeedMs",1e4,e),this.$a=qs("forwardChannelMaxRetries",2,e),this.ta=qs("forwardChannelRequestTimeoutMs",2e4,e),this.ra=e&&e.xmlHttpFactory||void 0,this.Da=e&&e.Zb||!1,this.J=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.I="",this.h=new us(e&&e.concurrentRequestLimit),this.Fa=new _s,this.O=e&&e.fastHandshake||!1,this.N=e&&e.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=e&&e.Xb||!1,e&&e.Aa&&this.j.Aa(),e&&e.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&e&&e.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function Hs(e){if(Ks(e),3==e.G){var t=e.U++,n=qi(e.F);Ki(n,"SID",e.I),Ki(n,"RID",t),Ki(n,"TYPE","terminate"),Js(e,n),(t=new Ii(e,e.j,t,void 0)).K=2,t.v=Qi(qi(n)),n=!1,Cn.navigator&&Cn.navigator.sendBeacon&&(n=Cn.navigator.sendBeacon(t.v.toString(),"")),!n&&Cn.Image&&((new Image).src=t.v,n=!0),n||(t.g=co(t.l,null),t.g.da(t.v)),t.F=Date.now(),Pi(t)}oo(e)}function Ws(e){e.g&&(eo(e),e.g.cancel(),e.g=null)}function Ks(e){Ws(e),e.u&&(Cn.clearTimeout(e.u),e.u=null),no(e),e.h.cancel(),e.m&&("number"===typeof e.m&&Cn.clearTimeout(e.m),e.m=null)}function Qs(e){ms(e.h)||e.m||(e.m=!0,Gr(e.Ja,e),e.C=0)}function Ys(e,t){var n;n=t?t.m:e.U++;const r=qi(e.F);Ki(r,"SID",e.I),Ki(r,"RID",n),Ki(r,"AID",e.T),Js(e,r),e.o&&e.s&&zs(r,e.o,e.s),n=new Ii(e,e.j,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.i=t.D.concat(e.i)),t=Xs(e,n,1e3),n.setTimeout(Math.round(.5*e.ta)+Math.round(.5*e.ta*Math.random())),gs(e.h,n),Ni(n,r,t)}function Js(e,t){e.ia&&gr(e.ia,function(e,n){Ki(t,n,e)}),e.l&&Fi({},function(e,n){Ki(t,n,e)})}function Xs(e,t,n){n=Math.min(e.i.length,n);var r=e.l?On(e.l.Ra,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].h,e.push("ofs="+t)):t=0:e.push("ofs="+t);let o=!0;for(let a=0;a<n;a++){let n=i[a].h;const c=i[a].g;if(n-=t,0>n)t=Math.max(0,i[a].h-100),o=!1;else try{ws(c,e,"req"+n+"_")}catch(s){r&&r(c)}}if(o){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function Zs(e){e.g||e.u||(e.Z=1,Gr(e.Ia,e),e.A=0)}function $s(e){return!(e.g||e.u||3<=e.A)&&(e.Z++,e.u=mi(On(e.Ia,e),io(e,e.A)),e.A++,!0)}function eo(e){null!=e.B&&(Cn.clearTimeout(e.B),e.B=null)}function to(e){e.g=new Ii(e,e.j,"rpc",e.Z),null===e.o&&(e.g.H=e.s),e.g.N=0;var t=qi(e.sa);Ki(t,"RID","rpc"),Ki(t,"SID",e.I),Ki(t,"CI",e.L?"0":"1"),Ki(t,"AID",e.T),Ki(t,"TYPE","xmlhttp"),Js(e,t),e.o&&e.s&&zs(t,e.o,e.s),e.J&&e.g.setTimeout(e.J);var n=e.g;e=e.ka,n.K=1,n.v=Qi(qi(t)),n.s=null,n.P=!0,Ai(n,e)}function no(e){null!=e.v&&(Cn.clearTimeout(e.v),e.v=null)}function ro(e,t){var n=null;if(e.g==t){no(e),eo(e),e.g=null;var r=2}else{if(!fs(e.h,t))return;n=t.D,ys(e.h,t),r=1}if(0!=e.G)if(e.pa=t.Y,t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;jr(r=ai(),new di(r,n)),Qs(e)}else Zs(e);else if(3==(i=t.o)||0==i&&0<e.pa||!(1==r&&function(e,t){return!(ps(e.h)>=e.h.j-(e.m?1:0))&&(e.m?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.C>=(e.Za?0:e.$a))&&(e.m=mi(On(e.Ja,e,t),io(e,e.C)),e.C++,!0))}(e,t)||2==r&&$s(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:so(e,5);break;case 4:so(e,10);break;case 3:so(e,6);break;default:so(e,2)}}function io(e,t){let n=e.Xa+Math.floor(Math.random()*e.bb);return e.l||(n*=2),n*t}function so(e,t){if(e.j.info("Error code "+t),2==t){var n=null;e.l&&(n=null);var r=On(e.kb,e);n||(n=new zi("//www.google.com/images/cleardot.gif"),Cn.location&&"http"==Cn.location.protocol||Gi(n,"https"),Qi(n)),function(e,t){const n=new ri;if(Cn.Image){const r=new Image;r.onload=Pn(Es,n,r,"TestLoadImage: loaded",!0,t),r.onerror=Pn(Es,n,r,"TestLoadImage: error",!1,t),r.onabort=Pn(Es,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=Pn(Es,n,r,"TestLoadImage: timeout",!1,t),Cn.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(n.toString(),r)}else hi(2);e.G=0,e.l&&e.l.va(t),oo(e),Ks(e)}function oo(e){if(e.G=0,e.la=[],e.l){const t=vs(e.h);0==t.length&&0==e.i.length||(Bn(e.la,t),Bn(e.la,e.i),e.h.i.length=0,Vn(e.i),e.i.length=0),e.l.ua()}}function ao(e,t,n){var r=n instanceof zi?qi(n):new zi(n,void 0);if(""!=r.g)t&&(r.g=t+"."+r.g),Hi(r,r.m);else{var i=Cn.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new zi(null,void 0);r&&Gi(s,r),t&&(s.g=t),i&&Hi(s,i),n&&(s.l=n),r=s}return n=e.D,t=e.za,n&&t&&Ki(r,n,t),Ki(r,"VER",e.ma),Js(e,r),r}function co(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Da&&!e.ra?new As(new Ss({jb:!0})):new As(e.ra)).Ka(e.H),t}function lo(){}function uo(){if(Jn&&!(10<=Number(lr)))throw Error("Environmental error: no available transport.")}function ho(e,t){Mr.call(this),this.g=new Gs(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.S=e,(e=t&&t.Yb)&&!zn(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!zn(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new fo(this)}function mo(e){wi.call(this);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function po(){Ei.call(this),this.status=1}function fo(e){this.g=e}(En=As.prototype).Ka=function(e){this.L=e},En.da=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():bi.g(),this.C=this.u?yi(this.u):yi(bi),this.g.onreadystatechange=On(this.Ha,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(s){return void Ps(this,s)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),i=Cn.FormData&&e instanceof Cn.FormData,!(0<=Ln(Os,t))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[o,a]of n)this.g.setRequestHeader(o,a);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Vs(this),0<this.B&&((this.K=function(e){return Jn&&ar()&&"number"===typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=On(this.qa,this)):this.A=Jr(this.qa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(s){Ps(this,s)}},En.qa=function(){"undefined"!=typeof In&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,jr(this,"timeout"),this.abort(8))},En.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,jr(this,"complete"),jr(this,"abort"),Ls(this))},En.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ls(this,!0)),As.X.M.call(this)},En.Ha=function(){this.s||(this.F||this.v||this.l?js(this):this.fb())},En.fb=function(){js(this)},En.aa=function(){try{return 2<Bs(this)?this.g.status:-1}catch(hs){return-1}},En.fa=function(){try{return this.g?this.g.responseText:""}catch(hs){return""}},En.Sa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Ns(t)}},En.Ea=function(){return this.m},En.Oa=function(){return"string"===typeof this.j?this.j:String(this.j)},(En=Gs.prototype).ma=8,En.G=1,En.Ja=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const i=new Ii(this,this.j,e,void 0);let s=this.s;if(this.S&&(s?(s=yr(s),br(s,this.S)):s=this.S),null!==this.o||this.N||(i.H=s,s=null),this.O)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.g&&"string"===typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Xs(this,i,t),Ki(n=qi(this.F),"RID",e),Ki(n,"CVER",22),this.D&&Ki(n,"X-HTTP-Session-Id",this.D),Js(this,n),s&&(this.N?t="headers="+encodeURIComponent(String(Us(s)))+"&"+t:this.o&&zs(n,this.o,s)),gs(this.h,i),this.Ya&&Ki(n,"TYPE","init"),this.O?(Ki(n,"$req",t),Ki(n,"SID","null"),i.Z=!0,Ni(i,n,null)):Ni(i,n,t),this.G=2}}else 3==this.G&&(e?Ys(this,e):0==this.i.length||ms(this.h)||Ys(this))},En.Ia=function(){if(this.u=null,to(this),this.$&&!(this.K||null==this.g||0>=this.P)){var e=2*this.P;this.j.info("BP detection timer enabled: "+e),this.B=mi(On(this.eb,this),e)}},En.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,hi(10),Ws(this),to(this))},En.cb=function(){null!=this.v&&(this.v=null,Ws(this),$s(this),hi(19))},En.kb=function(e){e?(this.j.info("Successfully pinged google.com"),hi(2)):(this.j.info("Failed to ping google.com"),hi(1))},(En=lo.prototype).xa=function(){},En.wa=function(){},En.va=function(){},En.ua=function(){},En.Ra=function(){},uo.prototype.g=function(e,t){return new ho(e,t)},Mn(ho,Mr),ho.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;hi(0),e.V=t,e.ia=n||{},e.L=e.Y,e.F=ao(e,null,e.V),Qs(e)},ho.prototype.close=function(){Hs(this.g)},ho.prototype.u=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=Vr(e),e=n);t.i.push(new ls(t.ab++,e)),3==t.G&&Qs(t)},ho.prototype.M=function(){this.g.l=null,delete this.j,Hs(this.g),delete this.g,ho.X.M.call(this)},Mn(mo,wi),Mn(po,Ei),Mn(fo,lo),fo.prototype.xa=function(){jr(this.g,"a")},fo.prototype.wa=function(e){jr(this.g,new mo(e))},fo.prototype.va=function(e){jr(this.g,new po)},fo.prototype.ua=function(){jr(this.g,"b")},uo.prototype.createWebChannel=uo.prototype.g,ho.prototype.send=ho.prototype.u,ho.prototype.open=ho.prototype.m,ho.prototype.close=ho.prototype.close,pi.NO_ERROR=0,pi.TIMEOUT=8,pi.HTTP_ERROR=6,fi.COMPLETE="complete",vi.EventType=_i,_i.OPEN="a",_i.CLOSE="b",_i.ERROR="c",_i.MESSAGE="d",Mr.prototype.listen=Mr.prototype.N,As.prototype.listenOnce=As.prototype.O,As.prototype.getLastError=As.prototype.Oa,As.prototype.getLastErrorCode=As.prototype.Ea,As.prototype.getStatus=As.prototype.aa,As.prototype.getResponseJson=As.prototype.Sa,As.prototype.getResponseText=As.prototype.fa,As.prototype.send=As.prototype.da,As.prototype.setWithCredentials=As.prototype.Ka;var go=pi,yo=fi,vo=si,bo=10,_o=11,wo=Ss,Eo=vi,So=As;const Io="@firebase/firestore";class Co{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Co.UNAUTHENTICATED=new Co(null),Co.GOOGLE_CREDENTIALS=new Co("google-credentials-uid"),Co.FIRST_PARTY=new Co("first-party-uid"),Co.MOCK_USER=new Co("mock-user");let To="9.12.1";const ko=new at("@firebase/firestore");function xo(){return ko.logLevel}function No(e){if(ko.logLevel<=tt.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Do);ko.debug("Firestore (".concat(To,"): ").concat(e),...i)}}function Ao(e){if(ko.logLevel<=tt.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Do);ko.error("Firestore (".concat(To,"): ").concat(e),...i)}}function Ro(e){if(ko.logLevel<=tt.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Do);ko.warn("Firestore (".concat(To,"): ").concat(e),...i)}}function Do(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(n){return e}var t}function Oo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state";const t="FIRESTORE (".concat(To,") INTERNAL ASSERTION FAILED: ")+e;throw Ao(t),new Error(t)}function Po(e,t){e||Oo()}function Mo(e,t){return e}const jo={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Lo extends He{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class Vo{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class Bo{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class Fo{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Co.UNAUTHENTICATED))}shutdown(){}}class Uo{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class zo{constructor(e){this.t=e,this.currentUser=Co.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new Vo;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Vo,e.enqueueRetryable(()=>r(this.currentUser))};const s=()=>{const t=i;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},o=e=>{No("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit(e=>o(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(No("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Vo)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(No("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Po("string"==typeof t.accessToken),new Bo(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Po(null===e||"string"==typeof e),new Co(e)}}class qo{constructor(e,t,n,r){this.h=e,this.l=t,this.m=n,this.g=r,this.type="FirstParty",this.user=Co.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(Po(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class Go{constructor(e,t,n,r){this.h=e,this.l=t,this.m=n,this.g=r}getToken(){return Promise.resolve(new qo(this.h,this.l,this.m,this.g))}start(e,t){e.enqueueRetryable(()=>t(Co.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Ho{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Wo{constructor(e){this.T=e,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(e,t){const n=e=>{null!=e.error&&No("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.A;return this.A=e.token,No("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{No("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.T.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.T.getImmediate({optional:!0});e?r(e):No("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(Po("string"==typeof e.token),this.A=e.token,new Ho(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Ko(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class Qo{static R(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=Ko(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function Yo(e,t){return e<t?-1:e>t?1:0}function Jo(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}class Xo{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Lo(jo.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Lo(jo.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Lo(jo.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Lo(jo.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Xo.fromMillis(Date.now())}static fromDate(e){return Xo.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Xo(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Yo(this.nanoseconds,e.nanoseconds):Yo(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Zo{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Zo(e)}static min(){return new Zo(new Xo(0,0))}static max(){return new Zo(new Xo(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class $o{constructor(e,t,n){void 0===t?t=0:t>e.length&&Oo(),void 0===n?n=e.length-t:n>e.length-t&&Oo(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===$o.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof $o?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class ea extends $o{construct(e,t,n){return new ea(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new Lo(jo.INVALID_ARGUMENT,"Invalid segment (".concat(i,"). Paths must not contain // in them."));e.push(...i.split("/").filter(e=>e.length>0))}return new ea(e)}static emptyPath(){return new ea([])}}const ta=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class na extends $o{construct(e,t,n){return new na(e,t,n)}static isValidIdentifier(e){return ta.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),na.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new na(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new Lo(jo.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Lo(jo.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Lo(jo.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new Lo(jo.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new na(t)}static emptyPath(){return new na([])}}class ra{constructor(e){this.path=e}static fromPath(e){return new ra(ea.fromString(e))}static fromName(e){return new ra(ea.fromString(e).popFirst(5))}static empty(){return new ra(ea.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===ea.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return ea.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ra(new ea(e.slice()))}}function ia(e){return new sa(e.readTime,e.key,-1)}class sa{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new sa(Zo.min(),ra.empty(),-1)}static max(){return new sa(Zo.max(),ra.empty(),-1)}}function oa(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=ra.comparator(e.documentKey,t.documentKey),0!==n?n:Yo(e.largestBatchId,t.largestBatchId))}class aa{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function ca(e){if(e.code!==jo.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;No("LocalStore","Unexpectedly lost primary lease")}class la{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Oo(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new la((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof la?t:la.resolve(t)}catch(t){return la.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):la.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):la.reject(t)}static resolve(e){return new la((t,n)=>{t(e)})}static reject(e){return new la((t,n)=>{n(e)})}static waitFor(e){return new la((t,n)=>{let r=0,i=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++i,s&&i===r&&t()},e=>n(e))}),s=!0,i===r&&t()})}static or(e){let t=la.resolve(!1);for(const n of e)t=t.next(e=>e?la.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new la((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const c=a;t(e[c]).next(e=>{s[c]=e,++o,o===i&&n(s)},e=>r(e))}})}static doWhile(e,t){return new la((n,r)=>{const i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}function ua(e){return"IndexedDbTransactionError"===e.name}class ha{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ut(e),this.ct=e=>t.writeSequenceNumber(e))}ut(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ct&&this.ct(e),e}}function da(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function ma(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function pa(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}ha.at=-1;class fa{constructor(e,t){this.comparator=e,this.root=t||ya.EMPTY}insert(e,t){return new fa(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ya.BLACK,null,null))}remove(e){return new fa(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ya.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push("".concat(t,":").concat(n)),!1)),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ga(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ga(this.root,e,this.comparator,!1)}getReverseIterator(){return new ga(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ga(this.root,e,this.comparator,!0)}}class ga{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ya{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:ya.RED,this.left=null!=r?r:ya.EMPTY,this.right=null!=i?i:ya.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new ya(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return ya.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return ya.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ya.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ya.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Oo();if(this.right.isRed())throw Oo();const e=this.left.check();if(e!==this.right.check())throw Oo();return e+(this.isRed()?0:1)}}ya.EMPTY=null,ya.RED=!0,ya.BLACK=!1,ya.EMPTY=new class{constructor(){this.size=0}get key(){throw Oo()}get value(){throw Oo()}get color(){throw Oo()}get left(){throw Oo()}get right(){throw Oo()}copy(e,t,n,r,i){return this}insert(e,t,n){return new ya(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class va{constructor(e){this.comparator=e,this.data=new fa(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ba(this.data.getIterator())}getIteratorFrom(e){return new ba(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof va))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new va(this.comparator);return t.data=e,t}}class ba{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class _a{constructor(e){this.fields=e,e.sort(na.comparator)}static empty(){return new _a([])}unionWith(e){let t=new va(na.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new _a(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Jo(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class wa{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new wa(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new wa(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Yo(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}wa.EMPTY_BYTE_STRING=new wa("");const Ea=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Sa(e){if(Po(!!e),"string"==typeof e){let t=0;const n=Ea.exec(e);if(Po(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Ia(e.seconds),nanos:Ia(e.nanos)}}function Ia(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Ca(e){return"string"==typeof e?wa.fromBase64String(e):wa.fromUint8Array(e)}function Ta(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ka(e){const t=e.mapValue.fields.__previous_value__;return Ta(t)?ka(t):t}function xa(e){const t=Sa(e.mapValue.fields.__local_write_time__.timestampValue);return new Xo(t.seconds,t.nanos)}class Na{constructor(e,t,n,r,i,s,o,a){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class Aa{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Aa("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Aa&&e.projectId===this.projectId&&e.database===this.database}}function Ra(e){return null==e}function Da(e){return 0===e&&1/e==-1/0}const Oa={fields:{__type__:{stringValue:"__max__"}}};function Pa(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Ta(e)?4:function(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}(e)?9007199254740991:10:Oo()}function Ma(e,t){if(e===t)return!0;const n=Pa(e);if(n!==Pa(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return xa(e).isEqual(xa(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Sa(e.timestampValue),r=Sa(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return r=t,Ca(e.bytesValue).isEqual(Ca(r.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Ia(e.geoPointValue.latitude)===Ia(t.geoPointValue.latitude)&&Ia(e.geoPointValue.longitude)===Ia(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Ia(e.integerValue)===Ia(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Ia(e.doubleValue),r=Ia(t.doubleValue);return n===r?Da(n)===Da(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Jo(e.arrayValue.values||[],t.arrayValue.values||[],Ma);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(da(n)!==da(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Ma(n[i],r[i])))return!1;return!0}(e,t);default:return Oo()}var r}function ja(e,t){return void 0!==(e.values||[]).find(e=>Ma(e,t))}function La(e,t){if(e===t)return 0;const n=Pa(e),r=Pa(t);if(n!==r)return Yo(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Yo(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Ia(e.integerValue||e.doubleValue),r=Ia(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Va(e.timestampValue,t.timestampValue);case 4:return Va(xa(e),xa(t));case 5:return Yo(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Ca(e),r=Ca(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=Yo(n[i],r[i]);if(0!==e)return e}return Yo(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Yo(Ia(e.latitude),Ia(t.latitude));return 0!==n?n:Yo(Ia(e.longitude),Ia(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=La(n[i],r[i]);if(e)return e}return Yo(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===Oa&&t===Oa)return 0;if(e===Oa)return 1;if(t===Oa)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){const e=Yo(r[o],s[o]);if(0!==e)return e;const t=La(n[r[o]],i[s[o]]);if(0!==t)return t}return Yo(r.length,s.length)}(e.mapValue,t.mapValue);default:throw Oo()}}function Va(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Yo(e,t);const n=Sa(e),r=Sa(t),i=Yo(n.seconds,r.seconds);return 0!==i?i:Yo(n.nanos,r.nanos)}function Ba(e){return Fa(e)}function Fa(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Sa(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Ca(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,ra.fromName(n).toString()):"geoPointValue"in e?"geo(".concat((t=e.geoPointValue).latitude,",").concat(t.longitude,")"):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Fa(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+="".concat(i,":").concat(Fa(e.fields[i]));return n+"}"}(e.mapValue):Oo();var t,n}function Ua(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function za(e){return!!e&&"integerValue"in e}function qa(e){return!!e&&"arrayValue"in e}function Ga(e){return!!e&&"nullValue"in e}function Ha(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Wa(e){return!!e&&"mapValue"in e}function Ka(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return ma(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=Ka(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Ka(e.arrayValue.values[n]);return t}return Object.assign({},e)}class Qa{constructor(e){this.value=e}static empty(){return new Qa({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Wa(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ka(t)}setAll(e){let t=na.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Ka(e):r.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Wa(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ma(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Wa(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){ma(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new Qa(Ka(this.value))}}class Ya{constructor(e,t,n,r,i,s){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.data=i,this.documentState=s}static newInvalidDocument(e){return new Ya(e,0,Zo.min(),Zo.min(),Qa.empty(),0)}static newFoundDocument(e,t,n){return new Ya(e,1,t,Zo.min(),n,0)}static newNoDocument(e,t){return new Ya(e,2,t,Zo.min(),Qa.empty(),0)}static newUnknownDocument(e,t){return new Ya(e,3,t,Zo.min(),Qa.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Qa.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Qa.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Zo.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Ya&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ya(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class Ja{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.ht=null}}function Xa(e){return new Ja(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Za(e){const t=Mo(e);if(null===t.ht){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>{return(t=e).field.canonicalString()+t.op.toString()+Ba(t.value);var t}).join(","),e+="|ob:",e+=t.orderBy.map(e=>{return(t=e).field.canonicalString()+t.dir;var t}).join(","),Ra(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>Ba(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>Ba(e)).join(",")),t.ht=e}return t.ht}function $a(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let i=0;i<e.orderBy.length;i++)if(!dc(e.orderBy[i],t.orderBy[i]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let i=0;i<e.filters.length;i++)if(n=e.filters[i],r=t.filters[i],n.op!==r.op||!n.field.isEqual(r.field)||!Ma(n.value,r.value))return!1;var n,r;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!pc(e.startAt,t.startAt)&&pc(e.endAt,t.endAt)}function ec(e){return ra.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class tc extends class{}{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.lt(e,t,n):new nc(e,t,n):"array-contains"===t?new oc(e,n):"in"===t?new ac(e,n):"not-in"===t?new cc(e,n):"array-contains-any"===t?new lc(e,n):new tc(e,t,n)}static lt(e,t,n){return"in"===t?new rc(e,n):new ic(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.ft(La(t,this.value)):null!==t&&Pa(this.value)===Pa(t)&&this.ft(La(t,this.value))}ft(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Oo()}}dt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class nc extends tc{constructor(e,t,n){super(e,t,n),this.key=ra.fromName(n.referenceValue)}matches(e){const t=ra.comparator(e.key,this.key);return this.ft(t)}}class rc extends tc{constructor(e,t){super(e,"in",t),this.keys=sc("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class ic extends tc{constructor(e,t){super(e,"not-in",t),this.keys=sc("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function sc(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>ra.fromName(e.referenceValue))}class oc extends tc{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return qa(t)&&ja(t.arrayValue,this.value)}}class ac extends tc{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&ja(this.value.arrayValue,t)}}class cc extends tc{constructor(e,t){super(e,"not-in",t)}matches(e){if(ja(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!ja(this.value.arrayValue,t)}}class lc extends tc{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!qa(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>ja(this.value.arrayValue,e))}}class uc{constructor(e,t){this.position=e,this.inclusive=t}}class hc{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function dc(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function mc(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?ra.comparator(ra.fromName(o.referenceValue),n.key):La(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function pc(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Ma(e.position[n],t.position[n]))return!1;return!0}class fc{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this._t=null,this.wt=null,this.startAt,this.endAt}}function gc(e){return new fc(e)}function yc(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function vc(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function bc(e){for(const t of e.filters)if(t.dt())return t.field;return null}function _c(e){return null!==e.collectionGroup}function wc(e){const t=Mo(e);if(null===t._t){t._t=[];const e=bc(t),n=vc(t);if(null!==e&&null===n)e.isKeyField()||t._t.push(new hc(e)),t._t.push(new hc(na.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t._t.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t._t.push(new hc(na.keyField(),e))}}}return t._t}function Ec(e){const t=Mo(e);if(!t.wt)if("F"===t.limitType)t.wt=Xa(t.path,t.collectionGroup,wc(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const i of wc(t)){const t="desc"===i.dir?"asc":"desc";e.push(new hc(i.field,t))}const n=t.endAt?new uc(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new uc(t.startAt.position,t.startAt.inclusive):null;t.wt=Xa(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}return t.wt}function Sc(e,t,n){return new fc(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Ic(e,t){return $a(Ec(e),Ec(t))&&e.limitType===t.limitType}function Cc(e){return"".concat(Za(Ec(e)),"|lt:").concat(e.limitType)}function Tc(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(e=>{return"".concat((t=e).field.canonicalString()," ").concat(t.op," ").concat(Ba(t.value));var t}).join(", "),"]")),Ra(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(e=>{return"".concat((t=e).field.canonicalString()," (").concat(t.dir,")");var t}).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>Ba(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>Ba(e)).join(",")),"Target(".concat(t,")")}(Ec(e)),"; limitType=").concat(e.limitType,")")}function kc(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):ra.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of e.explicitOrderBy)if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&(r=t,!((n=e).startAt&&!function(e,t,n){const r=mc(e,t,n);return e.inclusive?r<=0:r<0}(n.startAt,wc(n),r))&&!(n.endAt&&!function(e,t,n){const r=mc(e,t,n);return e.inclusive?r>=0:r>0}(n.endAt,wc(n),r)));var n,r}function xc(e){return(t,n)=>{let r=!1;for(const i of wc(e)){const e=Nc(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function Nc(e,t,n){const r=e.field.isKeyField()?ra.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?La(r,i):Oo()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Oo()}}function Ac(e,t){if(e.gt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Da(t)?"-0":t}}function Rc(e){return{integerValue:""+e}}function Dc(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!Da(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?Rc(t):Ac(e,t)}class Oc{constructor(){this._=void 0}}function Pc(e,t,n){return e instanceof jc?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Lc?Vc(e,t):e instanceof Bc?Fc(e,t):function(e,t){const n=function(e,t){return e instanceof Uc?za(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}(e,t),r=zc(n)+zc(e.yt);return za(n)&&za(e.yt)?Rc(r):Ac(e.It,r)}(e,t)}function Mc(e,t,n){return e instanceof Lc?Vc(e,t):e instanceof Bc?Fc(e,t):n}class jc extends Oc{}class Lc extends Oc{constructor(e){super(),this.elements=e}}function Vc(e,t){const n=qc(t);for(const r of e.elements)n.some(e=>Ma(e,r))||n.push(r);return{arrayValue:{values:n}}}class Bc extends Oc{constructor(e){super(),this.elements=e}}function Fc(e,t){let n=qc(t);for(const r of e.elements)n=n.filter(e=>!Ma(e,r));return{arrayValue:{values:n}}}class Uc extends Oc{constructor(e,t){super(),this.It=e,this.yt=t}}function zc(e){return Ia(e.integerValue||e.doubleValue)}function qc(e){return qa(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Gc{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Gc}static exists(e){return new Gc(void 0,e)}static updateTime(e){return new Gc(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Hc(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Wc{}function Kc(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new nl(e.key,Gc.none()):new Xc(e.key,e.data,Gc.none());{const n=e.data,r=Qa.empty();let i=new va(na.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new Zc(e.key,r,new _a(i.toArray()),Gc.none())}}function Qc(e,t,n){var r;e instanceof Xc?function(e,t,n){const r=e.value.clone(),i=el(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Zc?function(e,t,n){if(!Hc(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=el(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll($c(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):(r=n,t.convertToNoDocument(r.version).setHasCommittedMutations())}function Yc(e,t,n,r){return e instanceof Xc?function(e,t,n,r){if(!Hc(e.precondition,t))return n;const i=e.value.clone(),s=tl(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Zc?function(e,t,n,r){if(!Hc(e.precondition,t))return n;const i=tl(e.fieldTransforms,r,t),s=t.data;return s.setAll($c(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):(i=t,s=n,Hc(e.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):s);var i,s}function Jc(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(n=e.fieldTransforms,r=t.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&Jo(n,r,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&(n=e.transform,r=t.transform,n instanceof Lc&&r instanceof Lc||n instanceof Bc&&r instanceof Bc?Jo(n.elements,r.elements,Ma):n instanceof Uc&&r instanceof Uc?Ma(n.yt,r.yt):n instanceof jc&&r instanceof jc);var n,r}(e,t))))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask));var n,r}class Xc extends Wc{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Zc extends Wc{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function $c(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function el(e,t,n){const r=new Map;Po(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,Mc(o,a,n[i]))}return r}function tl(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,Pc(e,s,t))}return r}class nl extends Wc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class rl{constructor(e){this.count=e}}var il,sl;function ol(e){if(void 0===e)return Ao("GRPC error has no .code"),jo.UNKNOWN;switch(e){case il.OK:return jo.OK;case il.CANCELLED:return jo.CANCELLED;case il.UNKNOWN:return jo.UNKNOWN;case il.DEADLINE_EXCEEDED:return jo.DEADLINE_EXCEEDED;case il.RESOURCE_EXHAUSTED:return jo.RESOURCE_EXHAUSTED;case il.INTERNAL:return jo.INTERNAL;case il.UNAVAILABLE:return jo.UNAVAILABLE;case il.UNAUTHENTICATED:return jo.UNAUTHENTICATED;case il.INVALID_ARGUMENT:return jo.INVALID_ARGUMENT;case il.NOT_FOUND:return jo.NOT_FOUND;case il.ALREADY_EXISTS:return jo.ALREADY_EXISTS;case il.PERMISSION_DENIED:return jo.PERMISSION_DENIED;case il.FAILED_PRECONDITION:return jo.FAILED_PRECONDITION;case il.ABORTED:return jo.ABORTED;case il.OUT_OF_RANGE:return jo.OUT_OF_RANGE;case il.UNIMPLEMENTED:return jo.UNIMPLEMENTED;case il.DATA_LOSS:return jo.DATA_LOSS;default:return Oo()}}(sl=il||(il={}))[sl.OK=0]="OK",sl[sl.CANCELLED=1]="CANCELLED",sl[sl.UNKNOWN=2]="UNKNOWN",sl[sl.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",sl[sl.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",sl[sl.NOT_FOUND=5]="NOT_FOUND",sl[sl.ALREADY_EXISTS=6]="ALREADY_EXISTS",sl[sl.PERMISSION_DENIED=7]="PERMISSION_DENIED",sl[sl.UNAUTHENTICATED=16]="UNAUTHENTICATED",sl[sl.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",sl[sl.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",sl[sl.ABORTED=10]="ABORTED",sl[sl.OUT_OF_RANGE=11]="OUT_OF_RANGE",sl[sl.UNIMPLEMENTED=12]="UNIMPLEMENTED",sl[sl.INTERNAL=13]="INTERNAL",sl[sl.UNAVAILABLE=14]="UNAVAILABLE",sl[sl.DATA_LOSS=15]="DATA_LOSS";class al{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){ma(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return pa(this.inner)}size(){return this.innerSize}}const cl=new fa(ra.comparator);function ll(){return cl}const ul=new fa(ra.comparator);function hl(){let e=ul;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function dl(e){let t=ul;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function ml(){return fl()}function pl(){return fl()}function fl(){return new al(e=>e.toString(),(e,t)=>e.isEqual(t))}new fa(ra.comparator);const gl=new va(ra.comparator);function yl(){let e=gl;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const vl=new va(Yo);function bl(){return vl}class _l{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,wl.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new _l(Zo.min(),r,bl(),ll(),yl())}}class wl{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new wl(n,t,yl(),yl(),yl())}}class El{constructor(e,t,n,r){this.Tt=e,this.removedTargetIds=t,this.key=n,this.Et=r}}class Sl{constructor(e,t){this.targetId=e,this.At=t}}class Il{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wa.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Cl{constructor(){this.Rt=0,this.bt=xl(),this.Pt=wa.EMPTY_BYTE_STRING,this.vt=!1,this.Vt=!0}get current(){return this.vt}get resumeToken(){return this.Pt}get St(){return 0!==this.Rt}get Dt(){return this.Vt}Ct(e){e.approximateByteSize()>0&&(this.Vt=!0,this.Pt=e)}xt(){let e=yl(),t=yl(),n=yl();return this.bt.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Oo()}}),new wl(this.Pt,this.vt,e,t,n)}Nt(){this.Vt=!1,this.bt=xl()}kt(e,t){this.Vt=!0,this.bt=this.bt.insert(e,t)}Ot(e){this.Vt=!0,this.bt=this.bt.remove(e)}Mt(){this.Rt+=1}Ft(){this.Rt-=1}$t(){this.Vt=!0,this.vt=!0}}class Tl{constructor(e){this.Bt=e,this.Lt=new Map,this.Ut=ll(),this.qt=kl(),this.Kt=new va(Yo)}Gt(e){for(const t of e.Tt)e.Et&&e.Et.isFoundDocument()?this.Qt(t,e.Et):this.jt(t,e.key,e.Et);for(const t of e.removedTargetIds)this.jt(t,e.key,e.Et)}Wt(e){this.forEachTarget(e,t=>{const n=this.zt(t);switch(e.state){case 0:this.Ht(t)&&n.Ct(e.resumeToken);break;case 1:n.Ft(),n.St||n.Nt(),n.Ct(e.resumeToken);break;case 2:n.Ft(),n.St||this.removeTarget(t);break;case 3:this.Ht(t)&&(n.$t(),n.Ct(e.resumeToken));break;case 4:this.Ht(t)&&(this.Jt(t),n.Ct(e.resumeToken));break;default:Oo()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Lt.forEach((e,n)=>{this.Ht(n)&&t(n)})}Yt(e){const t=e.targetId,n=e.At.count,r=this.Xt(t);if(r){const e=r.target;if(ec(e))if(0===n){const n=new ra(e.path);this.jt(t,n,Ya.newNoDocument(n,Zo.min()))}else Po(1===n);else this.Zt(t)!==n&&(this.Jt(t),this.Kt=this.Kt.add(t))}}te(e){const t=new Map;this.Lt.forEach((n,r)=>{const i=this.Xt(r);if(i){if(n.current&&ec(i.target)){const t=new ra(i.target.path);null!==this.Ut.get(t)||this.ee(r,t)||this.jt(r,t,Ya.newNoDocument(t,e))}n.Dt&&(t.set(r,n.xt()),n.Nt())}});let n=yl();this.qt.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.Xt(e);return!t||2===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.Ut.forEach((t,n)=>n.setReadTime(e));const r=new _l(e,t,this.Kt,this.Ut,n);return this.Ut=ll(),this.qt=kl(),this.Kt=new va(Yo),r}Qt(e,t){if(!this.Ht(e))return;const n=this.ee(e,t.key)?2:0;this.zt(e).kt(t.key,n),this.Ut=this.Ut.insert(t.key,t),this.qt=this.qt.insert(t.key,this.ne(t.key).add(e))}jt(e,t,n){if(!this.Ht(e))return;const r=this.zt(e);this.ee(e,t)?r.kt(t,1):r.Ot(t),this.qt=this.qt.insert(t,this.ne(t).delete(e)),n&&(this.Ut=this.Ut.insert(t,n))}removeTarget(e){this.Lt.delete(e)}Zt(e){const t=this.zt(e).xt();return this.Bt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Mt(e){this.zt(e).Mt()}zt(e){let t=this.Lt.get(e);return t||(t=new Cl,this.Lt.set(e,t)),t}ne(e){let t=this.qt.get(e);return t||(t=new va(Yo),this.qt=this.qt.insert(e,t)),t}Ht(e){const t=null!==this.Xt(e);return t||No("WatchChangeAggregator","Detected inactive target",e),t}Xt(e){const t=this.Lt.get(e);return t&&t.St?null:this.Bt.se(e)}Jt(e){this.Lt.set(e,new Cl),this.Bt.getRemoteKeysForTarget(e).forEach(t=>{this.jt(e,t,null)})}ee(e,t){return this.Bt.getRemoteKeysForTarget(e).has(t)}}function kl(){return new fa(ra.comparator)}function xl(){return new fa(ra.comparator)}const Nl={asc:"ASCENDING",desc:"DESCENDING"},Al={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class Rl{constructor(e,t){this.databaseId=e,this.gt=t}}function Dl(e,t){return e.gt?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Ol(e,t){return e.gt?t.toBase64():t.toUint8Array()}function Pl(e){return Po(!!e),Zo.fromTimestamp(function(e){const t=Sa(e);return new Xo(t.seconds,t.nanos)}(e))}function Ml(e,t){return(n=e,new ea(["projects",n.projectId,"databases",n.database])).child("documents").child(t).canonicalString();var n}function jl(e){const t=ea.fromString(e);return Po(Xl(t)),t}function Ll(e,t){const n=jl(t);if(n.get(1)!==e.databaseId.projectId)throw new Lo(jo.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Lo(jo.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new ra(Fl(n))}function Vl(e,t){return Ml(e.databaseId,t)}function Bl(e){return new ea(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Fl(e){return Po(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Ul(e,t){return{documents:[Vl(e,t.path)]}}function zl(e,t){const n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=Vl(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=Vl(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(e){if(0===e.length)return;const t=e.map(e=>function(e){if("=="===e.op){if(Ha(e.value))return{unaryFilter:{field:Kl(e.field),op:"IS_NAN"}};if(Ga(e.value))return{unaryFilter:{field:Kl(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Ha(e.value))return{unaryFilter:{field:Kl(e.field),op:"IS_NOT_NAN"}};if(Ga(e.value))return{unaryFilter:{field:Kl(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Kl(e.field),op:Wl(e.op),value:e.value}}}(e));return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(t.filters);i&&(n.structuredQuery.where=i);const s=function(e){if(0!==e.length)return e.map(e=>{return{field:Kl((t=e).field),direction:Hl(t.dir)};var t})}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=(a=e,c=t.limit,a.gt||Ra(c)?c:{value:c});var a,c,l;return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt={before:(l=t.startAt).inclusive,values:l.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function ql(e){let t=function(e){const t=jl(e);return 4===t.length?ea.emptyPath():Fl(t)}(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Po(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=Gl(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(e=>{return new hc(Ql((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t}));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,Ra(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new uc(n,t)}(n.startAt));let l=null;return n.endAt&&(l=function(e){const t=!e.before,n=e.values||[];return new uc(n,t)}(n.endAt)),function(e,t,n,r,i,s,o,a){return new fc(e,t,n,r,i,s,o,a)}(t,i,o,s,a,"F",c,l)}function Gl(e){return e?void 0!==e.unaryFilter?[Jl(e)]:void 0!==e.fieldFilter?[Yl(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(e=>Gl(e)).reduce((e,t)=>e.concat(t)):Oo():[]}function Hl(e){return Nl[e]}function Wl(e){return Al[e]}function Kl(e){return{fieldPath:e.canonicalString()}}function Ql(e){return na.fromServerFormat(e.fieldPath)}function Yl(e){return tc.create(Ql(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Oo()}}(e.fieldFilter.op),e.fieldFilter.value)}function Jl(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Ql(e.unaryFilter.field);return tc.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Ql(e.unaryFilter.field);return tc.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Ql(e.unaryFilter.field);return tc.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Ql(e.unaryFilter.field);return tc.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Oo()}}function Xl(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Zl{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Qc(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Yc(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Yc(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=pl();return this.mutations.forEach(r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=Kc(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(Zo.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),yl())}isEqual(e){return this.batchId===e.batchId&&Jo(this.mutations,e.mutations,(e,t)=>Jc(e,t))&&Jo(this.baseMutations,e.baseMutations,(e,t)=>Jc(e,t))}}class $l{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class eu{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Zo.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Zo.min(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:wa.EMPTY_BYTE_STRING;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o}withSequenceNumber(e){return new eu(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new eu(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new eu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class tu{constructor(e){this.re=e}}function nu(e){const t=ql({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Sc(t,t.limit,"L"):t}class ru{constructor(){this.Ye=new iu}addToCollectionParentIndex(e,t){return this.Ye.add(t),la.resolve()}getCollectionParents(e,t){return la.resolve(this.Ye.getEntries(t))}addFieldIndex(e,t){return la.resolve()}deleteFieldIndex(e,t){return la.resolve()}getDocumentsMatchingTarget(e,t){return la.resolve(null)}getIndexType(e,t){return la.resolve(0)}getFieldIndexes(e,t){return la.resolve([])}getNextCollectionGroupToUpdate(e){return la.resolve(null)}getMinOffset(e,t){return la.resolve(sa.min())}getMinOffsetFromCollectionGroup(e,t){return la.resolve(sa.min())}updateCollectionGroup(e,t,n){return la.resolve()}updateIndexEntries(e,t){return la.resolve()}}class iu{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new va(ea.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new va(ea.comparator)).toArray()}}class su{constructor(e){this.bn=e}next(){return this.bn+=2,this.bn}static Pn(){return new su(0)}static vn(){return new su(-1)}}class ou{constructor(){this.changes=new al(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ya.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?la.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class au{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class cu{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.getBaseDocument(e,t,n))).next(e=>(null!==n&&Yc(n.mutation,e,_a.empty(),Xo.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,yl()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:yl();const r=ml();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=hl();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=ml();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,yl()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=ll();const s=fl(),o=fl();return t.forEach((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof Zc)?i=i.insert(t.key,t):void 0!==o&&(s.set(t.key,o.mutation.getFieldMask()),Yc(o.mutation,t,o.mutation.getFieldMask(),Xo.now()))}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var n;return o.set(e,new au(t,null!==(n=s.get(e))&&void 0!==n?n:null))}),o))}recalculateAndSaveOverlays(e,t){const n=fl();let r=new fa((e,t)=>e-t),i=yl();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const i of e)i.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||_a.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||yl()).add(e);r=r.insert(i.batchId,a)})}).next(()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,c=r.value,l=pl();c.forEach(e=>{if(!i.has(e)){const r=Kc(t.get(e),n.get(e));null!==r&&l.set(e,r),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,a,l))}return la.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n){return r=t,ra.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):_c(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n);var r}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):la.resolve(ml());let o=-1,a=i;return s.next(t=>la.forEach(t,(t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?la.resolve():this.getBaseDocument(e,t,n).next(e=>{a=a.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,a,t,yl())).next(e=>({batchId:o,changes:dl(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ra(t)).next(e=>{let t=hl();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n){const r=t.collectionGroup;let i=hl();return this.indexManager.getCollectionParents(e,r).next(s=>la.forEach(s,s=>{const o=(a=t,c=s.child(r),new fc(c,null,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt));var a,c;return this.getDocumentsMatchingCollectionQuery(e,o,n).next(e=>{e.forEach((e,t)=>{i=i.insert(e,t)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,t,n){let r;return this.remoteDocumentCache.getAllFromCollection(e,t.path,n).next(i=>(r=i,this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId))).next(e=>{e.forEach((e,t)=>{const n=t.getKey();null===r.get(n)&&(r=r.insert(n,Ya.newInvalidDocument(n)))});let n=hl();return r.forEach((r,i)=>{const s=e.get(r);void 0!==s&&Yc(s.mutation,i,_a.empty(),Xo.now()),kc(t,i)&&(n=n.insert(r,i))}),n})}getBaseDocument(e,t,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(e,t):la.resolve(Ya.newInvalidDocument(t))}}class lu{constructor(e){this.It=e,this.Zn=new Map,this.ts=new Map}getBundleMetadata(e,t){return la.resolve(this.Zn.get(t))}saveBundleMetadata(e,t){var n;return this.Zn.set(t.id,{id:(n=t).id,version:n.version,createTime:Pl(n.createTime)}),la.resolve()}getNamedQuery(e,t){return la.resolve(this.ts.get(t))}saveNamedQuery(e,t){return this.ts.set(t.name,{name:(n=t).name,query:nu(n.bundledQuery),readTime:Pl(n.readTime)}),la.resolve();var n}}class uu{constructor(){this.overlays=new fa(ra.comparator),this.es=new Map}getOverlay(e,t){return la.resolve(this.overlays.get(t))}getOverlays(e,t){const n=ml();return la.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.ue(e,t,r)}),la.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.es.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.es.delete(n)),la.resolve()}getOverlaysForCollection(e,t,n){const r=ml(),i=t.length+1,s=new ra(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return la.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new fa((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=ml(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=ml(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((e,t)=>o.set(e,t)),!(o.size()>=r)););return la.resolve(o)}ue(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.es.get(r.largestBatchId).delete(n.key);this.es.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new $l(t,n));let i=this.es.get(t);void 0===i&&(i=yl(),this.es.set(t,i)),this.es.set(t,i.add(n.key))}}class hu{constructor(){this.ns=new va(du.ss),this.rs=new va(du.os)}isEmpty(){return this.ns.isEmpty()}addReference(e,t){const n=new du(e,t);this.ns=this.ns.add(n),this.rs=this.rs.add(n)}us(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.cs(new du(e,t))}hs(e,t){e.forEach(e=>this.removeReference(e,t))}ls(e){const t=new ra(new ea([])),n=new du(t,e),r=new du(t,e+1),i=[];return this.rs.forEachInRange([n,r],e=>{this.cs(e),i.push(e.key)}),i}fs(){this.ns.forEach(e=>this.cs(e))}cs(e){this.ns=this.ns.delete(e),this.rs=this.rs.delete(e)}ds(e){const t=new ra(new ea([])),n=new du(t,e),r=new du(t,e+1);let i=yl();return this.rs.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new du(e,0),n=this.ns.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class du{constructor(e,t){this.key=e,this._s=t}static ss(e,t){return ra.comparator(e.key,t.key)||Yo(e._s,t._s)}static os(e,t){return Yo(e._s,t._s)||ra.comparator(e.key,t.key)}}class mu{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.ws=1,this.gs=new va(du.ss)}checkEmpty(e){return la.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.ws;this.ws++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Zl(i,t,n,r);this.mutationQueue.push(s);for(const o of r)this.gs=this.gs.add(new du(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return la.resolve(s)}lookupMutationBatch(e,t){return la.resolve(this.ys(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ps(n),i=r<0?0:r;return la.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return la.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(e){return la.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new du(t,0),r=new du(t,Number.POSITIVE_INFINITY),i=[];return this.gs.forEachInRange([n,r],e=>{const t=this.ys(e._s);i.push(t)}),la.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new va(Yo);return t.forEach(e=>{const t=new du(e,0),r=new du(e,Number.POSITIVE_INFINITY);this.gs.forEachInRange([t,r],e=>{n=n.add(e._s)})}),la.resolve(this.Is(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;ra.isDocumentKey(i)||(i=i.child(""));const s=new du(new ra(i),0);let o=new va(Yo);return this.gs.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e._s)),!0)},s),la.resolve(this.Is(o))}Is(e){const t=[];return e.forEach(e=>{const n=this.ys(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){Po(0===this.Ts(t.batchId,"removed")),this.mutationQueue.shift();let n=this.gs;return la.forEach(t.mutations,r=>{const i=new du(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.gs=n})}An(e){}containsKey(e,t){const n=new du(t,0),r=this.gs.firstAfterOrEqual(n);return la.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,la.resolve()}Ts(e,t){return this.ps(e)}ps(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}ys(e){const t=this.ps(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class pu{constructor(e){this.Es=e,this.docs=new fa(ra.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.Es(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return la.resolve(n?n.document.mutableCopy():Ya.newInvalidDocument(t))}getEntries(e,t){let n=ll();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Ya.newInvalidDocument(e))}),la.resolve(n)}getAllFromCollection(e,t,n){let r=ll();const i=new ra(t.child("")),s=this.docs.getIteratorFrom(i);for(;s.hasNext();){const{key:e,value:{document:i}}=s.getNext();if(!t.isPrefixOf(e.path))break;e.path.length>t.length+1||oa(ia(i),n)<=0||(r=r.insert(i.key,i.mutableCopy()))}return la.resolve(r)}getAllFromCollectionGroup(e,t,n,r){Oo()}As(e,t){return la.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new fu(this)}getSize(e){return la.resolve(this.size)}}class fu extends ou{constructor(e){super(),this.Yn=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Yn.addEntry(e,r)):this.Yn.removeEntry(n)}),la.waitFor(t)}getFromCache(e,t){return this.Yn.getEntry(e,t)}getAllFromCache(e,t){return this.Yn.getEntries(e,t)}}class gu{constructor(e){this.persistence=e,this.Rs=new al(e=>Za(e),$a),this.lastRemoteSnapshotVersion=Zo.min(),this.highestTargetId=0,this.bs=0,this.Ps=new hu,this.targetCount=0,this.vs=su.Pn()}forEachTarget(e,t){return this.Rs.forEach((e,n)=>t(n)),la.resolve()}getLastRemoteSnapshotVersion(e){return la.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return la.resolve(this.bs)}allocateTargetId(e){return this.highestTargetId=this.vs.next(),la.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.bs&&(this.bs=t),la.resolve()}Dn(e){this.Rs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.vs=new su(t),this.highestTargetId=t),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}addTargetData(e,t){return this.Dn(t),this.targetCount+=1,la.resolve()}updateTargetData(e,t){return this.Dn(t),la.resolve()}removeTargetData(e,t){return this.Rs.delete(t.target),this.Ps.ls(t.targetId),this.targetCount-=1,la.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Rs.forEach((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Rs.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)}),la.waitFor(i).next(()=>r)}getTargetCount(e){return la.resolve(this.targetCount)}getTargetData(e,t){const n=this.Rs.get(t)||null;return la.resolve(n)}addMatchingKeys(e,t,n){return this.Ps.us(t,n),la.resolve()}removeMatchingKeys(e,t,n){this.Ps.hs(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),la.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Ps.ls(t),la.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Ps.ds(t);return la.resolve(n)}containsKey(e,t){return la.resolve(this.Ps.containsKey(t))}}class yu{constructor(e,t){this.Vs={},this.overlays={},this.Ss=new ha(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=e(this),this.Cs=new gu(this),this.indexManager=new ru,this.remoteDocumentCache=new pu(e=>this.referenceDelegate.xs(e)),this.It=new tu(t),this.Ns=new lu(this.It)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new uu,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Vs[e.toKey()];return n||(n=new mu(t,this.referenceDelegate),this.Vs[e.toKey()]=n),n}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(e,t,n){No("MemoryPersistence","Starting transaction:",e);const r=new vu(this.Ss.next());return this.referenceDelegate.ks(),n(r).next(e=>this.referenceDelegate.Os(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ms(e,t){return la.or(Object.values(this.Vs).map(n=>()=>n.containsKey(e,t)))}}class vu extends aa{constructor(e){super(),this.currentSequenceNumber=e}}class bu{constructor(e){this.persistence=e,this.Fs=new hu,this.$s=null}static Bs(e){return new bu(e)}get Ls(){if(this.$s)return this.$s;throw Oo()}addReference(e,t,n){return this.Fs.addReference(n,t),this.Ls.delete(n.toString()),la.resolve()}removeReference(e,t,n){return this.Fs.removeReference(n,t),this.Ls.add(n.toString()),la.resolve()}markPotentiallyOrphaned(e,t){return this.Ls.add(t.toString()),la.resolve()}removeTarget(e,t){this.Fs.ls(t.targetId).forEach(e=>this.Ls.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.Ls.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}ks(){this.$s=new Set}Os(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return la.forEach(this.Ls,n=>{const r=ra.fromPath(n);return this.Us(e,r).next(e=>{e||t.removeEntry(r,Zo.min())})}).next(()=>(this.$s=null,t.apply(e)))}updateLimboDocument(e,t){return this.Us(e,t).next(e=>{e?this.Ls.delete(t.toString()):this.Ls.add(t.toString())})}xs(e){return 0}Us(e,t){return la.or([()=>la.resolve(this.Fs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ms(e,t)])}}class _u{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Si=n,this.Di=r}static Ci(e,t){let n=yl(),r=yl();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new _u(e,t.fromCache,n,r)}}class wu{constructor(){this.xi=!1}initialize(e,t){this.Ni=e,this.indexManager=t,this.xi=!0}getDocumentsMatchingQuery(e,t,n,r){return this.ki(e,t).next(i=>i||this.Oi(e,t,r,n)).next(n=>n||this.Mi(e,t))}ki(e,t){if(yc(t))return la.resolve(null);let n=Ec(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=Sc(t,null,"F"),n=Ec(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const i=yl(...r);return this.Ni.getDocuments(e,i).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const s=this.Fi(t,r);return this.$i(t,s,i,n.readTime)?this.ki(e,Sc(t,null,"F")):this.Bi(e,s,t,n)}))})))}Oi(e,t,n,r){return yc(t)||r.isEqual(Zo.min())?this.Mi(e,t):this.Ni.getDocuments(e,n).next(i=>{const s=this.Fi(t,i);return this.$i(t,s,n,r)?this.Mi(e,t):(xo()<=tt.DEBUG&&No("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Tc(t)),this.Bi(e,s,t,function(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Zo.fromTimestamp(1e9===r?new Xo(n+1,0):new Xo(n,r));return new sa(i,ra.empty(),t)}(r,-1)))})}Fi(e,t){let n=new va(xc(e));return t.forEach((t,r)=>{kc(e,r)&&(n=n.add(r))}),n}$i(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Mi(e,t){return xo()<=tt.DEBUG&&No("QueryEngine","Using full collection scan to execute query:",Tc(t)),this.Ni.getDocumentsMatchingQuery(e,t,sa.min())}Bi(e,t,n,r){return this.Ni.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}class Eu{constructor(e,t,n,r){this.persistence=e,this.Li=t,this.It=r,this.Ui=new fa(Yo),this.qi=new al(e=>Za(e),$a),this.Ki=new Map,this.Gi=e.getRemoteDocumentCache(),this.Cs=e.getTargetCache(),this.Ns=e.getBundleCache(),this.Qi(n)}Qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new cu(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ui))}}async function Su(e,t){const n=Mo(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(i=>(r=i,n.Qi(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const i=[],s=[];let o=yl();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next(e=>({ji:e,removedBatchIds:i,addedBatchIds:s}))})})}function Iu(e){const t=Mo(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Cs.getLastRemoteSnapshotVersion(e))}function Cu(e,t){const n=Mo(e),r=t.snapshotVersion;let i=n.Ui;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=n.Gi.newChangeBuffer({trackRemovals:!0});i=n.Ui;const o=[];t.targetChanges.forEach((s,a)=>{const c=i.get(a);if(!c)return;o.push(n.Cs.removeMatchingKeys(e,s.removedDocuments,a).next(()=>n.Cs.addMatchingKeys(e,s.addedDocuments,a)));let l=c.withSequenceNumber(e.currentSequenceNumber);var u,h,d;t.targetMismatches.has(a)?l=l.withResumeToken(wa.EMPTY_BYTE_STRING,Zo.min()).withLastLimboFreeSnapshotVersion(Zo.min()):s.resumeToken.approximateByteSize()>0&&(l=l.withResumeToken(s.resumeToken,r)),i=i.insert(a,l),h=l,d=s,(0===(u=c).resumeToken.approximateByteSize()||h.snapshotVersion.toMicroseconds()-u.snapshotVersion.toMicroseconds()>=3e8||d.addedDocuments.size+d.modifiedDocuments.size+d.removedDocuments.size>0)&&o.push(n.Cs.updateTargetData(e,l))});let a=ll(),c=yl();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(function(e,t,n){let r=yl(),i=yl();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=ll();return n.forEach((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(Zo.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):No("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)}),{Wi:r,zi:i}})}(e,s,t.documentUpdates).next(e=>{a=e.Wi,c=e.zi})),!r.isEqual(Zo.min())){const t=n.Cs.getLastRemoteSnapshotVersion(e).next(t=>n.Cs.setTargetsMetadata(e,e.currentSequenceNumber,r));o.push(t)}return la.waitFor(o).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,a,c)).next(()=>a)}).then(e=>(n.Ui=i,e))}async function Tu(e,t,n){const r=Mo(e),i=r.Ui.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(o){if(!ua(o))throw o;No("LocalStore","Failed to update sequence numbers for target ".concat(t,": ").concat(o))}r.Ui=r.Ui.remove(t),r.qi.delete(i.target)}function ku(e,t,n){const r=Mo(e);let i=Zo.min(),s=yl();return r.persistence.runTransaction("Execute query","readonly",e=>function(e,t,n){const r=Mo(e),i=r.qi.get(n);return void 0!==i?la.resolve(r.Ui.get(i)):r.Cs.getTargetData(t,n)}(r,e,Ec(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Cs.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>r.Li.getDocumentsMatchingQuery(e,t,n?i:Zo.min(),n?s:yl())).next(e=>(function(e,t,n){let r=e.Ki.get(t)||Zo.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Ki.set(t,r)}(r,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,Hi:s})))}class xu{constructor(){this.activeTargetIds=bl()}er(e){this.activeTargetIds=this.activeTargetIds.add(e)}nr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}tr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Nu{constructor(){this.Lr=new xu,this.Ur={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Lr.er(e),this.Ur[e]||"not-current"}updateQueryState(e,t,n){this.Ur[e]=t}removeLocalQueryTarget(e){this.Lr.nr(e)}isLocalQueryTarget(e){return this.Lr.activeTargetIds.has(e)}clearQueryState(e){delete this.Ur[e]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(e){return this.Lr.activeTargetIds.has(e)}start(){return this.Lr=new xu,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Au{qr(e){}shutdown(){}}class Ru{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}qr(e){this.Wr.push(e)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){No("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Wr)e(0)}jr(){No("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Wr)e(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const Du={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Ou{constructor(e){this.Hr=e.Hr,this.Jr=e.Jr}Yr(e){this.Xr=e}Zr(e){this.eo=e}onMessage(e){this.no=e}close(){this.Jr()}send(e){this.Hr(e)}so(){this.Xr()}io(e){this.eo(e)}ro(e){this.no(e)}}class Pu extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.oo=t+"://"+e.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(e,t,n,r,i){const s=this.ho(e,t);No("RestConnection","Sending: ",s,n);const o={};return this.lo(o,r,i),this.fo(e,s,o,n).then(e=>(No("RestConnection","Received: ",e),e),t=>{throw Ro("RestConnection","".concat(e," failed with error: "),t,"url: ",s,"request:",n),t})}_o(e,t,n,r,i,s){return this.ao(e,t,n,r,i)}lo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+To,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}ho(e,t){const n=Du[e];return"".concat(this.oo,"/v1/").concat(t,":").concat(n)}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}fo(e,t,n,r){return new Promise((i,s)=>{const o=new So;o.setWithCredentials(!0),o.listenOnce(yo.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case go.NO_ERROR:const t=o.getResponseJson();No("Connection","XHR received:",JSON.stringify(t)),i(t);break;case go.TIMEOUT:No("Connection",'RPC "'+e+'" timed out'),s(new Lo(jo.DEADLINE_EXCEEDED,"Request time out"));break;case go.HTTP_ERROR:const n=o.getStatus();if(No("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){const e=o.getResponseJson().error;if(e&&e.status&&e.message){const t=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(jo).indexOf(t)>=0?t:jo.UNKNOWN}(e.status);s(new Lo(t,e.message))}else s(new Lo(jo.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new Lo(jo.UNAVAILABLE,"Connection failed."));break;default:Oo()}}finally{No("Connection",'RPC "'+e+'" completed.')}});const a=JSON.stringify(r);o.send(t,"POST",a,n,15)})}wo(e,t,n){const r=[this.oo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=new uo,s=ai(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new wo({})),this.lo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const a=r.join("");No("Connection","Creating WebChannel: "+a,o);const c=i.createWebChannel(a,o);let l=!1,u=!1;const h=new Ou({Hr:e=>{u?No("Connection","Not sending because WebChannel is closed:",e):(l||(No("Connection","Opening WebChannel transport."),c.open(),l=!0),No("Connection","WebChannel sending:",e),c.send(e))},Jr:()=>c.close()}),d=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(t){setTimeout(()=>{throw t},0)}})};return d(c,Eo.EventType.OPEN,()=>{u||No("Connection","WebChannel transport opened.")}),d(c,Eo.EventType.CLOSE,()=>{u||(u=!0,No("Connection","WebChannel transport closed"),h.io())}),d(c,Eo.EventType.ERROR,e=>{u||(u=!0,Ro("Connection","WebChannel transport errored:",e),h.io(new Lo(jo.UNAVAILABLE,"The operation could not be completed")))}),d(c,Eo.EventType.MESSAGE,e=>{var t;if(!u){const n=e.data[0];Po(!!n);const r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){No("Connection","WebChannel received error:",i);const e=i.status;let t=function(e){const t=il[e];if(void 0!==t)return ol(t)}(e),n=i.message;void 0===t&&(t=jo.INTERNAL,n="Unknown error status: "+e+" with message "+i.message),u=!0,h.io(new Lo(t,n)),c.close()}else No("Connection","WebChannel received:",n),h.ro(n)}}),d(s,vo.STAT_EVENT,e=>{e.stat===bo?No("Connection","Detected buffering proxy"):e.stat===_o&&No("Connection","Detected no buffering proxy")}),setTimeout(()=>{h.so()},0),h}}function Mu(){return"undefined"!=typeof document?document:null}function ju(e){return new Rl(e,!0)}class Lu{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Hs=e,this.timerId=t,this.mo=n,this.yo=r,this.po=i,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(e){this.cancel();const t=Math.floor(this.Io+this.bo()),n=Math.max(0,Date.now()-this.Eo),r=Math.max(0,t-n);r>0&&No("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.Io," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.To=this.Hs.enqueueAfterDelay(this.timerId,r,()=>(this.Eo=Date.now(),e())),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class Vu{constructor(e,t,n,r,i,s,o,a){this.Hs=e,this.vo=n,this.Vo=r,this.So=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Do=0,this.Co=null,this.xo=null,this.stream=null,this.No=new Lu(e,t)}ko(){return 1===this.state||5===this.state||this.Oo()}Oo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Mo()}async stop(){this.ko()&&await this.close(0)}Fo(){this.state=0,this.No.reset()}$o(){this.Oo()&&null===this.Co&&(this.Co=this.Hs.enqueueAfterDelay(this.vo,6e4,()=>this.Bo()))}Lo(e){this.Uo(),this.stream.send(e)}async Bo(){if(this.Oo())return this.close(0)}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}qo(){this.xo&&(this.xo.cancel(),this.xo=null)}async close(e,t){this.Uo(),this.qo(),this.No.cancel(),this.Do++,4!==e?this.No.reset():t&&t.code===jo.RESOURCE_EXHAUSTED?(Ao(t.toString()),Ao("Using maximum backoff delay to prevent overloading the backend."),this.No.Ao()):t&&t.code===jo.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Ko(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Zr(t)}Ko(){}auth(){this.state=1;const e=this.Go(this.Do),t=this.Do;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,r]=e;this.Do===t&&this.Qo(n,r)},t=>{e(()=>{const e=new Lo(jo.UNKNOWN,"Fetching auth token failed: "+t.message);return this.jo(e)})})}Qo(e,t){const n=this.Go(this.Do);this.stream=this.Wo(e,t),this.stream.Yr(()=>{n(()=>(this.state=2,this.xo=this.Hs.enqueueAfterDelay(this.Vo,1e4,()=>(this.Oo()&&(this.state=3),Promise.resolve())),this.listener.Yr()))}),this.stream.Zr(e=>{n(()=>this.jo(e))}),this.stream.onMessage(e=>{n(()=>this.onMessage(e))})}Mo(){this.state=5,this.No.Ro(async()=>{this.state=0,this.start()})}jo(e){return No("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}Go(e){return t=>{this.Hs.enqueueAndForget(()=>this.Do===e?t():(No("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Bu extends Vu{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.It=i}Wo(e,t){return this.So.wo("Listen",e,t)}onMessage(e){this.No.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const i="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:Oo(),s=t.targetChange.targetIds||[],o=function(e,t){return e.gt?(Po(void 0===t||"string"==typeof t),wa.fromBase64String(t||"")):(Po(void 0===t||t instanceof Uint8Array),wa.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,c=a&&function(e){const t=void 0===e.code?jo.UNKNOWN:ol(e.code);return new Lo(t,e.message||"")}(a);n=new Il(i,s,o,c||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=Ll(e,r.document.name),s=Pl(r.document.updateTime),o=new Qa({mapValue:{fields:r.document.fields}}),a=Ya.newFoundDocument(i,s,o),c=r.targetIds||[],l=r.removedTargetIds||[];n=new El(c,l,a.key,a)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=Ll(e,r.document),s=r.readTime?Pl(r.readTime):Zo.min(),o=Ya.newNoDocument(i,s),a=r.removedTargetIds||[];n=new El([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=Ll(e,r.document),s=r.removedTargetIds||[];n=new El([],s,i,null)}else{if(!("filter"in t))return Oo();{t.filter;const e=t.filter;e.targetId;const r=e.count||0,i=new rl(r),s=e.targetId;n=new Sl(s,i)}}var r;return n}(this.It,e),n=function(e){if(!("targetChange"in e))return Zo.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Zo.min():t.readTime?Pl(t.readTime):Zo.min()}(e);return this.listener.zo(t,n)}Ho(e){const t={};t.database=Bl(this.It),t.addTarget=function(e,t){let n;const r=t.target;return n=ec(r)?{documents:Ul(e,r)}:{query:zl(e,r)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=Ol(e,t.resumeToken):t.snapshotVersion.compareTo(Zo.min())>0&&(n.readTime=Dl(e,t.snapshotVersion.toTimestamp())),n}(this.It,e);const n=function(e,t){const n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Oo()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.It,e);n&&(t.labels=n),this.Lo(t)}Jo(e){const t={};t.database=Bl(this.It),t.removeTarget=e,this.Lo(t)}}class Fu extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.So=n,this.It=r,this.su=!1}iu(){if(this.su)throw new Lo(jo.FAILED_PRECONDITION,"The client has already been terminated.")}ao(e,t,n){return this.iu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(r=>{let[i,s]=r;return this.So.ao(e,t,n,i,s)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===jo.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Lo(jo.UNKNOWN,e.toString())})}_o(e,t,n,r){return this.iu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[s,o]=i;return this.So._o(e,t,n,s,o,r)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===jo.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Lo(jo.UNKNOWN,e.toString())})}terminate(){this.su=!0}}class Uu{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.ru=0,this.ou=null,this.uu=!0}cu(){0===this.ru&&(this.au("Unknown"),this.ou=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ou=null,this.hu("Backend didn't respond within 10 seconds."),this.au("Offline"),Promise.resolve())))}lu(e){"Online"===this.state?this.au("Unknown"):(this.ru++,this.ru>=1&&(this.fu(),this.hu("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.au("Offline")))}set(e){this.fu(),this.ru=0,"Online"===e&&(this.uu=!1),this.au(e)}au(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}hu(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.uu?(Ao(t),this.uu=!1):No("OnlineStateTracker",t)}fu(){null!==this.ou&&(this.ou.cancel(),this.ou=null)}}class zu{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.du=[],this._u=new Map,this.wu=new Set,this.mu=[],this.gu=i,this.gu.qr(e=>{n.enqueueAndForget(async()=>{Xu(this)&&(No("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=Mo(e);t.wu.add(4),await Gu(t),t.yu.set("Unknown"),t.wu.delete(4),await qu(t)}(this))})}),this.yu=new Uu(n,r)}}async function qu(e){if(Xu(e))for(const t of e.mu)await t(!0)}async function Gu(e){for(const t of e.mu)await t(!1)}function Hu(e,t){const n=Mo(e);n._u.has(t.targetId)||(n._u.set(t.targetId,t),Ju(n)?Yu(n):ih(n).Oo()&&Ku(n,t))}function Wu(e,t){const n=Mo(e),r=ih(n);n._u.delete(t),r.Oo()&&Qu(n,t),0===n._u.size&&(r.Oo()?r.$o():Xu(n)&&n.yu.set("Unknown"))}function Ku(e,t){e.pu.Mt(t.targetId),ih(e).Ho(t)}function Qu(e,t){e.pu.Mt(t),ih(e).Jo(t)}function Yu(e){e.pu=new Tl({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),se:t=>e._u.get(t)||null}),ih(e).start(),e.yu.cu()}function Ju(e){return Xu(e)&&!ih(e).ko()&&e._u.size>0}function Xu(e){return 0===Mo(e).wu.size}function Zu(e){e.pu=void 0}async function $u(e){e._u.forEach((t,n)=>{Ku(e,t)})}async function eh(e,t){Zu(e),Ju(e)?(e.yu.lu(t),Yu(e)):e.yu.set("Unknown")}async function th(e,t,n){if(e.yu.set("Online"),t instanceof Il&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e._u.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e._u.delete(r),e.pu.removeTarget(r))}(e,t)}catch(r){No("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),await nh(e,r)}else if(t instanceof El?e.pu.Gt(t):t instanceof Sl?e.pu.Yt(t):e.pu.Wt(t),!n.isEqual(Zo.min()))try{const t=await Iu(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.pu.te(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e._u.get(r);i&&e._u.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach(t=>{const n=e._u.get(t);if(!n)return;e._u.set(t,n.withResumeToken(wa.EMPTY_BYTE_STRING,n.snapshotVersion)),Qu(e,t);const r=new eu(n.target,t,1,n.sequenceNumber);Ku(e,r)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(i){No("RemoteStore","Failed to raise snapshot:",i),await nh(e,i)}}async function nh(e,t,n){if(!ua(t))throw t;e.wu.add(1),await Gu(e),e.yu.set("Offline"),n||(n=()=>Iu(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{No("RemoteStore","Retrying IndexedDB access"),await n(),e.wu.delete(1),await qu(e)})}async function rh(e,t){const n=Mo(e);n.asyncQueue.verifyOperationInProgress(),No("RemoteStore","RemoteStore received new credentials");const r=Xu(n);n.wu.add(3),await Gu(n),r&&n.yu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.wu.delete(3),await qu(n)}function ih(e){return e.Iu||(e.Iu=function(e,t,n){const r=Mo(e);return r.iu(),new Bu(t,r.So,r.authCredentials,r.appCheckCredentials,r.It,n)}(e.datastore,e.asyncQueue,{Yr:$u.bind(null,e),Zr:eh.bind(null,e),zo:th.bind(null,e)}),e.mu.push(async t=>{t?(e.Iu.Fo(),Ju(e)?Yu(e):e.yu.set("Unknown")):(await e.Iu.stop(),Zu(e))})),e.Iu}class sh{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Vo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new sh(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Lo(jo.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function oh(e,t){if(Ao("AsyncQueue","".concat(t,": ").concat(e)),ua(e))return new Lo(jo.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class ah{constructor(e){this.comparator=e?(t,n)=>e(t,n)||ra.comparator(t.key,n.key):(e,t)=>ra.comparator(e.key,t.key),this.keyedMap=hl(),this.sortedSet=new fa(this.comparator)}static emptySet(e){return new ah(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ah))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new ah;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class ch{constructor(){this.Eu=new fa(ra.comparator)}track(e){const t=e.doc.key,n=this.Eu.get(t);n?0!==e.type&&3===n.type?this.Eu=this.Eu.insert(t,e):3===e.type&&1!==n.type?this.Eu=this.Eu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Eu=this.Eu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Eu=this.Eu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Eu=this.Eu.remove(t):1===e.type&&2===n.type?this.Eu=this.Eu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Eu=this.Eu.insert(t,{type:2,doc:e.doc}):Oo():this.Eu=this.Eu.insert(t,e)}Au(){const e=[];return this.Eu.inorderTraversal((t,n)=>{e.push(n)}),e}}class lh{constructor(e,t,n,r,i,s,o,a,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new lh(e,t,ah.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ic(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class uh{constructor(){this.Ru=void 0,this.listeners=[]}}class hh{constructor(){this.queries=new al(e=>Cc(e),Ic),this.onlineState="Unknown",this.bu=new Set}}async function dh(e,t){const n=Mo(e),r=t.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new uh),i)try{s.Ru=await n.onListen(r)}catch(o){const e=oh(o,"Initialization of query '".concat(Tc(t.query),"' failed"));return void t.onError(e)}n.queries.set(r,s),s.listeners.push(t),t.Pu(n.onlineState),s.Ru&&t.vu(s.Ru)&&gh(n)}async function mh(e,t){const n=Mo(e),r=t.query;let i=!1;const s=n.queries.get(r);if(s){const e=s.listeners.indexOf(t);e>=0&&(s.listeners.splice(e,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function ph(e,t){const n=Mo(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.listeners)e.vu(i)&&(r=!0);t.Ru=i}}r&&gh(n)}function fh(e,t,n){const r=Mo(e),i=r.queries.get(t);if(i)for(const s of i.listeners)s.onError(n);r.queries.delete(t)}function gh(e){e.bu.forEach(e=>{e.next()})}class yh{constructor(e,t,n){this.query=e,this.Vu=t,this.Su=!1,this.Du=null,this.onlineState="Unknown",this.options=n||{}}vu(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new lh(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Su?this.Cu(e)&&(this.Vu.next(e),t=!0):this.xu(e,this.onlineState)&&(this.Nu(e),t=!0),this.Du=e,t}onError(e){this.Vu.error(e)}Pu(e){this.onlineState=e;let t=!1;return this.Du&&!this.Su&&this.xu(this.Du,e)&&(this.Nu(this.Du),t=!0),t}xu(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return(!this.options.ku||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Cu(e){if(e.docChanges.length>0)return!0;const t=this.Du&&this.Du.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}Nu(e){e=lh.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Su=!0,this.Vu.next(e)}}class vh{constructor(e){this.key=e}}class bh{constructor(e){this.key=e}}class _h{constructor(e,t){this.query=e,this.Uu=t,this.qu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=yl(),this.mutatedKeys=yl(),this.Gu=xc(e),this.Qu=new ah(this.Gu)}get ju(){return this.Uu}Wu(e,t){const n=t?t.zu:new ch,r=t?t.Qu:this.Qu;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,c="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const l=r.get(e),u=kc(this.query,t)?t:null,h=!!l&&this.mutatedKeys.has(l.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let m=!1;l&&u?l.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),m=!0):this.Hu(l,u)||(n.track({type:2,doc:u}),m=!0,(a&&this.Gu(u,a)>0||c&&this.Gu(u,c)<0)&&(o=!0)):!l&&u?(n.track({type:0,doc:u}),m=!0):l&&!u&&(n.track({type:1,doc:l}),m=!0,(a||c)&&(o=!0)),m&&(u?(s=s.add(u),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Qu:s,zu:n,$i:o,mutatedKeys:i}}Hu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const r=this.Qu;this.Qu=e.Qu,this.mutatedKeys=e.mutatedKeys;const i=e.zu.Au();i.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Oo()}};return n(e)-n(t)}(e.type,t.type)||this.Gu(e.doc,t.doc)),this.Ju(n);const s=t?this.Yu():[],o=0===this.Ku.size&&this.current?1:0,a=o!==this.qu;return this.qu=o,0!==i.length||a?{snapshot:new lh(this.query,e.Qu,r,i,e.mutatedKeys,0===o,a,!1,!!n&&n.resumeToken.approximateByteSize()>0),Xu:s}:{Xu:s}}Pu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new ch,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(e){return!this.Uu.has(e)&&!!this.Qu.has(e)&&!this.Qu.get(e).hasLocalMutations}Ju(e){e&&(e.addedDocuments.forEach(e=>this.Uu=this.Uu.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Uu=this.Uu.delete(e)),this.current=e.current)}Yu(){if(!this.current)return[];const e=this.Ku;this.Ku=yl(),this.Qu.forEach(e=>{this.Zu(e.key)&&(this.Ku=this.Ku.add(e.key))});const t=[];return e.forEach(e=>{this.Ku.has(e)||t.push(new bh(e))}),this.Ku.forEach(n=>{e.has(n)||t.push(new vh(n))}),t}tc(e){this.Uu=e.Hi,this.Ku=yl();const t=this.Wu(e.documents);return this.applyChanges(t,!0)}ec(){return lh.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.qu,this.hasCachedResults)}}class wh{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Eh{constructor(e){this.key=e,this.nc=!1}}class Sh{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.sc={},this.ic=new al(e=>Cc(e),Ic),this.rc=new Map,this.oc=new Set,this.uc=new fa(ra.comparator),this.cc=new Map,this.ac=new hu,this.hc={},this.lc=new Map,this.fc=su.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return!0===this.dc}}async function Ih(e,t){const n=function(e){const t=Mo(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Th.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=jh.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=xh.bind(null,t),t.sc.zo=ph.bind(null,t.eventManager),t.sc.wc=fh.bind(null,t.eventManager),t}(e);let r,i;const s=n.ic.get(t);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.ec();else{const e=await function(e,t){const n=Mo(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Cs.getTargetData(e,t).next(i=>i?(r=i,la.resolve(r)):n.Cs.allocateTargetId(e).next(i=>(r=new eu(t,i,0,e.currentSequenceNumber),n.Cs.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Ui.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ui=n.Ui.insert(e.targetId,e),n.qi.set(t,e.targetId)),e})}(n.localStore,Ec(t));n.isPrimaryClient&&Hu(n.remoteStore,e);const s=n.sharedClientState.addLocalQueryTarget(e.targetId);r=e.targetId,i=await async function(e,t,n,r,i){e._c=(t,n,r)=>async function(e,t,n,r){let i=t.view.Wu(n);i.$i&&(i=await ku(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.Wu(n,i)}));const s=r&&r.targetChanges.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s);return Rh(e,t.targetId,o.Xu),o.snapshot}(e,t,n,r);const s=await ku(e.localStore,t,!0),o=new _h(t,s.Hi),a=o.Wu(s.documents),c=wl.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),l=o.applyChanges(a,e.isPrimaryClient,c);Rh(e,n,l.Xu);const u=new wh(t,n,o);return e.ic.set(t,u),e.rc.has(n)?e.rc.get(n).push(t):e.rc.set(n,[t]),l.snapshot}(n,t,r,"current"===s,e.resumeToken)}return i}async function Ch(e,t){const n=Mo(e),r=n.ic.get(t),i=n.rc.get(r.targetId);if(i.length>1)return n.rc.set(r.targetId,i.filter(e=>!Ic(e,t))),void n.ic.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Tu(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),Wu(n.remoteStore,r.targetId),Nh(n,r.targetId)}).catch(ca)):(Nh(n,r.targetId),await Tu(n.localStore,r.targetId,!0))}async function Th(e,t){const n=Mo(e);try{const e=await Cu(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.cc.get(t);r&&(Po(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.nc=!0:e.modifiedDocuments.size>0?Po(r.nc):e.removedDocuments.size>0&&(Po(r.nc),r.nc=!1))}),await Ph(n,e,t)}catch(r){await ca(r)}}function kh(e,t,n){const r=Mo(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.ic.forEach((n,r)=>{const i=r.view.Pu(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=Mo(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const i of n.listeners)i.Pu(t)&&(r=!0)}),r&&gh(n)}(r.eventManager,t),e.length&&r.sc.zo(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function xh(e,t,n){const r=Mo(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.cc.get(t),s=i&&i.key;if(s){let e=new fa(ra.comparator);e=e.insert(s,Ya.newNoDocument(s,Zo.min()));const n=yl().add(s),i=new _l(Zo.min(),new Map,new va(Yo),e,n);await Th(r,i),r.uc=r.uc.remove(s),r.cc.delete(t),Oh(r)}else await Tu(r.localStore,t,!1).then(()=>Nh(r,t,n)).catch(ca)}function Nh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.rc.get(t))e.ic.delete(r),n&&e.sc.wc(r,n);e.rc.delete(t),e.isPrimaryClient&&e.ac.ls(t).forEach(t=>{e.ac.containsKey(t)||Ah(e,t)})}function Ah(e,t){e.oc.delete(t.path.canonicalString());const n=e.uc.get(t);null!==n&&(Wu(e.remoteStore,n),e.uc=e.uc.remove(t),e.cc.delete(n),Oh(e))}function Rh(e,t,n){for(const r of n)r instanceof vh?(e.ac.addReference(r.key,t),Dh(e,r)):r instanceof bh?(No("SyncEngine","Document no longer in limbo: "+r.key),e.ac.removeReference(r.key,t),e.ac.containsKey(r.key)||Ah(e,r.key)):Oo()}function Dh(e,t){const n=t.key,r=n.path.canonicalString();e.uc.get(n)||e.oc.has(r)||(No("SyncEngine","New document in limbo: "+n),e.oc.add(r),Oh(e))}function Oh(e){for(;e.oc.size>0&&e.uc.size<e.maxConcurrentLimboResolutions;){const t=e.oc.values().next().value;e.oc.delete(t);const n=new ra(ea.fromString(t)),r=e.fc.next();e.cc.set(r,new Eh(n)),e.uc=e.uc.insert(n,r),Hu(e.remoteStore,new eu(Ec(gc(n.path)),r,2,ha.at))}}async function Ph(e,t,n){const r=Mo(e),i=[],s=[],o=[];r.ic.isEmpty()||(r.ic.forEach((e,a)=>{o.push(r._c(a,t,n).then(e=>{if((e||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){i.push(e);const t=_u.Ci(a.targetId,e);s.push(t)}}))}),await Promise.all(o),r.sc.zo(i),await async function(e,t){const n=Mo(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>la.forEach(t,t=>la.forEach(t.Si,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>la.forEach(t.Di,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(r){if(!ua(r))throw r;No("LocalStore","Failed to update sequence numbers: "+r)}for(const i of t){const e=i.targetId;if(!i.fromCache){const t=n.Ui.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.Ui=n.Ui.insert(e,i)}}}(r.localStore,s))}async function Mh(e,t){const n=Mo(e);if(!n.currentUser.isEqual(t)){No("SyncEngine","User change. New user:",t.toKey());const e=await Su(n.localStore,t);n.currentUser=t,(r=n).lc.forEach(e=>{e.forEach(e=>{e.reject(new Lo(jo.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),r.lc.clear(),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Ph(n,e.ji)}var r}function jh(e,t){const n=Mo(e),r=n.cc.get(t);if(r&&r.nc)return yl().add(r.key);{let e=yl();const r=n.rc.get(t);if(!r)return e;for(const t of r){const r=n.ic.get(t);e=e.unionWith(r.view.ju)}return e}}class Lh{constructor(){this.synchronizeTabs=!1}async initialize(e){this.It=ju(e.databaseInfo.databaseId),this.sharedClientState=this.gc(e),this.persistence=this.yc(e),await this.persistence.start(),this.localStore=this.Ic(e),this.gcScheduler=this.Tc(e,this.localStore),this.indexBackfillerScheduler=this.Ec(e,this.localStore)}Tc(e,t){return null}Ec(e,t){return null}Ic(e){return function(e,t,n,r){return new Eu(e,t,n,r)}(this.persistence,new wu,e.initialUser,this.It)}yc(e){return new yu(bu.Bs,this.It)}gc(e){return new Nu}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Vh{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>kh(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Mh.bind(null,this.syncEngine),await async function(e,t){const n=Mo(e);t?(n.wu.delete(2),await qu(n)):t||(n.wu.add(2),await Gu(n),n.yu.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new hh}createDatastore(e){const t=ju(e.databaseInfo.databaseId),n=(r=e.databaseInfo,new Pu(r));var r,i,s;return i=e.authCredentials,s=e.appCheckCredentials,new Fu(i,s,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=e=>kh(this.syncEngine,e,0),s=Ru.C()?new Ru:new Au,new zu(t,n,r,i,s);var t,n,r,i,s}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new Sh(e,t,n,r,i,s);return o&&(a.dc=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=Mo(e);No("RemoteStore","RemoteStore shutting down."),t.wu.add(5),await Gu(t),t.gu.shutdown(),t.yu.set("Unknown")}(this.remoteStore)}}function Bh(e,t,n){if(!n)throw new Lo(jo.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function Fh(e){if(!ra.isDocumentKey(e))throw new Lo(jo.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function Uh(e){if(ra.isDocumentKey(e))throw new Lo(jo.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function zh(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const n=(t=e).constructor?t.constructor.name:null;return n?"a custom ".concat(n," object"):"an object"}}var t;return"function"==typeof e?"a function":Oo()}function qh(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Lo(jo.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=zh(e);throw new Lo(jo.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}const Gh=new Map;class Hh{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new Lo(jo.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Lo(jo.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,function(e,t,n,r){if(!0===t&&!0===r)throw new Lo(jo.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))}("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Wh{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Hh({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Lo(jo.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Lo(jo.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Hh(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Fo;switch(e.type){case"gapi":const t=e.client;return new Go(t,e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Lo(jo.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Gh.get(e);t&&(No("ComponentProvider","Removing Datastore"),Gh.delete(e),t.terminate())}(this),Promise.resolve()}}class Kh{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Yh(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Kh(this.firestore,e,this._key)}}class Qh{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Qh(this.firestore,e,this._query)}}class Yh extends Qh{constructor(e,t,n){super(e,t,gc(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Kh(this.firestore,null,new ra(e))}withConverter(e){return new Yh(this.firestore,e,this._path)}}function Jh(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=Je(e),1===arguments.length&&(t=Qo.R()),Bh("doc","path",t),e instanceof Wh){const n=ea.fromString(t,...r);return Fh(n),new Kh(e,null,new ra(n))}{if(!(e instanceof Kh||e instanceof Yh))throw new Lo(jo.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(ea.fromString(t,...r));return Fh(n),new Kh(e.firestore,e instanceof Yh?e.converter:null,new ra(n))}}class Xh{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Rc(this.observer.next,e)}error(e){this.observer.error?this.Rc(this.observer.error,e):Ao("Uncaught Error in snapshot listener:",e)}bc(){this.muted=!0}Rc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class Zh{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Co.UNAUTHENTICATED,this.clientId=Qo.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,async e=>{No("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(No("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Lo(jo.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Vo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=oh(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function $h(e,t){e.asyncQueue.verifyOperationInProgress();const n=await async function(e){return e.offlineComponents||(No("FirestoreClient","Using default OfflineComponentProvider"),await async function(e,t){e.asyncQueue.verifyOperationInProgress(),No("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await Su(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e.offlineComponents=t}(e,new Lh)),e.offlineComponents}(e);No("FirestoreClient","Initializing OnlineComponentProvider");const r=await e.getConfiguration();await t.initialize(n,r),e.setCredentialChangeListener(e=>rh(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>rh(t.remoteStore,n)),e.onlineComponents=t}async function ed(e){const t=await async function(e){return e.onlineComponents||(No("FirestoreClient","Using default OnlineComponentProvider"),await $h(e,new Vh)),e.onlineComponents}(e),n=t.eventManager;return n.onListen=Ih.bind(null,t.syncEngine),n.onUnlisten=Ch.bind(null,t.syncEngine),n}class td{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.Uc=!1,this.qc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.No=new Lu(this,"async_queue_retry"),this.Wc=()=>{const e=Mu();e&&No("AsyncQueue","Visibility state changed to "+e.visibilityState),this.No.Po()};const e=Mu();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.Uc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.zc(),this.Hc(e)}enterRestrictedMode(e){if(!this.Uc){this.Uc=!0,this.Qc=e||!1;const t=Mu();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Wc)}}enqueue(e){if(this.zc(),this.Uc)return new Promise(()=>{});const t=new Vo;return this.Hc(()=>this.Uc&&this.Qc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Lc.push(e),this.Jc()))}async Jc(){if(0!==this.Lc.length){try{await this.Lc[0](),this.Lc.shift(),this.No.reset()}catch(e){if(!ua(e))throw e;No("AsyncQueue","Operation failed with retryable error: "+e)}this.Lc.length>0&&this.No.Ro(()=>this.Jc())}}Hc(e){const t=this.Bc.then(()=>(this.Gc=!0,e().catch(e=>{this.Kc=e,this.Gc=!1;throw Ao("INTERNAL UNHANDLED ERROR: ",function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e)),e}).then(e=>(this.Gc=!1,e))));return this.Bc=t,t}enqueueAfterDelay(e,t,n){this.zc(),this.jc.indexOf(e)>-1&&(t=0);const r=sh.createAndSchedule(this,e,t,n,e=>this.Yc(e));return this.qc.push(r),r}zc(){this.Kc&&Oo()}verifyOperationInProgress(){}async Xc(){let e;do{e=this.Bc,await e}while(e!==this.Bc)}Zc(e){for(const t of this.qc)if(t.timerId===e)return!0;return!1}ta(e){return this.Xc().then(()=>{this.qc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.qc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Xc()})}ea(e){this.jc.push(e)}Yc(e){const t=this.qc.indexOf(e);this.qc.splice(t,1)}}class nd extends Wh{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new td,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||sd(this),this._firestoreClient.terminate()}}function rd(e,t){const n="string"==typeof e?e:t||"(default)",r=sn("object"==typeof e?e:un(),"firestore").getImmediate({identifier:n});if(!r._initialized){const e=ze("firestore");e&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;const s=(e=qh(e,Wh))._getSettings();if("firestore.googleapis.com"!==s.host&&s.host!==t&&Ro("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},s),{host:"".concat(t,":").concat(n),ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=Co.MOCK_USER;else{t=Ge(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new Lo(jo.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Co(s)}e._authCredentials=new Uo(new Bo(t,n))}}(r,...e)}return r}function id(e){return e._firestoreClient||sd(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function sd(e){var t;const n=e._freezeSettings(),r=(i=e._databaseId,s=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",o=e._persistenceKey,new Na(i,s,o,(a=n).host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams));var i,s,o,a;e._firestoreClient=new Zh(e._authCredentials,e._appCheckCredentials,e._queue,r)}class od{constructor(e){this._byteString=e}static fromBase64String(e){try{return new od(wa.fromBase64String(e))}catch(t){throw new Lo(jo.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new od(wa.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class ad{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new Lo(jo.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new na(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class cd{constructor(e){this._methodName=e}}class ld{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Lo(jo.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Lo(jo.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Yo(this._lat,e._lat)||Yo(this._long,e._long)}}const ud=/^__.*__$/;function hd(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Oo()}}class dd{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.It=n,this.ignoreUndefinedProperties=r,void 0===i&&this.na(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(e){return new dd(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.It,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ia({path:n,oa:!1});return r.ua(e),r}ca(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ia({path:n,oa:!1});return r.na(),r}aa(e){return this.ia({path:void 0,oa:!0})}ha(e){return bd(e,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}na(){if(this.path)for(let e=0;e<this.path.length;e++)this.ua(this.path.get(e))}ua(e){if(0===e.length)throw this.ha("Document fields must not be empty");if(hd(this.sa)&&ud.test(e))throw this.ha('Document fields cannot begin and end with "__"')}}class md{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.It=n||ju(e)}da(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new dd({sa:e,methodName:t,fa:n,path:na.emptyPath(),oa:!1,la:r},this.databaseId,this.It,this.ignoreUndefinedProperties)}}function pd(e){const t=e._freezeSettings(),n=ju(e._databaseId);return new md(e._databaseId,!!t.ignoreUndefinedProperties,n)}function fd(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return gd(n,e.da(r?4:3,t))}function gd(e,t){if(yd(e=Je(e)))return function(e,t,n){if(!yd(n)||(r=n,"object"!=typeof r||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))){const r=zh(n);throw"an object"===r?t.ha(e+" a custom object"):t.ha(e+" "+r)}var r}("Unsupported field value:",t,e),function(e,t){const n={};return pa(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):ma(e,(e,r)=>{const i=gd(r,t.ra(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}(e,t);if(e instanceof cd)return function(e,t){if(!hd(t.sa))throw t.ha("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.ha("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.oa&&4!==t.sa)throw t.ha("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=gd(i,t.aa(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Je(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Dc(t.It,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Xo.fromDate(e);return{timestampValue:Dl(t.It,n)}}if(e instanceof Xo){const n=new Xo(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Dl(t.It,n)}}if(e instanceof ld)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof od)return{bytesValue:Ol(t.It,e._byteString)};if(e instanceof Kh){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.ha("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:Ml(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.ha("Unsupported field value: ".concat(zh(e)))}(e,t)}function yd(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Xo||e instanceof ld||e instanceof od||e instanceof Kh||e instanceof cd)}const vd=new RegExp("[~\\*/\\[\\]]");function bd(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a="Function ".concat(t,"() called with invalid data");n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=" in field ".concat(r)),o&&(c+=" in document ".concat(i)),c+=")"),new Lo(jo.INVALID_ARGUMENT,a+e+c)}class _d{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Kh(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new wd(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Ed("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class wd extends _d{data(){return super.data()}}function Ed(e,t){return"string"==typeof t?function(e,t,n){if(t.search(vd)>=0)throw bd("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new ad(...t.split("."))._internalPath}catch(r){throw bd("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}(e,t):t instanceof ad?t._internalPath:t._delegate._internalPath}class Sd{}class Id extends Sd{constructor(e,t,n){super(),this.ma=e,this.ga=t,this.ya=n,this.type="where"}_apply(e){const t=pd(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new Lo(jo.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(s,"' queries on documentId()."));if("in"===s||"not-in"===s){Od(o,s);const t=[];for(const n of o)t.push(Dd(r,e,n));a={arrayValue:{values:t}}}else a=Dd(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Od(o,s),a=fd(n,"where",o,"in"===s||"not-in"===s);const c=tc.create(i,s,a);return function(e,t){if(t.dt()){const n=bc(e);if(null!==n&&!n.isEqual(t.field))throw new Lo(jo.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '".concat(n.toString(),"' and '").concat(t.field.toString(),"'"));const r=vc(e);null!==r&&Pd(e,t.field,r)}const n=function(e,t){for(const n of e.filters)if(t.indexOf(n.op)>=0)return n.op;return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Lo(jo.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new Lo(jo.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}(e,c),c}(e._query,0,t,e.firestore._databaseId,this.ma,this.ga,this.ya);return new Qh(e.firestore,e.converter,function(e,t){const n=e.filters.concat([t]);return new fc(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}(e._query,n))}}function Cd(e,t,n){const r=t,i=Ed("where",e);return new Id(i,r,n)}class Td extends Sd{constructor(e,t){super(),this.ma=e,this.pa=t,this.type="orderBy"}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new Lo(jo.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Lo(jo.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const r=new hc(t,n);return function(e,t){if(null===vc(e)){const n=bc(e);null!==n&&Pd(e,n,t.field)}}(e,r),r}(e._query,this.ma,this.pa);return new Qh(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new fc(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function kd(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=Ed("orderBy",e);return new Td(n,t)}class xd extends Sd{constructor(e,t,n){super(),this.type=e,this.Ia=t,this.Ta=n}_apply(e){return new Qh(e.firestore,e.converter,Sc(e._query,this.Ia,this.Ta))}}function Nd(e){return function(e,t){if(t<=0)throw new Lo(jo.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}("limit",e),new xd("limit",e,"F")}class Ad extends Sd{constructor(e,t,n){super(),this.type=e,this.Ea=t,this.Aa=n}_apply(e){const t=function(e,t,n,r){if(n[0]=Je(n[0]),n[0]instanceof _d)return function(e,t,n,r,i){if(!r)throw new Lo(jo.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for ".concat(n,"()."));const s=[];for(const o of wc(e))if(o.field.isKeyField())s.push(Ua(t,r.key));else{const e=r.data.field(o.field);if(Ta(e))throw new Lo(jo.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=o.field.canonicalString();throw new Lo(jo.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(e,"' (used as the orderBy) does not exist."))}s.push(e)}return new uc(s,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const i=pd(e.firestore);return function(e,t,n,r,i,s){const o=e.explicitOrderBy;if(i.length>o.length)throw new Lo(jo.INVALID_ARGUMENT,"Too many arguments provided to ".concat(r,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));const a=[];for(let c=0;c<i.length;c++){const s=i[c];if(o[c].field.isKeyField()){if("string"!=typeof s)throw new Lo(jo.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in ".concat(r,"(), but got a ").concat(typeof s));if(!_c(e)&&-1!==s.indexOf("/"))throw new Lo(jo.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by documentId(), the value passed to ".concat(r,"() must be a plain document ID, but '").concat(s,"' contains a slash."));const n=e.path.child(ea.fromString(s));if(!ra.isDocumentKey(n))throw new Lo(jo.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by documentId(), the value passed to ".concat(r,"() must result in a valid document path, but '").concat(n,"' is not because it contains an odd number of segments."));const i=new ra(n);a.push(Ua(t,i))}else{const e=fd(n,r,s);a.push(e)}}return new uc(a,s)}(e._query,e.firestore._databaseId,i,t,n,r)}}(e,this.type,this.Ea,this.Aa);return new Qh(e.firestore,e.converter,(n=e._query,r=t,new fc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),n.limit,n.limitType,r,n.endAt)));var n,r}}function Rd(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Ad("startAfter",t,!1)}function Dd(e,t,n){if("string"==typeof(n=Je(n))){if(""===n)throw new Lo(jo.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!_c(t)&&-1!==n.indexOf("/"))throw new Lo(jo.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const r=t.path.child(ea.fromString(n));if(!ra.isDocumentKey(r))throw new Lo(jo.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return Ua(e,new ra(r))}if(n instanceof Kh)return Ua(e,n._key);throw new Lo(jo.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(zh(n),"."))}function Od(e,t){if(!Array.isArray(e)||0===e.length)throw new Lo(jo.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."));if(e.length>10)throw new Lo(jo.INVALID_ARGUMENT,"Invalid Query. '".concat(t.toString(),"' filters support a maximum of 10 elements in the value array."))}function Pd(e,t,n){if(!n.isEqual(t))throw new Lo(jo.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}class Md{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Pa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ia(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ca(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Oo()}}convertObject(e,t){const n={};return ma(e.fields,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertGeoPoint(e){return new ld(Ia(e.latitude),Ia(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=ka(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(xa(e));default:return null}}convertTimestamp(e){const t=Sa(e);return new Xo(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=ea.fromString(e);Po(Xl(n));const r=new Aa(n.get(1),n.get(3)),i=new ra(n.popFirst(5));return r.isEqual(t)||Ao("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}class jd{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ld extends _d{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new Vd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(Ed("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Vd extends Ld{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Bd{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new jd(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Vd(this._firestore,this._userDataWriter,n.key,n,new jd(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Lo(jo.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>({type:"added",doc:new Vd(e._firestore,e._userDataWriter,n.doc.key,n.doc,new jd(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:t++}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new Vd(e._firestore,e._userDataWriter,t.doc.key,t.doc,new jd(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:Fd(t.type),doc:r,oldIndex:i,newIndex:s}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Fd(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Oo()}}function Ud(e){e=qh(e,Kh);const t=qh(e.firestore,nd);return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Vo;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new Xh({next:s=>{t.enqueueAndForget(()=>mh(e,o));const a=s.docs.has(n);!a&&s.fromCache?i.reject(new Lo(jo.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&r&&"server"===r.source?i.reject(new Lo(jo.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:e=>i.reject(e)}),o=new yh(gc(n.path),s,{includeMetadataChanges:!0,ku:!0});return dh(e,o)}(await ed(e),e.asyncQueue,t,n,r)),r.promise}(id(t),e._key).then(n=>function(e,t,n){const r=n.docs.get(t._key),i=new zd(e);return new Ld(e,i,t._key,r,new jd(n.hasPendingWrites,n.fromCache),t.converter)}(t,e,n))}class zd extends Md{constructor(e){super(),this.firestore=e}convertBytes(e){return new od(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Kh(this.firestore,null,t)}}function qd(e){e=qh(e,Qh);const t=qh(e.firestore,nd),n=id(t),r=new zd(t);return function(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Lo(jo.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(e._query),function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Vo;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new Xh({next:n=>{t.enqueueAndForget(()=>mh(e,o)),n.fromCache&&"server"===r.source?i.reject(new Lo(jo.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new yh(n,s,{includeMetadataChanges:!0,ku:!0});return dh(e,o)}(await ed(e),e.asyncQueue,t,n,r)),r.promise}(n,e._query).then(n=>new Bd(t,r,e,n))}!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];To=cn,rn(new Xe("firestore",(e,n)=>{let{instanceIdentifier:r,options:i}=n;const s=e.getProvider("app").getImmediate(),o=new nd(new zo(e.getProvider("auth-internal")),new Wo(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Lo(jo.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Aa(e.options.projectId,t)}(s,r),s);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),hn(Io,"3.7.1",e),hn(Io,"3.7.1","esm2017")}();hn("firebase","9.12.1","app");class Gd{constructor(e,t){this.data=e,this.error=t}}class Hd{constructor(e,t){this.data=e,this.error=t}}class Wd extends Error{constructor(e){super("No documents found from querying ".concat(e)),this.name="NoDocumentsError",Object.setPrototypeOf(this,new.target.prototype)}}const Kd="firebasestorage.googleapis.com",Qd="storageBucket";class Yd extends He{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(Jd(e),"Firebase Storage: ".concat(t," (").concat(Jd(e),")")),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Yd.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Jd(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message="".concat(this._baseMessage,"\n").concat(this.customData.serverResponse):this.message=this._baseMessage}}function Jd(e){return"storage/"+e}function Xd(){return new Yd("unknown","An unknown error occurred, please check the error payload for server response.")}function Zd(e){return new Yd("invalid-argument",e)}function $d(){return new Yd("app-deleted","The Firebase app was deleted.")}function em(e){throw new Yd("internal-error","Internal error: "+e)}class tm{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=tm.makeFromUrl(e,t)}catch(r){return new tm(e,"")}if(""===n.path)return n;throw new Yd("invalid-default-bucket","Invalid default bucket '"+e+"'.")}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";const i=new RegExp("^gs://"+r+"(/(.*))?$","i");function s(e){e.path_=decodeURIComponent(e.path)}const o=t.replace(/[.]/g,"\\."),a=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://".concat(o,"/").concat("v[A-Za-z0-9_]+","/b/").concat(r,"/o").concat("(/([^?#]*).*)?$"),"i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp("^https?://".concat(t===Kd?"(?:storage.googleapis.com|storage.cloud.google.com)":t,"/").concat(r,"/").concat("([^?#]*)"),"i"),indices:{bucket:1,path:2},postModify:s}];for(let c=0;c<a.length;c++){const t=a[c],r=t.regex.exec(e);if(r){const e=r[t.indices.bucket];let i=r[t.indices.path];i||(i=""),n=new tm(e,i),t.postModify(n);break}}if(null==n)throw function(e){return new Yd("invalid-url","Invalid URL '"+e+"'.")}(e);return n}}class nm{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(){}}function rm(e){return"string"===typeof e||e instanceof String}function im(e,t,n,r){if(r<t)throw Zd("Invalid value for '".concat(e,"'. Expected ").concat(t," or greater."));if(r>n)throw Zd("Invalid value for '".concat(e,"'. Expected ").concat(n," or less."))}function sm(e,t,n){let r=t;return null==n&&(r="https://".concat(t)),"".concat(n,"://").concat(r,"/v0").concat(e)}function om(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1),n}var am,cm;(cm=am||(am={}))[cm.NO_ERROR=0]="NO_ERROR",cm[cm.NETWORK_ERROR=1]="NETWORK_ERROR",cm[cm.ABORT=2]="ABORT";class lm{constructor(e,t,n,r,i,s,o,a,c,l,u){let h=!(arguments.length>11&&void 0!==arguments[11])||arguments[11];this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=s,this.callback_=o,this.errorCallback_=a,this.timeout_=c,this.progressCallback_=l,this.connectionFactory_=u,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){const e=(e,t)=>{if(t)return void e(!1,new um(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const r=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;const t=n.getErrorCode()===am.NO_ERROR,i=n.getStatus();if((!t||function(e,t){const n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),i=-1!==t.indexOf(e);return n||r||i}(i,this.additionalRetryCodes_))&&this.retry){const t=n.getErrorCode()===am.ABORT;return void e(!1,new um(!1,null,t))}const s=-1!==this.successCodes_.indexOf(i);e(!0,new um(s,n))})},t=(e,t)=>{const n=this.resolve_,r=this.reject_,i=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(i,i.getResponse());void 0!==e?n(e):n()}catch(s){r(s)}else if(null!==i){const e=Xd();e.serverResponse=i.getErrorText(),this.errorCallback_?r(this.errorCallback_(i,e)):r(e)}else if(t.canceled){r(this.appDelete_?$d():new Yd("canceled","User canceled the upload/download."))}else{r(new Yd("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))}};this.canceled_?t(0,new um(!1,null,!0)):this.backoffId_=function(e,t,n){let r=1,i=null,s=null,o=!1,a=0;function c(){return 2===a}let l=!1;function u(){if(!l){l=!0;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(null,n)}}function h(t){i=setTimeout(()=>{i=null,e(m,c())},t)}function d(){s&&clearTimeout(s)}function m(e){if(l)return void d();for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(e)return d(),void u.call(null,e,...n);if(c()||o)return d(),void u.call(null,e,...n);let s;r<64&&(r*=2),1===a?(a=2,s=0):s=1e3*(r+Math.random()),h(s)}let p=!1;function f(e){p||(p=!0,d(),l||(null!==i?(e||(a=2),clearTimeout(i),h(0)):e||(a=1)))}return h(0),s=setTimeout(()=>{o=!0,f(!0)},n),f}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class um{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function hm(e){let t;try{t=JSON.parse(e)}catch(r){return null}return"object"!==typeof(n=t)||Array.isArray(n)?null:t;var n}function dm(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function mm(e,t){return t}class pm{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||mm}}let fm=null;function gm(){if(fm)return fm;const e=[];e.push(new pm("bucket")),e.push(new pm("generation")),e.push(new pm("metageneration")),e.push(new pm("name","fullPath",!0));const t=new pm("name");t.xform=function(e,t){return function(e){return!rm(e)||e.length<2?e:dm(e)}(t)},e.push(t);const n=new pm("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new pm("timeCreated")),e.push(new pm("updated")),e.push(new pm("md5Hash",null,!0)),e.push(new pm("cacheControl",null,!0)),e.push(new pm("contentDisposition",null,!0)),e.push(new pm("contentEncoding",null,!0)),e.push(new pm("contentLanguage",null,!0)),e.push(new pm("contentType",null,!0)),e.push(new pm("metadata","customMetadata",!0)),fm=e,fm}function ym(e,t,n){const r={type:"file"},i=n.length;for(let s=0;s<i;s++){const e=n[s];r[e.local]=e.xform(r,t[e.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,r=e.fullPath,i=new tm(n,r);return t._makeStorageReference(i)}})}(r,e),r}class vm{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function bm(e,t){return function(n,r){const i=function(e,t,n){const r=hm(t);return null===r?null:ym(e,r,n)}(e,r,t);return function(e){if(!e)throw Xd()}(null!==i),function(e,t,n,r){const i=hm(t);if(null===i)return null;if(!rm(i.downloadTokens))return null;const s=i.downloadTokens;if(0===s.length)return null;const o=encodeURIComponent;return s.split(",").map(t=>{const i=e.bucket,s=e.fullPath;return sm("/b/"+o(i)+"/o/"+o(s),n,r)+om({alt:"media",token:t})})[0]}(i,r,e.host,e._protocol)}}function _m(e){return function(t,n){let r;var i,s;return 401===t.getStatus()?r=t.getErrorText().includes("Firebase App Check token is invalid")?new Yd("unauthorized-app","This app does not have permission to access Firebase Storage on this project."):new Yd("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(s=e.bucket,r=new Yd("quota-exceeded","Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(i=e.path,r=new Yd("unauthorized","User does not have permission to access '"+i+"'.")):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}}function wm(e){const t=_m(e);return function(n,r){let i=t(n,r);var s;return 404===n.getStatus()&&(s=e.path,i=new Yd("object-not-found","Object '"+s+"' does not exist.")),i.serverResponse=r.serverResponse,i}}class Em{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=am.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=am.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=am.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,n,r){if(this.sent_)throw em("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(const i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw em("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw em("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw em("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw em("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class Sm extends Em{initXhr(){this.xhr_.responseType="text"}}function Im(){return new Sm}class Cm{constructor(e,t){this._service=e,this._location=t instanceof tm?t:tm.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Cm(e,t)}get root(){const e=new tm(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return dm(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new tm(this._location.bucket,e);return new Cm(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new Yd("invalid-root-operation","The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function Tm(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,n){const r=sm(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,s=new vm(r,"GET",bm(e,n),i);return s.errorHandler=wm(t),s}(e.storage,e._location,gm());return e.storage.makeRequestWithTokens(t,Im).then(e=>{if(null===e)throw new Yd("no-download-url","The given file does not have any download URLs.");return e})}function km(e,t){if(e instanceof Am){const n=e;if(null==n._bucket)throw new Yd("no-default-bucket","No default bucket found. Did you set the '"+Qd+"' property when initializing the app?");const r=new Cm(n,n._bucket);return null!=t?km(r,t):r}return void 0!==t?function(e,t){const n=function(e,t){const n=t.split("/").filter(e=>e.length>0).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new tm(e._location.bucket,n);return new Cm(e.storage,r)}(e,t):e}function xm(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof Am)return new Cm(e,t);throw Zd("To use ref(service, url), the first argument must be a Storage instance.")}return km(e,t)}function Nm(e,t){const n=null===t||void 0===t?void 0:t[Qd];return null==n?null:tm.makeFromBucketSpec(n,e)}class Am{constructor(e,t,n,r,i){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=i,this._bucket=null,this._host=Kd,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?tm.makeFromBucketSpec(r,this._host):Nm(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=tm.makeFromBucketSpec(this._url,e):this._bucket=Nm(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){im("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){im("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Cm(this,e)}_makeRequest(e,t,n,r){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this._deleted)return new nm($d());{const s=function(e,t,n,r,i,s){let o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];const a=om(e.urlParams),c=e.url+a,l=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(l,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(l,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!==t&&void 0!==t?t:"AppManager")}(l,s),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(l,r),new lm(c,e.method,l,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,o)}(e,this._appId,n,r,t,this._firebaseVersion,i);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const Rm="@firebase/storage",Dm="0.9.12",Om="storage";function Pm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:un(),t=arguments.length>1?arguments[1]:void 0;e=Je(e);const n=sn(e,Om).getImmediate({identifier:t}),r=ze("storage");return r&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.host="".concat(t,":").concat(n),e._protocol="http";const{mockUserToken:i}=r;i&&(e._overrideAuthToken="string"===typeof i?i:Ge(i,e.app.options.projectId))}(e,t,n,r)}(n,...r),n}function Mm(e,t){let{instanceIdentifier:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return new Am(r,i,s,n,cn)}rn(new Xe(Om,Mm,"PUBLIC").setMultipleInstances(!0)),hn(Rm,Dm,""),hn(Rm,Dm,"esm2017");var jm=(e=>(e.Body="body",e.Event="event",e.EventMinutesItem="event_minutes_item",e.EventMinutesItemFile="event_minutes_item_file",e.File="file",e.IndexedEventGram="indexed_event_gram",e.Matter="matter",e.MatterFile="matter_file",e.MatterSponsor="matter_sponsor",e.MatterStatus="matter_status",e.MinutesItem="minutes_item",e.Person="person",e.Role="role",e.Seat="seat",e.Session="session",e.Transcript="transcript",e.TranscriptJSON="transcript_json",e.Vote="vote",e))(jm||{}),Lm=(e=>(e.EventBodyRef="body_ref",e.EventHoverThumbnailRef="hover_thumbnail_ref",e.EventStaticThumbnailRef="static_thumbnail_ref",e.EventMinutesItemEventRef="event_ref",e.EventMinutesItemMinutesItemRef="minutes_item_ref",e.EventMinutesItemFileEventMinutesItemRef="event_minutes_item_ref",e.IndexedEventGramEventRef="event_ref",e.MatterFileMatterRef="matter_ref",e.MatterStatusEventMinutesItemRef="event_minutes_item_ref",e.MatterStatusMatterRef="matter_ref",e.MatterSponsorMatterRef="matter_ref",e.MatterSponsorPersonRef="person_ref",e.MinutesItemMatterRef="matter_ref",e.PersonPictureRef="picture_ref",e.RoleBodyRef="body_ref",e.RolePersonRef="person_ref",e.RoleSeatRef="seat_ref",e.SeatImageRef="image_ref",e.SessionEventRef="event_ref",e.TranscriptFileRef="file_ref",e.TranscriptSessionRef="session_ref",e.VoteEventMinutesItemRef="event_minutes_item_ref",e.VoteEventRef="event_ref",e.VoteMatterRef="matter_ref",e.VotePersonRef="person_ref",e))(Lm||{});function Vm(e){switch(e){case"body_ref":case"body_ref":return"body";case"hover_thumbnail_ref":case"static_thumbnail_ref":case"picture_ref":case"image_ref":case"file_ref":return"file";case"event_ref":case"event_ref":case"event_ref":case"event_ref":return"event";case"minutes_item_ref":return"minutes_item";case"event_minutes_item_ref":case"event_minutes_item_ref":case"event_minutes_item_ref":return"event_minutes_item";case"matter_ref":case"matter_ref":case"matter_ref":case"matter_ref":case"matter_ref":return"matter";case"person_ref":case"person_ref":case"person_ref":return"person";case"seat_ref":return"seat";case"session_ref":return"session";default:return}}class Bm{constructor(e,t,n){this.collectionName=e,this.refName=t,this.cascade=n}}class Fm{constructor(e){this.toPopulate=e}}function Um(e){return e instanceof Error?e:"string"===typeof e?new Error(e):new Error(String(e))}class zm{constructor(e,t){!function(e,t,n){n||(n="(default)");const r=sn(e,"firestore");if(r.isInitialized(n)){const e=r.getImmediate({identifier:n});if(Qe(r.getOptions(n),t))return e;throw new Lo(jo.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(void 0!==t.cacheSizeBytes&&-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Lo(jo.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");r.initialize({options:t,instanceIdentifier:n})}(ln(e),t),zm.db=rd()}static getInstance(e,t){return zm.instance||(zm.instance=new zm(e,t)),zm.instance}static getDb(){return zm.db}collateDocumentData(e,t,n){return Promise.all(e).then(e=>(e.forEach((e,r)=>{n.data&&(n.data[t[r]]=e.data)}),Promise.resolve(n))).catch(e=>(n.error=e,Promise.resolve(n)))}async getDocument(e,t,n){const r=Jh(zm.db,t,e),i=new Gd;return Ud(r).then(r=>{if(!r.exists())return Promise.reject(new Error("Document ".concat(e," does not exist in Collection ").concat(t,".")));const s=r.data();if(!s)return Promise.reject(new Error("No data on docSnap."));if(s.id=r.id,i.data=s,n&&n.toPopulate){const e=[],t=[];return n.toPopulate.filter(e=>s[e.refName]).forEach(n=>{const r=s[n.refName].id,i=Vm(n.refName);r&&i&&(e.push(this.getDocument(r,i,n.cascade)),t.push(n.refName))}),this.collateDocumentData(e,t,i)}return Promise.resolve(i)}).catch(e=>(e.message="_getDocument_".concat(e.message),i.error=e,Promise.resolve(i)))}async getDocuments(e,t,n){const r=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=Je(e),Bh("collection","path",t),e instanceof Wh){const n=ea.fromString(t,...r);return Uh(n),new Yh(e,null,n)}{if(!(e instanceof Kh||e instanceof Yh))throw new Lo(jo.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(ea.fromString(t,...r));return Uh(n),new Yh(e.firestore,null,n)}}(zm.db,e),i=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(const i of n)e=i._apply(e);return e}(r,...t),s=new Hd;try{const t=await qd(i);if(t.empty)throw new Wd(e);const r=[];if(t.forEach(e=>{const t=e.data();if(!t)return Promise.reject(new Error("No data on docSnap."));t.id=e.id,r.push(t)}),n&&n.toPopulate){const e=[];for(const i of r){const t=[],r=[],s=new Gd;s.data=i,n.toPopulate.filter(e=>i[e.refName]).forEach(e=>{const n=i[e.refName].id,s=Vm(e.refName);n&&s&&(t.push(this.getDocument(n,s,e.cascade)),r.push(e.refName))}),e.push(this.collateDocumentData(t,r,s))}const t=(await Promise.all(e)).map(e=>{let{data:t}=e;return t});return s.data=t,Promise.resolve(s)}return s.data=r,Promise.resolve(s)}catch(o){return s.error=Um(o),Promise.resolve(s)}}async downloadJson(e){const t=new Gd;try{const n=await this.getDownloadUrl(e),r=await fetch(n).then(e=>e.json());if(!r)throw new Error("No JSON found for uri: ".concat(e));t.data=r}catch(n){const e=Um(n);t.error=e}finally{return Promise.resolve(t)}}async getDownloadUrl(e){if("string"===typeof e&&/^https?:\/\//i.test(e))return e;if("string"===typeof e&&e.startsWith("gs://")){const t=e.match(/^gs:\/\/([^/]+)\/(.+)$/);if(t){const e=t[1],n=t[2].split("/").map(e=>encodeURIComponent(e)).join("/");return"https://storage.googleapis.com/".concat(e,"/").concat(n)}}try{const r=Pm(),i=(n=e,xm(Je(r),n));return await(t=i,Tm(t=Je(t)))}catch(r){throw r}var t,n}}function qm(e,t){try{const n=function(e){switch(e){case jm.Body:return["id","is_active","start_datetime","name"];case jm.Event:return["id","body_ref","event_datetime"];case jm.EventMinutesItem:return["id","event_ref","index","minutes_item_ref"];case jm.EventMinutesItemFile:return["id","event_minutes_item_ref","name","uri"];case jm.File:return["id","name","uri"];case jm.IndexedEventGram:return["id","context_span","datetime_weighted_value","event_ref","stemmed_gram","unstemmed_gram","value"];case jm.Matter:return["id","matter_type","name","title"];case jm.MatterFile:return["id","matter_ref","name","uri"];case jm.MatterSponsor:return["id","matter_ref","person_ref"];case jm.MatterStatus:return["id","matter_ref","status","update_datetime"];case jm.MinutesItem:return["id","name"];case jm.Person:return["id","is_active","name","router_string"];case jm.Role:return["id","start_datetime","title","person_ref","seat_ref"];case jm.Seat:return["id","name"];case jm.Session:return["id","event_ref","session_datetime","session_index","video_uri"];case jm.Transcript:return["id","confidence","created","generator","file_ref","session_ref"];case jm.TranscriptJSON:return["confidence","generator","created_datetime","sentences"];case jm.Vote:return["id","event_minutes_item_ref","event_ref","matter_ref","person_ref","decision"]}}(t).filter(t=>!e.hasOwnProperty(t));if(n.length>0)throw new Error("Missing properties: ".concat(JSON.stringify(n)));return}catch(n){return n instanceof Error?(n.message="validateResponseData_".concat(n.message),n):new Error("validateResponseData_somehow threw a incorrectly-typed error")}}class Gm{constructor(e,t){this.networkService=zm.getInstance(t.options,t.settings),this.modelName=e;const n=e.split("_").map(e=>e[0].toUpperCase()+e.slice(1)).join("");this.serviceName="".concat(n,"Service")}async createModel(e,t,n){try{const{data:n,error:r}=await e;if(r)throw r;if(!n)throw new Error("No ".concat(this.modelName," found."));const i=qm(n,this.modelName);if(i)throw i;return Promise.resolve(new t(n))}catch(r){const e=Um(r);return e.message="".concat(this.serviceName,"_").concat(n,"_").concat(e.message),Promise.reject(e)}}async createModels(e,t,n){try{const{data:n,error:r}=await e;if(r){if(r instanceof Wd)return Promise.resolve([]);throw r}if(!n||0===n.length)throw new Error("No ".concat(this.modelName,"s found."));const i=n.map(e=>{const n=qm(e,this.modelName);if(n)throw n;return new t(e)});return Promise.resolve(i)}catch(r){const e=Um(r);return e.message="".concat(this.serviceName,"_").concat(n,"_").concat(e.message),Promise.reject(e)}}}var Hm=(e=>(e.lt="<",e.lteq="<=",e.eq="==",e.gt=">",e.gteq=">=",e.not_eq="!=",e.array_contains="array-contains",e.array_contains_any="array-contains-any",e.in="in",e.not_in="not-in",e))(Hm||{}),Wm=(e=>(e.asc="asc",e.desc="desc",e))(Wm||{});function Km(e){return new Date(1e3*e.seconds)}class Qm{constructor(e){this.id=e.id,this.is_active=e.is_active,this.start_datetime=Km(e.start_datetime),this.name=e.name,e.description&&(this.description=e.description),e.end_datetime&&(this.end_datetime=Km(e.end_datetime)),e.external_source_id&&(this.external_source_id=e.external_source_id)}}class Ym extends Gm{constructor(e){super(jm.Body,e)}async getBodiesByName(e){const t=this.networkService.getDocuments(jm.Body,[Cd("name",Hm.eq,e)]);return this.createModels(t,Qm,"getBodyByName(".concat(e,")"))}async getAllBodies(){const e=this.networkService.getDocuments(jm.Body,[kd("name")]);return this.createModels(e,Qm,"getAllBodies()")}}const Jm=e=>{let{error:t}=e;const n=Object(l.g)(),r=t?t.toString():"";return Q("div",{children:[K("h1",{className:"mzp-u-title-sm",children:"Sorry, we can\u2019t find that page."}),K("p",{children:r}),K("button",{className:"mzp-c-button mzp-t-secondary mzp-t-md",onClick:()=>n.goBack(),children:"Back"})]})},Xm=e=>{let{isLoading:t,children:n,error:r}=e;return t?K(b.a,{active:!0,size:"massive"}):r?K(Jm,{error:r}):K(Y,{children:n})},Zm={isLoading:!1,error:null,hasFetchRequest:!0};var $m=(e=>(e.FETCH_INIT="FETCH_INIT",e.FETCH_SUCCESS="FETCH_SUCCESS",e.FETCH_FAILURE="FETCH_FAILURE",e.FETCH="FETCH",e))($m||{});function ep(e,t){const n=(e,t)=>{switch(t.type){case"FETCH_INIT":return Object(o.a)(Object(o.a)({},e),{},{isLoading:!0,error:null});case"FETCH_SUCCESS":return Object(o.a)(Object(o.a)({},e),{},{isLoading:!1,data:t.payload,hasFetchRequest:!1});case"FETCH_FAILURE":return Object(o.a)(Object(o.a)({},e),{},{isLoading:!1,error:t.payload,hasFetchRequest:!1});case"FETCH":return Object(o.a)(Object(o.a)({},e),{},{hasFetchRequest:!0});default:return e}},[r,i]=Object(a.useReducer)(n,e);return Object(a.useEffect)(()=>{let e=!1;return r.hasFetchRequest&&(async()=>{try{i({type:"FETCH_INIT"});const n=await t();e||i({type:"FETCH_SUCCESS",payload:n})}catch(n){if(!e){const e=Um(n);i({type:"FETCH_FAILURE",payload:e})}}})(),()=>{e=!0}},[r.hasFetchRequest,t]),{state:r,dispatch:i}}var tp=(e=>(e.FAILURE="FAILURE",e.FETCH_CARDS="FETCH_CARDS",e.FETCH_CARDS_SUCCESS="FETCH_CARDS_SUCCESSS",e.SHOW_MORE_CARDS="SHOW_MORE_CARDS",e))(tp||{});function np(e,t){const n=(e,t)=>{switch(t.type){case"FAILURE":return Object(o.a)(Object(o.a)({},e),{},{error:t.payload,fetchCards:!1});case"FETCH_CARDS":return Object(o.a)(Object(o.a)({},e),{},{error:null,fetchCards:!0});case"FETCH_CARDS_SUCCESSS":{const n=Math.min(e.batchSize,t.payload.length);return Object(o.a)(Object(o.a)({},e),{},{cards:t.payload,visibleCount:n,fetchCards:!1})}case"SHOW_MORE_CARDS":{const t=Math.min(e.batchSize+e.visibleCount,e.cards.length);return Object(o.a)(Object(o.a)({},e),{},{visibleCount:t})}default:return e}},[r,i]=Object(a.useReducer)(n,e);return Object(a.useEffect)(()=>{let e=!1;return r.fetchCards&&(async()=>{try{const n=await t();e||i({type:"FETCH_CARDS_SUCCESSS",payload:n})}catch(n){if(!e){const e=Um(n);i({type:"FAILURE",payload:e})}}})(),()=>{e=!0}},[r.fetchCards,t,i]),[r,i]}class rp{constructor(e){this.id=e.id,this.uri=e.uri,this.name=e.name,e.description&&(this.description=e.description),e.media_type&&(this.media_type=e.media_type)}}class ip{constructor(e){this.id=e.id,this.event_datetime=Km(e.event_datetime),this.body_ref=e.body_ref.id,e.agenda_uri&&(this.agenda_uri=e.agenda_uri),e.minutes_uri&&(this.minutes_uri=e.minutes_uri),"object"!==typeof e.body_ref||e.body_ref instanceof Kh||(this.body=new Qm(e.body_ref)),e.external_source_id&&(this.external_source_id=e.external_source_id),Array.isArray(e.display_keywords)&&(this.display_keywords=e.display_keywords.filter(e=>"string"===typeof e&&e.trim().length>0)),e.hover_thumbnail_ref&&(e.hover_thumbnail_ref instanceof Kh?this.hover_thumbnail_ref=e.hover_thumbnail_ref.id:"object"===typeof e.hover_thumbnail_ref&&(this.hover_thumbnail=new rp(e.hover_thumbnail_ref))),e.static_thumbnail_ref&&(e.static_thumbnail_ref instanceof Kh?this.static_thumbnail_ref=e.static_thumbnail_ref.id:"object"===typeof e.static_thumbnail_ref&&(this.static_thumbnail=new rp(e.static_thumbnail_ref)))}}class sp{constructor(e){this.id=e.id,this.context_span=e.context_span,this.datetime_weighted_value=e.datetime_weighted_value,this.event_ref=e.event_ref.id,this.stemmed_gram=e.stemmed_gram,this.unstemmed_gram=e.unstemmed_gram,this.value=e.value,"object"!==typeof e.event_ref||e.event_ref instanceof Kh||(this.event=new ip(e.event_ref))}}class op extends Gm{constructor(e){super(jm.IndexedEventGram,e)}async getMatchingGrams(e){const t=this.networkService.getDocuments(jm.IndexedEventGram,[Cd("stemmed_gram",Hm.eq,e)]);return this.createModels(t,sp,"getMatchingGrams(".concat(e,")"))}async getKeyGramsForEvent(e){const t=this.networkService.getDocuments(jm.IndexedEventGram,[Cd("event_ref",Hm.eq,Jh(zm.getDb(),e)),kd("value",Wm.desc),Nd(5)]);return this.createModels(t,sp,"getKeyGramsForEvent(".concat(e,")"))}}class ap extends Gm{constructor(e){super(jm.Event,e),this.indexedEventGramService=new op(e)}async getEventById(e){const t=this.networkService.getDocument(e,jm.Event,new Fm([new Bm(jm.Body,Lm.EventBodyRef)]));return this.createModel(t,ip,"getEventById(".concat(e,")"))}async getFullEventById(e){const t=this.networkService.getDocument(e,jm.Event,new Fm([new Bm(jm.Body,Lm.EventBodyRef),new Bm(jm.File,Lm.EventStaticThumbnailRef),new Bm(jm.File,Lm.EventHoverThumbnailRef)]));return this.createModel(t,ip,"getFullEventById(".concat(e,")"))}async getEvents(e,t,n,r,i){if(t.length>10)return Promise.reject(new Error("Number of bodies exceeded ".concat(10,".")));const s=[];if(t.length>0){const e=t.map(e=>Jh(zm.getDb(),jm.Body,e));s.push(Cd(Lm.EventBodyRef,Hm.in,e))}if(n.start){const e=Xo.fromDate(n.start);s.push(Cd("event_datetime",Hm.gteq,e))}if(n.end){const e=new Date(n.end);e.setUTCDate(e.getUTCDate()+1);const t=Xo.fromDate(e);s.push(Cd("event_datetime",Hm.lteq,t))}if(s.push(kd(r.by,r.order)),i){const e=Xo.fromDate(i);s.push(Rd(e))}s.push(Nd(e));const o=this.networkService.getDocuments(jm.Event,s,new Fm([new Bm(jm.Body,Lm.EventBodyRef)]));return this.createModels(o,ip,"getEvents([".concat(t,"], ").concat(JSON.stringify(n),", ").concat(JSON.stringify(r),", ").concat(null==i?void 0:i.toISOString,"})"))}async getRenderableEvent(e){try{if(Array.isArray(e.display_keywords)&&e.display_keywords.length>0)return Promise.resolve(Object(o.a)(Object(o.a)({},e),{},{keyGrams:e.display_keywords}));const t=(await this.indexedEventGramService.getKeyGramsForEvent("".concat(jm.Event,"/").concat(e.id))).reduce((e,t)=>(void 0!==t.unstemmed_gram&&e.push(t.unstemmed_gram),e),[]);return Promise.resolve(Object(o.a)(Object(o.a)({},e),{},{keyGrams:t}))}catch(t){const n=Um(t);return n.message="eventService_getRenderableEvent(".concat(JSON.stringify(e),")_").concat(n.message),Promise.reject(n)}}}const cp=e=>{let t=e.replace(/[\t\n]+/g," ");return t=t.replace(/[\-\-]/g," "),t=t.replace(/['!"#$%&\\'()\*+,\-\.\/:;<=>?@\[\\\]\^_`{|}~']/g,""),t=t.replace(/\s{2,}/g," "),t.trim()};class lp{constructor(e,t,n,r,i,s){this.eventRef="".concat(jm.Event,"/").concat(e),this.pureRelevance=t,this.datetimeWeightedRelevance=n,this.containedGrams=r,this.selectedGram=i,this.selectedContextSpan=s}}class up{constructor(e){this.networkService=zm.getInstance(e.options,e.settings),this.eventService=new ap(e),this.indexedEventGramService=new op(e),this.serviceName="EventSearchService"}cleanText(e){const t=cp(e);return Object(C.removeStopwords)(t.split(" "))}getStemmedGrams(e){const t=this.cleanText(e),n=[];return Array.from([1,2,3]).forEach(e=>{Object(T.a)(e)(t).forEach(e=>{n.push(e.map(e=>Object(k.a)(e.toLowerCase())).join(" "))})}),n}async searchEvents(e){const t=this.getStemmedGrams(e).map(e=>this.indexedEventGramService.getMatchingGrams(e)),n=new Map,r=[];try{return await Promise.allSettled(t).then(e=>{e.forEach(e=>{if("fulfilled"===e.status)e.value.forEach(e=>{if(void 0!==e.event_ref){const t=n.get(e.event_ref);void 0===t?n.set(e.event_ref,[e]):t.push(e)}});else if(!(e.reason instanceof Wd))throw e.reason});for(const[t,i]of n){const e=Object(S.maxBy)(i,"value");let n="",s="";e&&(n=(null==e?void 0:e.context_span)||"",s=(null==e?void 0:e.unstemmed_gram)||"");const o=i.reduce((e,t)=>(void 0!==t.unstemmed_gram&&e.push(t.unstemmed_gram),e),[]);r.push(new lp(t,Object(S.sumBy)(i,"value"),Object(S.sumBy)(i,"datetime_weighted_value"),o,s,n))}}),Promise.resolve(r)}catch(i){const t=Um(i);return t.message="".concat(this.serviceName,"_searchEvents(").concat(e,")_").concat(t.message),Promise.reject(t)}}async getRenderableEvent(e){const t=e.eventRef.split("/")[1];try{const n=await this.eventService.getEventById(t);let r=[];if(Array.isArray(n.display_keywords)&&n.display_keywords.length>0)r=n.display_keywords;else{r=(await this.indexedEventGramService.getKeyGramsForEvent(e.eventRef)).reduce((e,t)=>(void 0!==t.unstemmed_gram&&e.push(t.unstemmed_gram),e),[])}return Promise.resolve(Object(o.a)(Object(o.a)({},e),{},{event:n,keyGrams:r}))}catch(n){const t=Um(n);return t.message="".concat(this.serviceName,"_getRenderableEvent(").concat(e.eventRef,")_").concat(t.message),Promise.reject(t)}}}class hp extends Gm{constructor(e){super(jm.File,e)}async getFileById(e){const t=this.networkService.getDocument(e,jm.File);return this.createModel(t,rp,"getFileById(".concat(e,")"))}}var dp=h.a.div({position:"absolute",height:"100%",width:"100%"});const mp=Object(d.c)(j||(j=Object(s.a)(["\n  0% {\n    transform: translateX(-100%);\n  }\n  50% {\n    /* +0.5s of delay between each loop */\n    transform: translateX(100%);\n  }\n  100% {\n    transform: translateX(100%);\n  }\n"]))),pp=h.a.div(e=>({position:"relative",width:"100%",height:"100%","& > div, & > div:nth-of-type(2):after":{position:"absolute",inset:0},"& > div:first-of-type":{opacity:e.isLoading?0:1},"& > div:nth-of-type(2)":{display:e.isLoading?"block":"none",width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.11)",overflow:"hidden"},"& > div:nth-of-type(2):after":{content:'""',animation:"".concat(mp," 1.6s linear 0.5s infinite"),backgroundImage:"linear-gradient(90deg, transparent, rgba(0, 0, 0, 0.04), transparent)",transform:"translateX(-100%)"}})),fp=e=>{let{contentIsLoading:t,children:n,placeholderStyle:r}=e;return Q(pp,{isLoading:t,children:[Q("div",{children:n}),K("div",{style:r})]})},gp="#DDDDDD",yp="#595959",vp="#111111",bp="#00458b",_p=" \u2022 ",wp={COLORS:{ODD_CELL:"#FFFFFF",EVEN_CELL:gp,ACTIVE_UNDERLINE:bp}},Ep=h.a.section({marginBottom:0,"& .mzp-c-card-title":{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:2,overflow:"hidden",textOverflow:"ellipsis",minHeight:"2.16em",maxHeight:"2.16em",["@media (min-width:".concat(oe,")")]:{minHeight:"2.14em",maxHeight:"2.14em"}}}),Sp=h.a.div({position:"relative","& > img, & > video":{position:"absolute",inset:0},"& > :first-child":{zIndex:1},"& > :last-child":{zIndex:2,opacity:0},"&:hover > :last-child, &:focus-within > :last-child":{opacity:1}}),Ip=e=>{let{event:t,tags:n,excerpt:r,gram:i,query:s}=e;var o,c,l,u,h;const{language:d}=te(),{firebaseConfig:m,municipality:p}=Z(),[f,g]=Object(a.useState)(!0),y=Object(a.useCallback)(async()=>{const e=new hp(m),{networkService:n}=e,r=[Promise.resolve(void 0),Promise.resolve(void 0)];t.static_thumbnail_ref&&(r[0]=e.getFileById(t.static_thumbnail_ref).then(e=>n.getDownloadUrl(e.uri)).catch(()=>Promise.resolve(void 0))),t.hover_thumbnail_ref&&(r[1]=e.getFileById(t.hover_thumbnail_ref).then(e=>n.getDownloadUrl(e.uri)).catch(()=>Promise.resolve(void 0)));const[i,s]=await Promise.all(r);return Promise.resolve({staticThumbNailUrl:i,hoverPreviewUrl:s})},[m,t.static_thumbnail_ref,t.hover_thumbnail_ref]),{state:v}=ep({isLoading:!1,error:null,hasFetchRequest:!0},y),b=null==(o=t.event_datetime)?void 0:o.toLocaleDateString(d,{timeZone:p.timeZone,month:"long",day:"numeric",year:"numeric"}),_=null==(c=t.body)?void 0:c.name,w=Object(a.useMemo)(()=>{const e=cp(s||""),t=Object(C.removeStopwords)(e.split(" "));return i&&i.length>0&&t.push(i),0===t.length?[]:[new RegExp("\\b(".concat(t.join("|"),")"),"g")]},[s,i]),E="".concat(null==(l=t.body)?void 0:l.name," - ").concat(b),S=n.map(e=>e.toLowerCase()).join(_p);return K(Ep,{className:"mzp-c-card mzp-c-card-medium mzp-has-aspect-16-9",children:Q("div",{className:"mzp-c-card-block-link",children:[K("div",{className:"mzp-c-card-media-wrapper",children:K(dp,{children:K(fp,{contentIsLoading:f,children:Q(Sp,{children:[K("img",{className:"mzp-c-card-image",src:null==(u=v.data)?void 0:u.staticThumbNailUrl,alt:E,onLoad:()=>g(!1)}),K("video",{className:"mzp-c-card-image",src:null==(h=v.data)?void 0:h.hoverPreviewUrl,muted:!0,loop:!0,autoPlay:!0,playsInline:!0,preload:"none","aria-hidden":"true"})]})})})}),Q("div",{className:"mzp-c-card-content",children:[K("div",{className:"mzp-c-card-tag",children:re.committee}),K("h2",{className:"mzp-c-card-title",children:b}),K("p",{className:"mzp-c-card-desc",children:_}),r&&K("p",{className:"mzp-c-card-desc",style:{fontStyle:"italic",marginTop:"1rem"},children:K(N.a,{caseSensitive:!1,searchWords:w,textToHighlight:'"'.concat(r,'"')})}),n.length>0&&Q(Y,{children:[K("p",{className:"mzp-c-card-meta",children:re.keywords}),K("p",{className:"mzp-c-card-desc",children:S})]})]})]})})},Cp=h.a.div({display:"flex",flexDirection:"column",gap:4,["@media (min-width:".concat(oe,")")]:{flexDirection:"row",flexWrap:"wrap","& > div:last-of-type:not(:first-of-type), & > button:last-of-type":{marginLeft:"auto"}}}),Tp=()=>K("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:K("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),kp=h.a.button({display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%","& > svg":{marginLeft:24,width:16,height:16}});kp.displayName="TriggerButton";const xp=Object(h.a)(_.a)({maxWidth:"100% !important",boxShadow:"none !important",border:"2px solid #9595a2 !important"});xp.displayName="StyledPopup";const Np=Object(h.a)(_.a.Content)({flexGrow:1,overflowY:"auto",paddingLeft:"10px",paddingRight:"10px"});Np.displayName="ContentContainer";const Ap=h.a.div({maxHeight:"45vh",display:"flex",flexDirection:"column"});Ap.displayName="PopupContainer";const Rp=h.a.div({display:"flex",justifyContent:"space-between",padding:".833em 0 0",minWidth:"256px"});Rp.displayName="ButtonContainer";const Dp=e=>{let{name:t,clear:n,getTextRep:r,isActive:i,popupIsOpen:s,setPopupIsOpen:o,handlePopupClose:c,closeOnChange:l,children:u,hasRequiredError:h,hasLimitError:d,limit:m}=e;const p=Object(a.useRef)(null),f=Object(S.some)([h,d]),g=Object(a.useMemo)(()=>{const e=[];return h&&e.push("Please select at least one ".concat(t.toLowerCase(),".")),d&&e.push("Please select only ".concat(m," or fewer ").concat(t.toLowerCase(),"s.")),e},[h,d,t,m]);return Q(a.Fragment,{children:[K(xp,{basic:!0,flowing:!0,context:p.current||void 0,on:"click",open:s,onClose:()=>o(!1),pinned:!0,offset:[0,-5],position:"bottom left",positionFixed:!0,trigger:Q(kp,{className:"mzp-c-button mzp-t-lg mzp-t-neutral",onClick:()=>{o(e=>!e)},children:[r(),K(Tp,{})]}),children:Q(Ap,{children:[K(Np,{children:u}),f&&K("div",{className:"mzp-c-form-errors",style:{margin:"24px 0"},children:K("ul",{className:"mzp-u-list-styled",children:g.map(e=>K("li",{children:e},e))})}),!l&&Q(Rp,{children:[K("button",{className:"mzp-c-button mzp-t-md mzp-t-neutral",disabled:!i(),onClick:()=>{n()},children:re.clear}),K("button",{className:"mzp-c-button mzp-t-md mzp-t-product",disabled:f,onClick:()=>{o(!1),!f&&c&&c()},children:re.save})]})]})}),K("div",{ref:p})]})};function Op(e,t){if(isNaN(e.getTime()))return;const n=e.toLocaleString("en-US",{timeZone:t,timeZoneName:"short"}).split(" ").pop(),r=e.toLocaleString("en-US",{timeZone:"UTC",timeZoneName:"short"}).split(" ");return r.pop(),new Date("".concat(r.join(" ")," ").concat(n))}const Pp=(e,t)=>(n,r)=>{const i=Op(new Date(n.start),t),s=Op(new Date(n.end),t),o=null==i?void 0:i.toLocaleDateString(e,{timeZone:t,month:"short",day:"numeric",year:i.getUTCFullYear()===(null==s?void 0:s.getUTCFullYear())?void 0:"numeric"}),a=null==s?void 0:s.toLocaleDateString(e,{timeZone:t,month:"short",day:"numeric",year:"numeric"});let c;return c=i&&s?"".concat(o," - ").concat(a):i?"".concat(o," -"):s?"- ".concat(a):r,c},Mp=e=>{let{state:t,update:n}=e;const r=e=>{const t=e.currentTarget.name,r=e.currentTarget.value;n(t,r)};return Q(_e,{className:"mzp-c-form",children:[Q("div",{className:"mzp-c-field",children:[K("label",{className:"mzp-c-field-label",htmlFor:"form-input-control-start-date",children:"From"}),K("input",{className:"mzp-c-field-control",type:"date",name:"start",id:"form-input-control-start-date",value:t.start,onChange:r})]}),Q("div",{className:"mzp-c-field",children:[K("label",{className:"mzp-c-field-label",htmlFor:"form-input-control-end-date",children:"To"}),K("input",{className:"mzp-c-field-control",type:"date",name:"end",id:"form-input-control-end-date",value:t.end,onChange:r})]})]})},jp=e=>{let{sortOptions:t,state:n,update:r,onPopupClose:i}=e;const s=e=>{const[t,n]=e.currentTarget.value.split("#");if(r("by",t),r("order",n),e.currentTarget.parentNode){const t=e.currentTarget.parentNode.textContent;t&&r("label",t)}i()};return K(_e,{className:"mzp-c-form",children:K("fieldset",{className:"mzp-c-field-set",children:K("div",{className:"mzp-c-choices",children:t.map(e=>Q("div",{className:"mzp-c-choice",children:[K("input",{className:"mzp-c-choice-control",type:"radio",id:"form-checkbox-control-".concat(e.label),value:"".concat(e.by,"#").concat(e.order),checked:n.label===e.label,onChange:s}),K("label",{className:"mzp-c-choice-label",htmlFor:"form-checkbox-control-".concat(e.label),children:e.label})]},e.label))})})})},Lp=(e,t)=>{let n=t;return e.by&&e.order&&e.label&&(n=e.label),n},Vp=e=>{let{allBodies:t,filters:n,sortOptions:r,handlePopupClose:i}=e;const[s,o,c]=n,[l,u]=Object(a.useState)("");return Q(Cp,{children:[K("div",{children:K(Dp,{name:s.name,clear:s.clear,getTextRep:s.getTextRep,isActive:s.isActive,popupIsOpen:s.popupIsOpen,setPopupIsOpen:s.setPopupIsOpen,handlePopupClose:i,closeOnChange:!1,hasLimitError:s.hasLimitError(),limit:s.limit,children:K(Se,{name:s.name,state:s.state,update:s.update,options:t.map(e=>({name:e.id,label:e.name,disabled:!1})),optionQuery:l,setOptionQuery:u})})}),K("div",{children:K(Dp,{name:o.name,clear:o.clear,getTextRep:o.getTextRep,isActive:o.isActive,popupIsOpen:o.popupIsOpen,setPopupIsOpen:o.setPopupIsOpen,handlePopupClose:i,closeOnChange:!1,children:K(Mp,{state:o.state,update:o.update})})}),K("div",{children:K(Dp,{name:c.name,clear:c.clear,getTextRep:c.getTextRep,isActive:c.isActive,popupIsOpen:c.popupIsOpen,setPopupIsOpen:c.setPopupIsOpen,handlePopupClose:i,closeOnChange:!0,children:K(jp,{sortOptions:r,state:c.state,update:c.update,onPopupClose:()=>{c.setPopupIsOpen(!1),i()}})})})]})},Bp="0.75rem",Fp="1rem",Up="1.125rem",zp="1.25rem",qp=h.a.p({fontSize:Up}),Gp=h.a.div({display:"flex",flexDirection:"column",gap:32}),Hp=e=>{let{placeholder:t,query:n,setQuery:r,handleSearch:i}=e;return K("form",{className:"mzp-c-form",role:"search",onSubmit:e=>{e.preventDefault(),i()},children:K("input",{type:"search",placeholder:t,required:!0,"aria-required":!0,value:n,onChange:e=>r(e.target.value)})})},Wp=h.a.div({display:"flex",flexDirection:"column",rowGap:32,"& > h1, & form, & input":{marginBottom:0},"& input":{width:"100%"},["@media (min-width:".concat(oe,")")]:{flexDirection:"row",justifyContent:"space-between",alignItems:"center","& input":{width:"auto"}}}),Kp=h.a.div(e=>({visibility:e.isVisible?"visible":"hidden","& > button":{width:"100%"},"& .ui.loader":{marginLeft:16},["@media (min-width:".concat(oe,")")]:{"& > button":{width:"auto"}}}));const Qp=h.a.div({display:"grid",gap:64,gridTemplateColumns:"1fr",["@media (min-width:".concat(oe,")")]:{justifyContent:"space-between",gridTemplateColumns:"repeat(".concat(2,", 1fr)")},["@media (min-width:".concat(ae,")")]:{gridTemplateColumns:"repeat(".concat(3,", 1fr)")}}),Yp=e=>{let{cards:t}=e;return K(Qp,{children:t.map(e=>{let{link:t,jsx:n,searchQuery:r}=e;return K("div",{children:K(u.b,{to:{pathname:t,state:{query:r||""}},style:{textDecoration:"none",color:vp,fontSize:Up},children:n})},t)})})},Jp=["en"],Xp=e=>{let{searchEventsState:t,bodies:n}=e;const{firebaseConfig:r,municipality:i}=Z(),{language:s}=te(),o=Object(a.useRef)(t.query),[c,u]=Object(a.useState)(t.query);ne(o.current?"".concat(re.events," -- ").concat(o.current):re.events);const h=Ie({name:re.date,initialState:t.dateRange,defaultDataValue:"",textRepFunction:Pp(s,i.timeZone)}),d=Ie({name:re.committee,initialState:t.committees,defaultDataValue:!1,textRepFunction:ve,limit:10}),m=Ie({name:"Sort",initialState:{by:"datetimeWeightedRelevance",order:Wm.desc,label:re.most_relevant_first},defaultDataValue:"",textRepFunction:Lp}),p=Object(a.useCallback)(async()=>{const e=new up(r),t=await e.searchEvents(c),n=await Promise.all(t.map(t=>e.getRenderableEvent(t))),s=be(d.state);let o=n.filter(e=>{let{event:t}=e;var n;if(s.length){if(!(null==(n=t.body)?void 0:n.id))return!1;if(!s.includes(t.body.id))return!1}const r=Op(new Date(h.state.start),i.timeZone),o=Op(new Date(h.state.end),i.timeZone);if(r||o){if(!t.event_datetime)return!1;if(r&&t.event_datetime<r)return!1;if(o){const e=new Date(o);if(e.setUTCDate(e.getUTCDate()+1),t.event_datetime>e)return!1}}return!0});return o=Object(S.orderBy)(o,[m.state.by],[m.state.order]),Promise.resolve(o)},[c,d.state,h.state,m.state,r,i.timeZone]),f=Object(I.useMediaQuery)({query:"(min-width: ".concat(ae,")")}),[g,y]=np({batchSize:4-(f?1:0),visibleCount:0,cards:[],fetchCards:!0,error:null},p),v=Object(l.h)(),_=Object(a.useCallback)(()=>{o.current=c;const e="?q=".concat(c.trim().replace(/\s+/g,"+"));history.pushState({},"","#".concat(v.pathname).concat(e)),y({type:tp.FETCH_CARDS})},[c,v,y]),w=Object(a.useCallback)(()=>y({type:tp.SHOW_MORE_CARDS}),[y]),E=Object(a.useMemo)(()=>{if(g.fetchCards)return K(b.a,{active:!0,size:"massive"});if(g.error)return K(qp,{children:g.error.toString()});if(0===g.cards.length)return K(qp,{children:re.no_results_found});{const e=g.cards.slice(0,g.visibleCount).map(e=>{let{event:t,keyGrams:n,selectedContextSpan:r,selectedGram:i}=e;return{link:"/".concat(fe.EVENT,"/").concat(t.id),jsx:K(Ip,{event:t,tags:n,excerpt:r,gram:i,query:o.current}),searchQuery:o.current}});return Q(Y,{children:[K(qp,{children:"".concat(g.cards.length," ").concat(fe.EVENT)}),K(Yp,{cards:e})]})}},[g.fetchCards,g.error,g.cards,g.visibleCount]),C=Object(a.useMemo)(()=>g.visibleCount<g.cards.length&&!g.fetchCards,[g]);return Q(Gp,{children:[Q(Wp,{children:[K("h1",{className:"mzp-u-title-sm",children:re.event_search_results}),K(Hp,{placeholder:re.search_topic_placeholder,query:c,setQuery:u,handleSearch:_})]}),K(Vp,{allBodies:n,filters:[d,h,m],sortOptions:[{by:"datetimeWeightedRelevance",order:Wm.desc,label:re.most_relevant_first},{by:"pureRelevance",order:Wm.desc,label:re.closest_match_first},{by:"event.event_datetime",order:Wm.desc,label:re.newest_first},{by:"event.event_datetime",order:Wm.asc,label:re.oldest_first}],handlePopupClose:_}),Q("p",{style:{fontSize:Fp},children:[re.disclaimer_start," ",K("a",{rel:"noopener noreferrer license external",href:"https://cloud.google.com/speech-to-text",target:"_blank",children:"Google Speech-to-Text"})," ",re.disclaimer_end]}),E,K(Kp,{isVisible:C,children:K("button",{className:"mzp-c-button mzp-t-secondary mzp-t-lg",onClick:w,children:re.show_more})})]})},Zp=()=>{const e=Object(l.h)(),t=Object(a.useMemo)(()=>{if(e.state)return e.state;const{q:t}=v.a.parse(e.search);return{query:t||" ",committees:{},dateRange:{start:"",end:""}}},[e]),{firebaseConfig:n}=Z(),r=Object(a.useCallback)(async()=>{const e=new Ym(n),r=await e.getAllBodies();return Promise.resolve({bodies:r,searchEventsState:t})},[n,t]),{state:i}=ep({isLoading:!1,error:null,hasFetchRequest:!0},r);return K(Xm,{isLoading:i.isLoading,error:i.error,children:i.data&&K(Xp,Object(o.a)({},i.data))})};class $p{constructor(e){this.id=e.id,this.event_ref=e.event_ref.id,this.session_datetime=Km(e.session_datetime),this.session_index=e.session_index,this.video_uri=e.video_uri,e.caption_uri&&(this.caption_uri=e.caption_uri),"object"!==typeof e.event_ref||e.event_ref instanceof Kh||(this.event=new ip(e.event_ref)),e.external_source_id&&(this.external_source_id=e.external_source_id)}}class ef extends Gm{constructor(e){super(jm.Session,e)}async getSessionsByEventId(e){const t=this.networkService.getDocuments(jm.Session,[Cd(Lm.SessionEventRef,Hm.eq,Jh(zm.getDb(),jm.Event,e)),kd("session_index")]);return this.createModels(t,$p,"getSessionsByEventId(".concat(e,")"))}}class tf{constructor(e){this.id=e.id,this.confidence=e.confidence,this.generator=e.generator,this.created=Km(e.created),this.file_ref=e.file_ref.id,this.session_ref=e.session_ref.id,"object"!==typeof e.file_ref||e.file_ref instanceof Kh||(this.file=new rp(e.file_ref)),"object"!==typeof e.session_ref||e.session_ref instanceof Kh||(this.session=new $p(e.session_ref))}}class nf extends Gm{constructor(e){super(jm.Transcript,e)}async getTranscriptBySessionId(e){const t=this.networkService.getDocuments(jm.Transcript,[Cd(Lm.TranscriptSessionRef,Hm.eq,Jh(zm.getDb(),jm.Session,e)),kd("created",Wm.desc),Nd(1)],new Fm([new Bm(jm.File,Lm.TranscriptFileRef)]));return this.createModels(t,tf,"getTranscriptBySessionId(".concat(e,")"))}}class rf{constructor(e){this.id=e.id,this.matter_type=e.matter_type,this.name=e.name,this.title=e.title,e.external_source_id&&(this.external_source_id=e.external_source_id)}}class sf{constructor(e){this.id=e.id,this.name=e.name,e.description&&(this.description=e.description),e.external_source_id&&(this.external_source_id=e.external_source_id),e.matter_ref&&(e.matter_ref instanceof Kh?this.matter_ref=e.matter_ref.id:"object"===typeof e.matter_ref&&(this.matter=new rf(e.matter_ref)))}}class of{constructor(e){this.id=e.id,e.decision&&(this.decision=e.decision),this.event_ref=e.event_ref.id,"object"!==typeof e.event_ref||e.event_ref instanceof Kh||(this.event=new ip(e.event_ref)),e.external_source_id&&(this.external_source_id=e.external_source_id),this.index=e.index,this.minutes_item_ref=e.minutes_item_ref.id,"object"!==typeof e.minutes_item_ref||e.minutes_item_ref instanceof Kh||(this.minutes_item=new sf(e.minutes_item_ref))}}class af extends Gm{constructor(e){super(jm.EventMinutesItem,e)}async getEventMinutesItemsByEventId(e){const t=this.networkService.getDocuments(jm.EventMinutesItem,[Cd(Lm.EventMinutesItemEventRef,Hm.eq,Jh(zm.getDb(),jm.Event,e)),kd("index")],new Fm([new Bm(jm.MinutesItem,Lm.EventMinutesItemMinutesItemRef)]));return this.createModels(t,of,"getEventMinutesItemsByEventId(".concat(e,")"))}}class cf{constructor(e){this.id=e.id,this.event_minutes_item_ref=e.event_minutes_item_ref.id,"object"!==typeof e.event_minutes_item_ref||e.event_minutes_item_ref instanceof Kh||(this.event_minutes_item=new of(e.event_minutes_item_ref)),e.external_source_id&&(this.external_source_id=e.external_source_id),this.name=e.name,this.uri=e.uri}}class lf extends Gm{constructor(e){super(jm.EventMinutesItemFile,e)}async getEventMinutesItemFilesByEventMinutesItemId(e){const t=this.networkService.getDocuments(jm.EventMinutesItemFile,[Cd(Lm.EventMinutesItemFileEventMinutesItemRef,Hm.eq,Jh(zm.getDb(),jm.EventMinutesItem,e)),kd("name")]);try{return this.createModels(t,cf,"getEventMinutesItemFilesByEventMinutesItemId(".concat(e,")"))}catch(n){return Promise.resolve([])}}}class uf{constructor(e){this.id=e.id,this.is_active=e.is_active,this.name=e.name,this.router_string=e.router_string,e.email&&(this.email=e.email),e.phone&&(this.phone=e.phone),e.website&&(this.website=e.website),e.picture_ref&&(e.picture_ref instanceof Kh?this.picture_ref=e.picture_ref.id:"object"===typeof e.picture_ref&&(this.picture=new rp(e.picture_ref))),e.external_source_id&&(this.external_source_id=e.external_source_id)}}class hf{constructor(e){this.id=e.id,this.event_minutes_item_ref=e.event_minutes_item_ref.id,this.event_ref=e.event_ref.id,this.matter_ref=e.matter_ref.id,this.person_ref=e.person_ref.id,this.decision=e.decision,"object"!==typeof e.event_ref||e.event_ref instanceof Kh||(this.event=new ip(e.event_ref)),"object"!==typeof e.event_minutes_item_ref||e.event_minutes_item_ref instanceof Kh||(this.event_minutes_item=new of(e.event_minutes_item_ref)),e.external_source_id&&(this.external_source_id=e.external_source_id),e.in_majority&&(this.in_majority=e.in_majority),"object"!==typeof e.matter_ref||e.matter_ref instanceof Kh||(this.matter=new rf(e.matter_ref)),"object"!==typeof e.person_ref||e.person_ref instanceof Kh||(this.person=new uf(e.person_ref))}}class df extends Gm{constructor(e){super(jm.Vote,e)}async getVotesByEventId(e){const t=this.networkService.getDocuments(jm.Vote,[Cd(Lm.VoteEventRef,Hm.eq,Jh(zm.getDb(),jm.Event,e)),kd(Lm.VotePersonRef)],new Fm([new Bm(jm.Person,Lm.VotePersonRef)]));return this.createModels(t,hf,"getVotesByEventId(".concat(e,")"))}async getVotesByEventMinutesItemId(e){const t=this.networkService.getDocuments(jm.Vote,[Cd(Lm.VoteEventMinutesItemRef,Hm.eq,Jh(zm.getDb(),jm.EventMinutesItem,e))],new Fm([new Bm(jm.Person,Lm.VotePersonRef)]));return this.createModels(t,hf,"getVotesByEventMinutesItemId(".concat(e,")"))}async getFullyPopulatedVotesByPersonId(e,t,n){const r=new Bm(jm.Matter,Lm.VoteMatterRef),i=new Bm(jm.Body,Lm.EventBodyRef),s=new Fm([i]),o=new Bm(jm.Event,Lm.VoteEventRef,s),a=new Bm(jm.EventMinutesItem,Lm.VoteEventMinutesItemRef),c=[];if(c.push(Cd(Lm.VotePersonRef,Hm.eq,Jh(zm.getDb(),jm.Person,e))),c.push(kd(Lm.VoteEventRef,Wm.asc)),n){const e=Jh(zm.getDb(),jm.Vote,n),t=await Ud(e);c.push(Rd(t))}c.push(Nd(t));const l=this.networkService.getDocuments(jm.Vote,c,new Fm([r,o,a]));return this.createModels(l,hf,"getFullyPopulatedVotesByPersonId(".concat(e,")"))}}class mf{constructor(e){this.confidence=e.confidence,this.generator=e.generator,this.created_datetime=Km(e.created_datetime),this.sentences=e.sentences,e.session_datetime&&(this.session_datetime=Km(e.session_datetime)),e.annotations&&(this.annotations=e.annotations)}}class pf extends Gm{constructor(e){super(jm.TranscriptJSON,e)}async download(e){const t=this.networkService.downloadJson(e);return this.createModel(t,mf,"download(".concat(e,")"))}}const ff=e=>{let{data:t,isLoading:n,error:r,notFound:i,children:s}=e;return n?K("p",{children:"Fetching ".concat(t,"...")}):r?K("p",{children:r.message}):i?K("p",{children:"No ".concat(t," found.")}):K(Y,{children:s})},gf=()=>K("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:K("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),yf=()=>K("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",width:"24",height:"24",children:K("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),vf=()=>Q("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",width:"24",height:"24",children:[K("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),K("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),bf=h.a.div(e=>({display:"grid",gridTemplateColumns:"1fr",rowGap:8,padding:"8px 16px",backgroundColor:"white",borderLeft:"4px solid ".concat(e.isJumpedTo?bp:"transparent")})),_f=h.a.div({fontSize:Fp}),wf=h.a.div(e=>({display:"grid",columnGap:4,gridTemplateColumns:e.hasMultipleActions?"1fr auto auto":"1fr auto",justifyContent:"start",alignItems:"center"})),Ef=h.a.div({display:"grid",columnGap:4,gridTemplateColumns:"auto auto",justifyContent:"start",alignItems:"center",fontSize:Bp,overflowWrap:"anywhere","& p":{margin:0}}),Sf=h.a.img({objectFit:"cover",objectPosition:"center",borderRadius:"50%",width:24,height:24}),If=h.a.div({width:24,height:24}),Cf=h.a.button({padding:"2px 8px !important",display:"flex",justifyContent:"center",alignItems:"center"}),Tf=e=>{let{sessionIndex:t,speakerName:n,text:r,startTime:i,speakerId:s,speakerPictureSrc:o,searchQuery:c,handleJumpToVideoClip:l,handleJumpToTranscript:h,componentRef:d}=e;const[m,p]=Object(a.useState)(!1),f=Object(a.useRef)(null);Object(a.useImperativeHandle)(d,()=>({scrollIntoView:()=>{var e;null==(e=f.current)||e.scrollIntoView({behavior:"smooth",block:"center"}),p(!0),setTimeout(()=>{p(!1)},5e3)}}));const g=s?K(u.b,{to:"/people/".concat(s),children:n}):K("div",{children:n}),y=o?K(Sf,{src:o,alt:n}):K(If,{children:K(gf,{})}),v=Object(a.useMemo)(()=>{const e=cp(c||""),t=Object(C.removeStopwords)(e.split(" "));if(!e||0===t.length)return[];const n=t.map(e=>Object(k.a)(e.toLowerCase())),r=t.map((e,t)=>new RegExp("\\b(".concat(e,"|").concat(n[t],")"),"g"));return c&&c.trim().length>0&&r.push(new RegExp(c.trim(),"g")),r},[c]);return Q(bf,{isJumpedTo:m,ref:f,children:[K(_f,{children:K(N.a,{caseSensitive:!1,searchWords:v,textToHighlight:r})}),Q(wf,{hasMultipleActions:void 0!==h,children:[Q(Ef,{children:[y,Q("div",{children:[g,K("p",{children:"".concat(re.session," ").concat(t+1)}),K("p",{children:i})]})]}),K("div",{children:K(_.a,{position:"top right",content:re.jump_to_sentence_video,size:"mini",trigger:K(Cf,{"aria-label":re.jump_to_sentence_video,className:"mzp-c-button mzp-t-neutral",onClick:l,children:K(vf,{})})})}),h&&K("div",{children:K(_.a,{position:"top right",content:re.jump_to_sentence_transcript,size:"mini",trigger:K(Cf,{"aria-label":re.jump_to_sentence_transcript,className:"mzp-c-button mzp-t-neutral",onClick:h,children:K(yf,{})})})})]})]})};function kf(e){return"".concat(e).padStart(2,"0")}function xf(e){const t=Math.floor(e),n=Math.floor(t/3600),r=Math.floor((t-3600*n)/60),i=t-3600*n-60*r;return"".concat(kf(n),":").concat(kf(r),":").concat(kf(i))}const Nf=e=>{let{searchQuery:t,sentences:n,jumpToVideoClip:r,jumpToTranscript:i}=e;const s=new A.c({fixedWidth:!0,defaultHeight:100}),o=e=>{let{index:o,parent:a,key:c,style:l}=e;return K(A.b,{cache:s,parent:a,columnIndex:0,rowIndex:o,children:K("div",{style:l,role:"row",children:K("div",{style:{margin:"0 0 16px 0"},role:"cell",children:K(Tf,{sessionIndex:n[o].session_index,speakerName:n[o].speaker_name,text:n[o].text,startTime:xf(n[o].start_time),handleJumpToVideoClip:(h=n[o].session_index,d=n[o].start_time,()=>r(h,d)),searchQuery:t,speakerId:n[o].speaker_id,speakerPictureSrc:n[o].speaker_pictureSrc,handleJumpToTranscript:(u=n[o].index,()=>{i(u)})})})})},c);var u,h,d};return K(A.a,{onResize:()=>{s.clearAll()},children:e=>{let{width:t,height:r}=e;return K(A.d,{deferredMeasurementCache:s,height:r,rowCount:n.length,rowHeight:s.rowHeight,rowRenderer:o,scrollToIndex:0,style:{willChange:""},width:t})}})},Af=h.a.div({display:"flex",flexDirection:"column",height:"100%"}),Rf=h.a.div({display:"flex",flexDirection:"column",justifyContent:"start",marginBottom:"16px","div:first-of-type":{fontSize:zp,fontWeight:600},["@media (min-width:".concat(oe,")")]:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"}}),Df=h.a.div(e=>({minHeight:e.hasSearchResults?"80vh":0,["@media (min-width:".concat(oe,")")]:{minHeight:e.hasSearchResults?"50vh":0},["@media (min-aspect-ratio:5/4), (min-width:".concat(ae,")")]:{flex:"1 1 auto",minHeight:0}})),Of=e=>{let{searchQuery:t,sentences:n,jumpToVideoClip:r,jumpToTranscript:i}=e;const[s,o]=Object(a.useState)(t),[c,l]=Object(a.useState)(t),u=Object(a.useMemo)(()=>n.data?n.data.map(e=>{let{text:t}=e;const n=cp(t),r=Object(C.removeStopwords)(n.split(" ")).map(e=>Object(k.a)(e.toLowerCase()));return new Set(r)}):[],[n.data]),h=Object(a.useMemo)(()=>{if(n.data){if(!c.trim())return n.data;const e=cp(c),t=Object(C.removeStopwords)(e.split(" "));if(!e||0===t.length)return[];const r=t.map(e=>Object(k.a)(e.toLowerCase()));return n.data.filter((e,t)=>r.some(e=>u[t].has(e)))}return[]},[n.data,u,c]);return Q(Af,{children:[Q(Rf,{children:[K("div",{children:re.search_transcript}),K("div",{children:n.data&&re.number_of_results.replace("{number}","".concat(h.length))})]}),K("form",{className:"mzp-c-form",role:"search",onSubmit:e=>{e.preventDefault(),l(s)},children:K("input",{style:{width:"100%"},type:"search",placeholder:re.search_transcript_placeholder,value:s,onChange:e=>{o(e.target.value)}})}),K(ff,{data:"transcript",isLoading:n.isLoading,error:n.error,notFound:!n.data||0===n.data.length,children:n.data&&K(Df,{hasSearchResults:0!==h.length,children:K(Nf,{searchQuery:c,sentences:h,jumpToVideoClip:r,jumpToTranscript:i})})})]})};!function(e){!function(){var t=R.a;e.exports=function(e){var t=e.browser.IS_IOS||e.browser.IS_NATIVE_ANDROID,n=e.getTech("Tech"),r=e.extend(n,{constructor:function(e,i){n.call(this,e,i),this.setPoster(e.poster),this.setSrc(this.options_.source,!0),this.setTimeout(function(){this.el_&&(this.el_.parentNode.className+=" vjs-youtube",t&&(this.el_.parentNode.className+=" vjs-youtube-mobile"),r.isApiReady?this.initYTPlayer():r.apiReadyQueue.push(this))}.bind(this))},dispose:function(){if(this.ytPlayer)this.ytPlayer.stopVideo&&this.ytPlayer.stopVideo(),this.ytPlayer.destroy&&this.ytPlayer.destroy();else{var e=r.apiReadyQueue.indexOf(this);-1!==e&&r.apiReadyQueue.splice(e,1)}this.ytPlayer=null,this.el_.parentNode.className=this.el_.parentNode.className.replace(" vjs-youtube","").replace(" vjs-youtube-mobile",""),this.el_.parentNode.removeChild(this.el_),n.prototype.dispose.call(this)},createEl:function(){var e=document.createElement("div");e.setAttribute("id",this.options_.techId),e.setAttribute("style","width:100%;height:100%;top:0;left:0;position:absolute"),e.setAttribute("class","vjs-tech");var n=document.createElement("div");if(n.appendChild(e),!t&&!this.options_.ytControls){var r=document.createElement("div");r.setAttribute("class","vjs-iframe-blocker"),r.setAttribute("style","position:absolute;top:0;left:0;width:100%;height:100%"),r.onclick=function(){this.pause()}.bind(this),n.appendChild(r)}return n},initYTPlayer:function(){var e={controls:0,modestbranding:1,rel:0,showinfo:0,loop:this.options_.loop?1:0};if("undefined"!==typeof this.options_.autohide&&(e.autohide=this.options_.autohide),"undefined"!==typeof this.options_.cc_load_policy&&(e.cc_load_policy=this.options_.cc_load_policy),"undefined"!==typeof this.options_.ytControls&&(e.controls=this.options_.ytControls),"undefined"!==typeof this.options_.disablekb&&(e.disablekb=this.options_.disablekb),"undefined"!==typeof this.options_.color&&(e.color=this.options_.color),e.controls?"undefined"!==typeof this.options_.fs&&(e.fs=this.options_.fs):e.fs=0,-1!==this.options_.source.src.indexOf("end=")){var t=this.options_.source.src.match(/end=([0-9]*)/);this.options_.end=parseInt(t[1])}if("undefined"!==typeof this.options_.end&&(e.end=this.options_.end),"undefined"!==typeof this.options_.hl?e.hl=this.options_.hl:"undefined"!==typeof this.options_.language&&(e.hl=this.options_.language.substr(0,2)),"undefined"!==typeof this.options_.iv_load_policy&&(e.iv_load_policy=this.options_.iv_load_policy),"undefined"!==typeof this.options_.list?e.list=this.options_.list:this.url&&"undefined"!==typeof this.url.listId&&(e.list=this.url.listId),"undefined"!==typeof this.options_.listType&&(e.listType=this.options_.listType),"undefined"!==typeof this.options_.modestbranding&&(e.modestbranding=this.options_.modestbranding),"undefined"!==typeof this.options_.playlist&&(e.playlist=this.options_.playlist),"undefined"!==typeof this.options_.playsinline&&(e.playsinline=this.options_.playsinline),"undefined"!==typeof this.options_.rel&&(e.rel=this.options_.rel),"undefined"!==typeof this.options_.showinfo&&(e.showinfo=this.options_.showinfo),-1!==this.options_.source.src.indexOf("start=")){var n=this.options_.source.src.match(/start=([0-9]*)/);this.options_.start=parseInt(n[1])}if("undefined"!==typeof this.options_.start&&(e.start=this.options_.start),"undefined"!==typeof this.options_.theme&&(e.theme=this.options_.theme),"undefined"!==typeof this.options_.customVars){var r=this.options_.customVars;Object.keys(r).forEach(function(t){e[t]=r[t]})}this.activeVideoId=this.url?this.url.videoId:null,this.activeList=e.list;var i={videoId:this.activeVideoId,playerVars:e,events:{onReady:this.onPlayerReady.bind(this),onPlaybackQualityChange:this.onPlayerPlaybackQualityChange.bind(this),onPlaybackRateChange:this.onPlayerPlaybackRateChange.bind(this),onStateChange:this.onPlayerStateChange.bind(this),onVolumeChange:this.onPlayerVolumeChange.bind(this),onError:this.onPlayerError.bind(this)}};"undefined"!==typeof this.options_.enablePrivacyEnhancedMode&&this.options_.enablePrivacyEnhancedMode&&(i.host="https://www.youtube-nocookie.com"),this.ytPlayer=new YT.Player(this.options_.techId,i)},onPlayerReady:function(){this.options_.muted&&this.ytPlayer.mute(),this.ytPlayer.getAvailablePlaybackRates().length>1&&(this.featuresPlaybackRate=!0),this.playerReady_=!0,this.triggerReady(),this.playOnReady?this.play():this.cueOnReady&&(this.cueVideoById_(this.url.videoId),this.activeVideoId=this.url.videoId)},onPlayerPlaybackQualityChange:function(){},onPlayerPlaybackRateChange:function(){this.trigger("ratechange")},onPlayerStateChange:function(e){var t=e.data;if(t!==this.lastState&&!this.errorNumber)switch(this.lastState=t,t){case-1:this.trigger("loadstart"),this.trigger("loadedmetadata"),this.trigger("durationchange"),this.trigger("ratechange");break;case YT.PlayerState.ENDED:this.trigger("ended");break;case YT.PlayerState.PLAYING:this.trigger("timeupdate"),this.trigger("durationchange"),this.trigger("playing"),this.trigger("play"),this.isSeeking&&this.onSeeked();break;case YT.PlayerState.PAUSED:this.trigger("canplay"),this.isSeeking?this.onSeeked():this.trigger("pause");break;case YT.PlayerState.BUFFERING:this.player_.trigger("timeupdate"),this.player_.trigger("waiting")}},onPlayerVolumeChange:function(){this.trigger("volumechange")},onPlayerError:function(e){this.errorNumber=e.data,this.trigger("pause"),this.trigger("error")},error:function(){var e=1e3+this.errorNumber;switch(this.errorNumber){case 5:return{code:e,message:"Error while trying to play the video"};case 2:case 100:return{code:e,message:"Unable to find the video"};case 101:case 150:return{code:e,message:"Playback on other Websites has been disabled by the video owner."}}return{code:e,message:"YouTube unknown error ("+this.errorNumber+")"}},loadVideoById_:function(e){var t={videoId:e};this.options_.start&&(t.startSeconds=this.options_.start),this.options_.end&&(t.endSeconds=this.options_.end),this.ytPlayer.loadVideoById(t)},cueVideoById_:function(e){var t={videoId:e};this.options_.start&&(t.startSeconds=this.options_.start),this.options_.end&&(t.endSeconds=this.options_.end),this.ytPlayer.cueVideoById(t)},src:function(e){return e&&this.setSrc({src:e}),this.source},poster:function(){return t?null:this.poster_},setPoster:function(e){this.poster_=e},setSrc:function(e){e&&e.src&&(delete this.errorNumber,this.source=e,this.url=r.parseUrl(e.src),this.options_.poster||this.url.videoId&&(this.poster_="https://img.youtube.com/vi/"+this.url.videoId+"/0.jpg",this.trigger("posterchange"),this.checkHighResPoster()),this.options_.autoplay&&!t?this.isReady_?this.play():this.playOnReady=!0:this.activeVideoId!==this.url.videoId&&(this.isReady_?(this.cueVideoById_(this.url.videoId),this.activeVideoId=this.url.videoId):this.cueOnReady=!0))},autoplay:function(){return this.options_.autoplay},setAutoplay:function(e){this.options_.autoplay=e},loop:function(){return this.options_.loop},setLoop:function(e){this.options_.loop=e},play:function(){this.url&&this.url.videoId&&(this.wasPausedBeforeSeek=!1,this.isReady_?(this.url.listId&&(this.activeList===this.url.listId?this.ytPlayer.playVideo():(this.ytPlayer.loadPlaylist(this.url.listId),this.activeList=this.url.listId)),this.activeVideoId===this.url.videoId?this.ytPlayer.playVideo():(this.loadVideoById_(this.url.videoId),this.activeVideoId=this.url.videoId)):(this.trigger("waiting"),this.playOnReady=!0))},pause:function(){this.ytPlayer&&this.ytPlayer.pauseVideo()},paused:function(){return!this.ytPlayer||this.lastState!==YT.PlayerState.PLAYING&&this.lastState!==YT.PlayerState.BUFFERING},currentTime:function(){return this.ytPlayer?this.ytPlayer.getCurrentTime():0},setCurrentTime:function(e){this.lastState===YT.PlayerState.PAUSED&&(this.timeBeforeSeek=this.currentTime()),this.isSeeking||(this.wasPausedBeforeSeek=this.paused()),this.ytPlayer.seekTo(e,!0),this.trigger("timeupdate"),this.trigger("seeking"),this.isSeeking=!0,this.lastState===YT.PlayerState.PAUSED&&this.timeBeforeSeek!==e&&(clearInterval(this.checkSeekedInPauseInterval),this.checkSeekedInPauseInterval=setInterval(function(){this.lastState===YT.PlayerState.PAUSED&&this.isSeeking?this.currentTime()!==this.timeBeforeSeek&&(this.trigger("timeupdate"),this.onSeeked()):clearInterval(this.checkSeekedInPauseInterval)}.bind(this),250))},seeking:function(){return this.isSeeking},seekable:function(){return this.ytPlayer?e.createTimeRange(0,this.ytPlayer.getDuration()):e.createTimeRange()},onSeeked:function(){clearInterval(this.checkSeekedInPauseInterval),this.isSeeking=!1,this.wasPausedBeforeSeek&&this.pause(),this.trigger("seeked")},playbackRate:function(){return this.ytPlayer?this.ytPlayer.getPlaybackRate():1},setPlaybackRate:function(e){this.ytPlayer&&this.ytPlayer.setPlaybackRate(e)},duration:function(){return this.ytPlayer?this.ytPlayer.getDuration():0},currentSrc:function(){return this.source&&this.source.src},ended:function(){return!!this.ytPlayer&&this.lastState===YT.PlayerState.ENDED},volume:function(){return this.ytPlayer?this.ytPlayer.getVolume()/100:1},setVolume:function(e){this.ytPlayer&&this.ytPlayer.setVolume(100*e)},muted:function(){return!!this.ytPlayer&&this.ytPlayer.isMuted()},setMuted:function(e){this.ytPlayer&&(this.muted(!0),e?this.ytPlayer.mute():this.ytPlayer.unMute(),this.setTimeout(function(){this.trigger("volumechange")},50))},buffered:function(){if(!this.ytPlayer||!this.ytPlayer.getVideoLoadedFraction)return e.createTimeRange();var t=this.ytPlayer.getVideoLoadedFraction()*this.ytPlayer.getDuration();return e.createTimeRange(0,t)},preload:function(){},load:function(){},reset:function(){},networkState:function(){if(!this.ytPlayer)return 0;switch(this.ytPlayer.getPlayerState()){case-1:return 0;case 3:return 2;default:return 1}},readyState:function(){if(!this.ytPlayer)return 0;switch(this.ytPlayer.getPlayerState()){case-1:return 0;case 5:return 1;case 3:return 2;default:return 4}},supportsFullScreen:function(){return document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled},checkHighResPoster:function(){var e="https://img.youtube.com/vi/"+this.url.videoId+"/maxresdefault.jpg";try{var t=new Image;t.onload=function(){if("naturalHeight"in t){if(t.naturalHeight<=90||t.naturalWidth<=120)return}else if(t.height<=90||t.width<=120)return;this.poster_=e,this.trigger("posterchange")}.bind(this),t.onerror=function(){},t.src=e}catch(n){}}});function i(){YT.ready(function(){r.isApiReady=!0;for(var e=0;e<r.apiReadyQueue.length;++e)r.apiReadyQueue[e].initYTPlayer()})}function s(e,t){var n=!1,r=document.createElement("script"),i=document.getElementsByTagName("script")[0];i&&(i.parentNode.insertBefore(r,i),r.onload=function(){n||(n=!0,t())},r.onreadystatechange=function(){n||"complete"!==this.readyState&&"loaded"!==this.readyState||(n=!0,t())},r.src=e)}function o(){var e=".vjs-youtube .vjs-iframe-blocker { display: none; }.vjs-youtube.vjs-user-inactive .vjs-iframe-blocker { display: block; }.vjs-youtube .vjs-poster { background-size: cover; }.vjs-youtube-mobile .vjs-big-play-button { display: none; }",t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e)),t.appendChild(n)}r.isSupported=function(){return!0},r.canPlaySource=function(e){return r.canPlayType(e.type)},r.canPlayType=function(e){return"video/youtube"===e},r.parseUrl=function(e){var t={videoId:null},n=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,r=e.match(n);r&&11===r[2].length&&(t.videoId=r[2]);var i=/[?&]list=([^#\&\?]+)/;return(r=e.match(i))&&r[1]&&(t.listId=r[1]),t},r.apiReadyQueue=[],"undefined"!==typeof document&&(s("https://www.youtube.com/iframe_api",i),o());"undefined"!==typeof e.registerTech?e.registerTech("Youtube",r):e.registerComponent("Youtube",r)}(t.default||t)}()}({exports:{}});const Pf=e=>{const t=e.trim().split(":").reverse();let n=0;return t.forEach((e,t)=>{const r=parseFloat(e);isNaN(r)||e.includes("-")?n+=NaN:n+=r*Math.pow(60,t)}),n&&(n=Math.floor(n)),n},Mf=e=>{if(isNaN(e))return"NaN";const t=Math.floor(e),n=Math.floor(t/3600),r=Math.floor((t-3600*n)/60),i=kf(t-3600*n-60*r);return n>0?"".concat(n,":").concat(kf(r),":").concat(i):"".concat(r,":").concat(i)};var jf=(e=>(e[e.UPDATE_VALUE=0]="UPDATE_VALUE",e[e.VALIDATE_VALUE=1]="VALIDATE_VALUE",e[e.OPEN=2]="OPEN",e[e.CLOSE=3]="CLOSE",e))(jf||{});const Lf={value:"",isDisabled:!1,isActive:!1,isOpen:!1},Vf=(e,t)=>{switch(t.type){case 0:return Object(o.a)(Object(o.a)({},e),{},{value:t.payload});case 1:{const n=Mf(Pf(e.value));return void 0!==t.payload?Object(o.a)(Object(o.a)({},e),{},{value:n,isDisabled:!t.payload,isActive:t.payload}):Object(o.a)(Object(o.a)({},e),{},{value:n})}case 2:{const n=Mf(t.payload);return Object(o.a)(Object(o.a)({},e),{},{isOpen:!0,value:n,isDisabled:!1,isActive:!1})}case 3:return Object(o.a)(Object(o.a)({},e),{},{isOpen:!1});default:return e}},Bf=()=>K("svg",{transform:"scale(-1,1)",xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:K("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})}),Ff=()=>K("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:K("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})}),Uf={display:"flex",justifyContent:"center",alignItems:"center",columnGap:4,border:0,padding:"8px 16px",fontWeight:600,"& > svg":{width:"1rem",height:"1rem"}},zf=h.a.button(Object(o.a)({},Uf)),qf=h.a.a(Object(o.a)(Object(o.a)({},Uf),{},{textDecoration:"none"})),Gf=h.a.div({border:"1px solid ".concat(gp),borderRadius:2,display:"flex",justifyContent:"space-between",alignItems:"center",columnGap:24,"& > input":{flex:1,border:0,marginLeft:16},"& > .mzp-c-button":{padding:"8px 16px",fontWeight:600,border:0},"& > .mzp-c-button, & > .mzp-c-button:hover":{color:bp}}),Hf=h.a.div({display:"flex",alignItems:"center",columnGap:8,"& > label":{padding:0}}),Wf=h.a.input(e=>({border:0,borderBottomColor:e.disabled?"white":"black",borderBottomStyle:"solid",borderBottomWidth:"1.5px",width:64})),Kf=Object(h.a)(w.a)({"i.close.icon":{top:0,right:0,color:"black"},"i.close::before":{content:'"\u2716"'}}),Qf=e=>{let{sessionIndex:t,getCurrentTime:n}=e;const r=Object(a.useRef)(null),i=Object(a.useRef)(null),s=Object(a.useRef)(null),o=Object(l.h)(),[c,u]=Object(a.useReducer)(Vf,Lf),h=Object(a.useCallback)(()=>{const e=n();u({type:jf.OPEN,payload:e})},[n]),d=Object(a.useCallback)(()=>{const e=Pf(c.value),n="".concat(document.location.href.split("#")[0],"#").concat(o.pathname,"?s=").concat(t);return c.isActive&&e?"".concat(n,"&t=").concat(e):"".concat(n)},[c.value,c.isActive,t,o]);return Q(Y,{children:[Q(Kf,{closeIcon:!0,trigger:Q(zf,{className:"mzp-c-button mzp-t-secondary",onClick:h,children:[K(Bf,{}),"SHARE"]}),open:c.isOpen,onClose:()=>{u({type:jf.CLOSE})},mountNode:r.current,size:"small",children:[K(w.a.Header,{children:"Share"}),Q(w.a.Content,{children:[Q(Gf,{children:[K("input",{readOnly:!0,"aria-readonly":!0,ref:i,value:d()}),K("button",{className:"mzp-c-button mzp-t-secondary",onClick:async()=>{var e;null==(e=i.current)||e.select(),navigator.clipboard?await navigator.clipboard.writeText(d()):document.execCommand("copy")},children:"COPY"})]}),K("br",{}),Q(Hf,{children:[K("input",{id:"share-with-time-point",type:"checkbox",checked:c.isActive,onChange:e=>{u({type:jf.VALIDATE_VALUE,payload:e.target.checked})}}),K("label",{htmlFor:"share-with-time-point",children:"Start at"}),K(Wf,{disabled:c.isDisabled,value:c.value,onChange:e=>{u({type:jf.UPDATE_VALUE,payload:e.target.value})},onBlur:()=>{u({type:jf.VALIDATE_VALUE})},onKeyUp:e=>{"Enter"===e.key&&u({type:jf.VALIDATE_VALUE})},ref:s})]})]})]}),K("div",{ref:r})]})};var Yf=(e=>(e.mp4="mp4",e.webm="webm",e.youtube="youtube",e))(Yf||{});function Jf(e){const t=function(e){let t;if(e.match(/youtu?.be/))t=Yf.youtube;else{const n=e.match(new RegExp("(".concat(Yf.webm,"|").concat(Yf.mp4,")$")));n&&(t=n[0])}return t}(e),n={src:e};return t&&(n.type="video/".concat(t)),n}const Xf=e=>{let{sessionIndex:t,uri:n,componentRef:r,initialSeconds:i}=e;const{language:s}=te(),o=Object(a.useRef)(null),c=Object(a.useRef)();Object(a.useImperativeHandle)(r,()=>({seekTo:e=>{var t,n,r;null==(t=c.current)||t.currentTime(e),(null==(n=c.current)?void 0:n.paused())&&(null==(r=c.current)||r.play())},pause:()=>{var e;return null==(e=c.current)?void 0:e.pause()}}));const l=Object(a.useCallback)(()=>c.current?c.current.currentTime():0,[]),u=Object(a.useMemo)(()=>function(e){if(!e)return;const t=String(e).trim();if(!t)return;let n;try{n=new URL(t)}catch(o){return}const r=n.pathname.split("/").filter(Boolean),i=e=>{const t=r.indexOf(e);return t>=0&&r[t+1]?r[t+1]:""},s=i("details")||i("download")||i("items");return s?"https://archive.org/details/".concat(s):void 0}(n),[n]),h=()=>Q(Y,{children:[K("div",{style:{display:"flex",flexDirection:"row-reverse",columnGap:8,marginBottom:4},children:[u&&Q(qf,{className:"mzp-c-button mzp-t-secondary",href:u,target:"_blank",rel:"noopener noreferrer",children:[K(Ff,{}),"SOURCE"]}),K(Qf,{sessionIndex:t,getCurrentTime:l})]}),K("div",{"data-vjs-player":!0,children:K("video",{ref:o,className:"video-js vjs-big-play-centered vjs-theme-cdp"})})]});return Object(a.useEffect)(()=>{const e=o.current;let t;return e&&(t=Object(R.a)(e,{autoplay:!1,controls:!0,controlBar:{currentTimeDisplay:!0,timeDivider:!0,durationDisplay:!0,customControlSpacer:!0,remainingTimeDisplay:!1},preload:i?"auto":"metadata",aspectRatio:"16:9",fluid:!0,language:s,playbackRates:[2,1.5,1,.75,.5],responsive:!0,techOrder:["youtube","html5"],sources:[Jf(n)],userActions:{hotkeys:e=>{var t,n,r,i,s,o,a,l,u,h,d,m;75===e.which||32===e.which?(null==(t=c.current)?void 0:t.paused())?null==(n=c.current)||n.play():null==(r=c.current)||r.pause():77===e.which?null==(s=c.current)||s.muted(!(null==(i=c.current)?void 0:i.muted())):70===e.which?(null==(o=c.current)?void 0:o.isFullscreen())?null==(a=c.current)||a.exitFullscreen():null==(l=c.current)||l.requestFullscreen():37===e.which?null==(h=c.current)||h.currentTime((null==(u=c.current)?void 0:u.currentTime())-10):39===e.which&&(null==(m=c.current)||m.currentTime((null==(d=c.current)?void 0:d.currentTime())+10))}}},function(){i&&i>0&&this.currentTime(i),c.current=this})),()=>{t&&t.dispose()}},[n,i,s]),K(h,{})};var Zf=Object(h.a)(E.a)(e=>({"& > .ui.tab":{margin:0,border:0,padding:e.padding},["@media (min-width:".concat(oe,")")]:{"& > .ui.menu > a.item":{fontSize:zp}},["@media (max-width:".concat(e.breakpoint,")")]:{"& > .ui.menu":{flexDirection:"column"},"& > .ui.secondary.pointing.menu > a.item":{alignSelf:"flex-start",borderBottomStyle:"none"},"& > .ui.secondary.pointing.menu > a.active.item":{borderLeft:"2px solid"}}}));const $f=e=>{let{eventVideoRefs:t,sessions:n,currentSession:r,initialSeconds:i,setCurrentSession:s}=e;const{language:o}=te(),[,c]=Object(a.useState)(""),l=Object(a.useRef)(n.map((e,n)=>({menuItem:"".concat(re.session," ").concat(n+1),pane:{key:"session_index_".concat(n+1),content:K(Xf,{sessionIndex:n,initialSeconds:n===r?i:0,uri:e.video_uri,componentRef:t[n]})}})));Object(a.useEffect)(()=>{for(let e=0;e<l.current.length;e++)l.current[e].menuItem="".concat(re.session," ").concat(e+1);c(o)},[o]);const u=n.length>3?se:ie;return K(Zf,{padding:"0px",breakpoint:u,menu:{secondary:!0,pointing:!0},panes:l.current,renderActiveOnly:!1,activeIndex:r,onTabChange:(e,n)=>s(e=>{var r;return null==(r=t[e].current)||r.pause(),n.activeIndex})})};var eg=c.a.memo($f);const tg=h.a.div({maxHeight:"100vh",overflowY:"auto"}),ng=e=>{let{sentences:t,transcriptItemsRefs:n,jumpToVideoClip:r}=e;return K(tg,{children:t.map((e,t)=>{return K(Tf,{sessionIndex:e.session_index,speakerName:e.speaker_name,text:e.text,startTime:xf(e.start_time),handleJumpToVideoClip:(i=e.session_index,s=e.start_time,()=>r(i,s)),searchQuery:"",speakerId:e.speaker_id,speakerPictureSrc:e.speaker_pictureSrc,componentRef:n[t]},e.index);var i,s})})},rg=()=>K("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:K("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18 12H6"})}),ig=()=>K("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:K("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),sg=h.a.summary({color:bp,display:"flex",alignItems:"center","&::before, &::marker":{content:"none"},"& svg":{marginLeft:4,width:"1rem",height:"1rem"}}),og=e=>{let{documents:t}=e;const[n,r]=Object(a.useState)(!1);return t&&0!==t.length?Q("details",{onToggle:()=>r(e=>!e),children:[Q(sg,{children:[re.see_documents,K(n?rg:ig,{})]}),K("ul",{className:"mzp-u-list-styled",children:t.map(e=>K("li",{children:K("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",children:e.label})},e.label))})]}):null},ag=h.a.li({"& > div:first-of-type":{fontWeight:600},"& > a":{display:"flex",alignItems:"center"},"& > a > svg":{width:"1rem",height:"1rem",transform:"rotate(-90deg)"}}),cg=e=>{let{minutesItems:t}=e;return 0===t.length?K("p",{children:re.no_minutes_recorded}):K("ol",{className:"mzp-u-list-styled",children:t.map(e=>Q(ag,{children:[K("div",{children:e.name}),e.matter_ref&&Q(u.b,{to:"/matters/".concat(e.matter_ref),children:[re.go_to_matter_details," ",K(Tp,{})]}),e.description&&K("div",{children:e.description}),K(og,{documents:e.documents})]},e.name))})},lg=()=>K("svg",{className:"cdp-acceptance-green",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:K("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),ug=()=>K("svg",{xmlns:"http://www.w3.org/2000/svg",className:"cdp-rejected-red",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:K("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),hg=()=>K("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",className:"cdp-in-progress_orange",children:K("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 12h.01M12 12h.01M16 12h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),dg=()=>K("svg",{className:"cdp-light-purple",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:K("g",{id:"Group 1",children:Q("g",{id:"Frame 1",children:[K("circle",{id:"Ellipse 1",cx:"12",cy:"12",r:"9",stroke:"currentColor",strokeWidth:"2"}),K("circle",{id:"Ellipse 2",cx:"12",cy:"12",r:"4",stroke:"currentColor",strokeWidth:"2"}),K("path",{id:"Line 1",d:"M8.00001 16L16 7.99998",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})})});var mg=(e=>(e.ALTERNATE="Alternate",e.CHAIR="Chair",e.COUNCILMEMBER="Councilmember",e.MEMBER="Member",e.COUNCILPRESIDENT="Council President",e.VICE_CHAIR="Vice Chair",e.SUPERVISOR="Supervisor",e))(mg||{}),pg=(e=>(e.ABSTAIN_APPROVE="Abstain (Approve)",e.ABSTAIN_NON_VOTING="Abstain (Non-Voting)",e.ABSTAIN_REJECT="Abstain (Reject)",e.ABSENT_APPROVE="Absent (Approve)",e.ABSENT_NON_VOTING="Absent (Non-Voting)",e.ABSENT_REJECT="Absent (Reject)",e.APPROVE="Approve",e.REJECT="Reject",e))(pg||{}),fg=(e=>(e.ADOPTED="Adopted",e.IN_PROGRESS="In Progress",e.REJECTED="Rejected",e))(fg||{}),gg=(e=>(e.FAILED="Failed",e.PASSED="Passed",e))(gg||{});const yg=e=>{let{result:t,style:n}=e,r=K("div",{});switch(t){case gg.PASSED:case fg.ADOPTED:case pg.ABSENT_APPROVE:case pg.ABSTAIN_APPROVE:case pg.APPROVE:r=K(lg,{});break;case gg.FAILED:case fg.REJECTED:case pg.ABSENT_REJECT:case pg.ABSTAIN_REJECT:case pg.REJECT:r=K(ug,{});break;case pg.ABSENT_NON_VOTING:case pg.ABSTAIN_NON_VOTING:r=K(dg,{});break;case fg.IN_PROGRESS:r=K(hg,{})}const i=Object(I.useMediaQuery)({query:"(max-width: ".concat(oe,")")}),s=re[t.toLowerCase().replace(/[()]/g,"").replace(/[ -]/g,"_")];return n||(n={display:"flex",flex:1,alignItems:"center"}),i?K("div",{style:{height:24,width:24},children:r}):Q("div",{style:n,children:[K("div",{style:{height:24,width:24},children:r}),K("div",{children:K("p",{className:"mzp-c-card-desc",style:{marginLeft:8},children:s})})]})};yg.defaultProps={result:fg.IN_PROGRESS};const vg=e=>{let{index:t}=e;return K("div",{style:{display:"flex",flex:1,flexDirection:"column",padding:16,borderBottom:"1px solid #000000",backgroundColor:t%2===0?"rgb(236,236,236)":"white"},children:K("p",{className:"mzp-c-card-desc",children:0===t?"No results found.":"Record missing."})})},bg=e=>{let{index:t,children:n,columnNames:r,columnDistribution:i,onClick:s}=e;const o=t%2===0?wp.COLORS.EVEN_CELL:wp.COLORS.ODD_CELL,a=Object(I.useMediaQuery)({query:"(max-width: ".concat(oe,")")});return n&&0!==n.length?K("div",a?{style:{display:"flex",flex:1,flexDirection:"column",padding:16,borderBottom:"1px solid #000000",backgroundColor:o},children:null==n?void 0:n.map((e,t)=>{const n=r?r[t]:"";return Q("div",{style:{display:"flex",justifyContent:"space-between",flex:1,alignItems:"flex-start"},children:[K("p",{style:{flex:1,fontWeight:"bold",paddingRight:8},className:"mzp-c-card-desc",children:n}),e]},t)})}:{style:{display:"flex",flex:1,backgroundColor:o,flexDirection:"row",padding:16},onClick:s,children:null==n?void 0:n.map((e,t)=>{const n=i?i[t]:"0%";return K("div",{style:{width:n},children:e},t)})}):K(vg,{index:t})},_g=h.a.p(e=>({overflow:"hidden","text-overflow":"ellipsis",display:"-webkit-box","-webkit-line-clamp":e.minified?"".concat(e.linesToShow):"none","line-clamp":e.minified?"".concat(e.linesToShow):"none","-webkit-box-orient":"vertical"}));function wg(e,t){const[n,r]=Object(a.useState)(!1);let i=0,s=0,o=0;e.forEach(e=>{[pg.ABSENT_APPROVE,pg.ABSTAIN_APPROVE,pg.APPROVE].includes(e.decision)&&i++,[pg.ABSENT_REJECT,pg.ABSTAIN_REJECT,pg.REJECT].includes(e.decision)&&s++,[pg.ABSENT_NON_VOTING,pg.ABSTAIN_NON_VOTING].includes(e.decision)&&o++});const l=re.number_approved.replace("{number}","".concat(i)),h=re.number_rejected.replace("{number}","".concat(s)),d=re.number_non_voting.replace("{number}","".concat(o));return K(c.a.Fragment,{children:t?Q("div",{style:{display:"flex",flexDirection:"column"},children:[K("p",{children:l}),K("p",{children:h}),K("p",{children:d})]}):Q(Y,{children:[K("p",{children:"".concat(l," ").concat(_p," ").concat(h," ").concat(_p," ").concat(d)}),e.map((e,t)=>{if(!n&&t>4)return;const r="/people/".concat(e.personId);return Q("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[K(u.b,{style:{flex:1},to:r,children:e.name}),K(yg,{result:e.decision})]},"individual-vote-".concat(t,"-").concat(e.id))}),e.length>5&&K("button",{className:"mzp-c-button mzp-t-product mzp-t-secondary mzp-t-sm",style:{marginTop:10},onClick:()=>{r(!n)},children:n?"Show Less":"Show All Votes for Matter "})]})})}const Eg=e=>{let{index:t,legislationLink:n,legislationName:r,legislationDescription:i,councilDecision:s,votes:o,columnNames:c,columnDistribution:l}=e;const[h,d]=Object(a.useState)(!0),m=Object(I.useMediaQuery)({query:"(max-width: ".concat(oe,")")});return Q(bg,{index:t,columnNames:c,columnDistribution:l,children:[Q("div",{children:[K(u.b,{to:n,children:K("p",{className:"mzp-c-card-desc",style:{fontWeight:600,marginBottom:0},children:r})}),!m&&K(_g,{onClick:()=>{d(!h)},minified:h,linesToShow:3,children:i})]}),K(yg,{result:s}),wg(o,m)]},"meeting-table-row-".concat(t))},Sg=h.a.div({padding:8,fontSize:Up,fontWeight:600}),Ig=e=>{let{columnNames:t,columnDistribution:n}=e;return Object(I.useMediaQuery)({query:"(max-width: ".concat(oe,")")})?null:K("div",{style:{display:"flex",flex:1,flexDirection:"row"},children:null==t?void 0:t.map((e,t)=>{const r=n[t]||0;return K("div",{style:{width:r},children:K(Sg,{children:e})},e)})})};const Cg=e=>{let{data:t,renderRow:n,columnDistribution:r,columnNames:i}=e;const s=!t||!t.length||0===t.length;return Q(c.a.Fragment,{children:[K(Ig,{columnDistribution:r,columnNames:i}),s&&(o=0,K(vg,{index:o},"empty-table-row-".concat(o))),t.map((e,t)=>n(e,t))]});var o};const Tg=e=>{let{votesPage:t}=e;const n=[re.legislation,re.council_decision,re.votes],r=["35%","25%","40%"];return K(Y,{children:K(Cg,{data:t,columnDistribution:r,columnNames:n,renderRow:function(e,t){if(!e.matter||!e.votes)return function(e){return K(vg,{index:e},"empty-table-row-".concat(e))}(t);const i=e.matter.name,s=e.matter.description,o=e.council_decision,a="/matters/".concat(e.matter.id);return K(Eg,{index:t,legislationName:i,legislationDescription:s,councilDecision:o,legislationLink:a,votes:e.votes,columnDistribution:r,columnNames:n},"meeting-voting-table-row-".concat(t))}})})},kg=e=>{let{currentInfoTab:t,setCurrentInfoTab:n,sentences:r,transcriptItemsRefs:i,eventMinutesItems:s,votes:o,jumpToVideoClip:c}=e;const{language:l}=te(),u=Object(a.useMemo)(()=>s.map(e=>{let{minutes_item:t,files:n}=e;return{name:null==t?void 0:t.name,description:null==t?void 0:t.description,matter_ref:null==t?void 0:t.matter_ref,documents:n&&n.length>0?n.map(e=>{let{name:t,uri:n}=e;return{label:t,url:n}}):void 0}}),[s]),h=Object(a.useMemo)(()=>o.reduce((e,t)=>(Object.keys(e).includes(t.event_minutes_item_ref)||(e[t.event_minutes_item_ref]=[]),e[t.event_minutes_item_ref].push(t),e),{}),[o]),d=Object(a.useMemo)(()=>s.map(e=>h[e.id]||[]),[h,s]),m=Object(a.useMemo)(()=>{const e=[];return s.forEach((t,n)=>{let{minutes_item:r,decision:i}=t;const s=d[n];s&&s.length>0&&e.push({matter:{name:null==r?void 0:r.name,description:null==r?void 0:r.description,id:null==r?void 0:r.matter_ref},council_decision:i,votes:s.map(e=>{let{person:t,decision:n,id:r}=e;return{personId:null==t?void 0:t.id,name:null==t?void 0:t.name,decision:n,id:r}})})}),e},[s,d]),p=Object(a.useMemo)(()=>[{menuItem:re.minutes,pane:{key:"agenda",content:K(cg,{minutesItems:u})}},{menuItem:re.transcript,pane:{key:"transcript",content:K(ff,{data:"transcript",isLoading:r.isLoading,error:r.error,notFound:!r.data||0===r.data.length,children:r.data&&K(ng,{sentences:r.data,transcriptItemsRefs:i,jumpToVideoClip:c})})}},{menuItem:re.votes,pane:{key:"votes",content:K(Tg,{votesPage:m})}}],[u,r,i,c,m,l]);return K(Zf,{padding:"16px",menu:{secondary:!0,pointing:!0},panes:p,activeIndex:t,onTabChange:(e,t)=>n(t.activeIndex),renderActiveOnly:!1})};var xg=c.a.memo(kg);const Ng=h.a.div({display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",rowGap:"32px","& > *":{width:"100%"}}),Ag=h.a.div({"& > h1":{margin:0}}),Rg=h.a.div({position:"sticky",top:0,zIndex:2,backgroundColor:"white",["@media (min-width:".concat(oe,")")]:{position:"static"},["@media (min-aspect-ratio:5/4), (min-width:".concat(ae,")")]:{width:"50%"}}),Dg=h.a.div({["@media (min-aspect-ratio:5/4), (min-width:".concat(ae,")")]:{width:"47%"}}),Og=e=>{let{event:t,sessions:n,sentences:r,eventMinutesItems:i,votes:s,initialSession:o,initialSeconds:c,searchQuery:l}=e;var u,h,d,m,p;const{municipality:f}=Z(),{language:g}=te();ne("".concat(null==(u=t.body)?void 0:u.name).concat((null==(h=t.body)?void 0:h.name)&&t.event_datetime&&" -- ").concat(null==(d=t.event_datetime)?void 0:d.toLocaleDateString(g,{timeZone:f.timeZone})));const[y,v]=Object(a.useState)(o),[b,_]=Object(a.useState)(0),w=Object(a.useRef)(n.map(()=>Object(a.createRef)())),E=Object(a.useCallback)((e,t)=>{var n;v(t=>{var n;return t!==e&&(null==(n=w.current[t].current)||n.pause()),e}),null==(n=w.current[e].current)||n.seekTo(t)},[w]),S=Object(a.useMemo)(()=>(r.data||[]).map(()=>Object(a.createRef)()),[r.data]),[I,C]=Object(a.useState)(),T=Object(a.useCallback)(e=>{var t;1!==b?(_(1),C(e)):null==(t=S[e].current)||t.scrollIntoView()},[S,b]);return Object(a.useEffect)(()=>{var e;1===b&&void 0!==I&&(null==(e=S[I].current)||e.scrollIntoView(),C(void 0))},[b,I,S]),Q(Ng,{children:[Q(Ag,{children:[K("h1",{className:"mzp-u-title-sm",children:null==(m=t.body)?void 0:m.name}),K("p",{className:"mzp-c-card-desc",children:null==(p=t.event_datetime)?void 0:p.toLocaleString(g,{timeZone:f.timeZone,timeZoneName:"short",month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})})]}),K(Rg,{children:K(eg,{eventVideoRefs:w.current,sessions:n,currentSession:y,initialSeconds:c,setCurrentSession:v})}),K(Dg,{children:K(Of,{searchQuery:l||"",sentences:r,jumpToVideoClip:E,jumpToTranscript:T})}),K("div",{children:K(xg,{currentInfoTab:b,setCurrentInfoTab:_,sentences:r,transcriptItemsRefs:S,eventMinutesItems:i,votes:s,jumpToVideoClip:E})})]})};var Pg={Play:"Reproducir","Play Video":"Reproducir V\xeddeo",Pause:"Pausa","Current Time":"Tiempo reproducido",Duration:"Duraci\xf3n total","Remaining Time":"Tiempo restante","Stream Type":"Tipo de secuencia",LIVE:"DIRECTO",Loaded:"Cargado",Progress:"Progreso",Fullscreen:"Pantalla completa","Non-Fullscreen":"Pantalla no completa",Mute:"Silenciar",Unmute:"No silenciado","Playback Rate":"Velocidad de reproducci\xf3n",Subtitles:"Subt\xedtulos","subtitles off":"Subt\xedtulos desactivados",Captions:"Subt\xedtulos especiales","captions off":"Subt\xedtulos especiales desactivados",Chapters:"Cap\xedtulos","You aborted the media playback":"Ha interrumpido la reproducci\xf3n del v\xeddeo.","A network error caused the media download to fail part-way.":"Un error de red ha interrumpido la descarga del v\xeddeo.","The media could not be loaded, either because the server or network failed or because the format is not supported.":"No se ha podido cargar el v\xeddeo debido a un fallo de red o del servidor o porque el formato es incompatible.","The media playback was aborted due to a corruption problem or because the media used features your browser did not support.":"La reproducci\xf3n de v\xeddeo se ha interrumpido por un problema de corrupci\xf3n de datos o porque el v\xeddeo precisa funciones que su navegador no ofrece.","No compatible source was found for this media.":"No se ha encontrado ninguna fuente compatible con este v\xeddeo.","Audio Player":"Reproductor de audio","Video Player":"Reproductor de video",Replay:"Volver a reproducir","Seek to live, currently behind live":"Buscar en vivo, actualmente demorado con respecto a la transmisi\xf3n en vivo","Seek to live, currently playing live":"Buscar en vivo, actualmente reproduciendo en vivo","Progress Bar":"Barra de progreso","progress bar timing: currentTime={1} duration={2}":"{1} de {2}",Descriptions:"Descripciones","descriptions off":"descripciones desactivadas","Audio Track":"Pista de audio","Volume Level":"Nivel de volumen","The media is encrypted and we do not have the keys to decrypt it.":"El material audiovisual est\xe1 cifrado y no tenemos las claves para descifrarlo.",Close:"Cerrar","Modal Window":"Ventana modal","This is a modal window":"Esta es una ventana modal","This modal can be closed by pressing the Escape key or activating the close button.":"Esta ventana modal puede cerrarse presionando la tecla Escape o activando el bot\xf3n de cierre.",", opens captions settings dialog":", abre el di\xe1logo de configuraci\xf3n de leyendas",", opens subtitles settings dialog":", abre el di\xe1logo de configuraci\xf3n de subt\xedtulos",", selected":", seleccionado","Close Modal Dialog":"Cierra cuadro de di\xe1logo modal",", opens descriptions settings dialog":", abre el di\xe1logo de configuraci\xf3n de las descripciones","captions settings":"configuraci\xf3n de leyendas","subtitles settings":"configuraci\xf3n de subt\xedtulos","descriptions settings":"configuraci\xf3n de descripciones",Text:"Texto",White:"Blanco",Black:"Negro",Red:"Rojo",Green:"Verde",Blue:"Azul",Yellow:"Amarillo",Magenta:"Magenta",Cyan:"Cian",Background:"Fondo",Window:"Ventana",Transparent:"Transparente","Semi-Transparent":"Semitransparente",Opaque:"Opaca","Font Size":"Tama\xf1o de fuente","Text Edge Style":"Estilo de borde del texto",None:"Ninguno",Raised:"En relieve",Depressed:"Hundido",Uniform:"Uniforme",Dropshadow:"Sombra paralela","Font Family":"Familia de fuente","Proportional Sans-Serif":"Sans-Serif proporcional","Monospace Sans-Serif":"Sans-Serif monoespacio","Proportional Serif":"Serif proporcional","Monospace Serif":"Serif monoespacio",Casual:"Informal",Script:"Cursiva","Small Caps":"Min\xfasculas",Reset:"Restablecer","restore all settings to the default values":"restablece todas las configuraciones a los valores predeterminados",Done:"Listo","Caption Settings Dialog":"Di\xe1logo de configuraci\xf3n de leyendas","Beginning of dialog window. Escape will cancel and close the window.":"Comienzo de la ventana de di\xe1logo. La tecla Escape cancelar\xe1 la operaci\xf3n y cerrar\xe1 la ventana.","End of dialog window.":"Final de la ventana de di\xe1logo.","{1} is loading.":"{1} se est\xe1 cargando.","Exit Picture-in-Picture":"Salir de imagen sobre imagen","Picture-in-Picture":"Imagen sobre imagen"};var Mg={Play:"Wiedergabe",Pause:"Pause",Replay:"Erneut abspielen","Current Time":"Aktueller Zeitpunkt",Duration:"Dauer","Remaining Time":"Verbleibende Zeit","Stream Type":"Streamtyp",LIVE:"LIVE",Loaded:"Geladen",Progress:"Status",Fullscreen:"Vollbild","Non-Fullscreen":"Vollbildmodus beenden",Mute:"Ton aus",Unmute:"Ton ein","Playback Rate":"Wiedergabegeschwindigkeit",Subtitles:"Untertitel","subtitles off":"Untertitel aus",Captions:"Untertitel","captions off":"Untertitel aus",Chapters:"Kapitel","You aborted the media playback":"Sie haben die Videowiedergabe abgebrochen.","A network error caused the media download to fail part-way.":"Der Videodownload ist aufgrund eines Netzwerkfehlers fehlgeschlagen.","The media could not be loaded, either because the server or network failed or because the format is not supported.":"Das Video konnte nicht geladen werden, da entweder ein Server- oder Netzwerkfehler auftrat oder das Format nicht unterst\xfctzt wird.","The media playback was aborted due to a corruption problem or because the media used features your browser did not support.":"Die Videowiedergabe wurde entweder wegen eines Problems mit einem besch\xe4digten Video oder wegen verwendeten Funktionen, die vom Browser nicht unterst\xfctzt werden, abgebrochen.","No compatible source was found for this media.":"F\xfcr dieses Video wurde keine kompatible Quelle gefunden.","Play Video":"Video abspielen",Close:"Schlie\xdfen","Modal Window":"Modales Fenster","This is a modal window":"Dies ist ein modales Fenster","This modal can be closed by pressing the Escape key or activating the close button.":'Durch Dr\xfccken der Esc-Taste bzw. Bet\xe4tigung der Schaltfl\xe4che "Schlie\xdfen" wird dieses modale Fenster geschlossen.',", opens captions settings dialog":", \xf6ffnet Einstellungen f\xfcr Untertitel",", opens subtitles settings dialog":", \xf6ffnet Einstellungen f\xfcr Untertitel",", selected":", ausgew\xe4hlt","captions settings":"Untertiteleinstellungen","subtitles settings":"Untertiteleinstellungen","descriptions settings":"Einstellungen f\xfcr Beschreibungen","Close Modal Dialog":"Modales Fenster schlie\xdfen",Descriptions:"Beschreibungen","descriptions off":"Beschreibungen aus","The media is encrypted and we do not have the keys to decrypt it.":"Die Entschl\xfcsselungsschl\xfcssel f\xfcr den verschl\xfcsselten Medieninhalt sind nicht verf\xfcgbar.",", opens descriptions settings dialog":", \xf6ffnet Einstellungen f\xfcr Beschreibungen","Audio Track":"Tonspur",Text:"Schrift",White:"Wei\xdf",Black:"Schwarz",Red:"Rot",Green:"Gr\xfcn",Blue:"Blau",Yellow:"Gelb",Magenta:"Magenta",Cyan:"T\xfcrkis",Background:"Hintergrund",Window:"Fenster",Transparent:"Durchsichtig","Semi-Transparent":"Halbdurchsichtig",Opaque:"Undurchsichtig","Font Size":"Schriftgr\xf6\xdfe","Text Edge Style":"Textkantenstil",None:"Kein",Raised:"Erhoben",Depressed:"Gedr\xfcckt",Uniform:"Uniform",Dropshadow:"Schlagschatten","Font Family":"Schriftfamilie","Proportional Sans-Serif":"Proportionale Sans-Serif","Monospace Sans-Serif":"Monospace Sans-Serif","Proportional Serif":"Proportionale Serif","Monospace Serif":"Monospace Serif",Casual:"Zwanglos",Script:"Schreibschrift","Small Caps":"Small-Caps",Reset:"Zur\xfccksetzen","restore all settings to the default values":"Alle Einstellungen auf die Standardwerte zur\xfccksetzen",Done:"Fertig","Caption Settings Dialog":"Einstellungsdialog f\xfcr Untertitel","Beginning of dialog window. Escape will cancel and close the window.":"Anfang des Dialogfensters. Esc bricht ab und schlie\xdft das Fenster.","End of dialog window.":"Ende des Dialogfensters.","Audio Player":"Audio-Player","Video Player":"Video-Player","Progress Bar":"Fortschrittsbalken","progress bar timing: currentTime={1} duration={2}":"{1} von {2}","Volume Level":"Lautst\xe4rke","{1} is loading.":"{1} wird geladen.","Seek to live, currently behind live":"Zur Live-\xdcbertragung wechseln. Aktuell wird es nicht live abgespielt.","Seek to live, currently playing live":"Zur Live-\xdcbertragung wechseln. Es wird aktuell live abgespielt.","Exit Picture-in-Picture":"Bild-im-Bild-Modus beenden","Picture-in-Picture":"Bild-im-Bild-Modus"};R.a.addLanguage("es",Pg),R.a.addLanguage("de",Mg);const jg=()=>{const{id:e}=Object(l.i)(),{firebaseConfig:t}=Z(),n=Object(l.h)(),r=Object(a.useMemo)(()=>n.state?n.state.query:"",[n.state]),[i,s]=Object(a.useMemo)(()=>{const{s:e,t:t}=v.a.parse(n.search);return[e,t].map(e=>{if(null!==e&&"string"===typeof e){const t=parseFloat(e);return isNaN(t)||t<0?0:Math.floor(t)}return 0})},[n.search]),c=Object(a.useCallback)(async()=>{const n=new ap(t),r=await n.getEventById(e);return Promise.resolve(r)},[t,e]),{state:u}=ep(Object(o.a)({},Zm),c),h=Object(a.useCallback)(async()=>{const n=new ef(t),r=await n.getSessionsByEventId(e);return Promise.resolve(r)},[t,e]),{state:d}=ep(Object(o.a)({},Zm),h),m=Object(a.useCallback)(async()=>{const n=new af(t),r=new lf(t),i=await n.getEventMinutesItemsByEventId(e),s=await Promise.all(i.map(e=>{let{id:t}=e;return r.getEventMinutesItemFilesByEventMinutesItemId(t)}));return Promise.resolve(i.map((e,t)=>Object(o.a)(Object(o.a)({},e),{},{files:s[t]})))},[t,e]),{state:p}=ep(Object(o.a)({},Zm),m),f=Object(a.useCallback)(async()=>{const n=new df(t),r=await n.getVotesByEventId(e);return Promise.resolve(r)},[t,e]),{state:g}=ep(Object(o.a)({},Zm),f),y=Object(a.useCallback)(async()=>{const e=new nf(t),n=new pf(t);if(d.data){const t=await Promise.all(d.data.map(t=>{let{id:n}=t;return e.getTranscriptBySessionId(n)})),r=await Promise.all(t.map(e=>{var t;return console.log("Transcript JSON Data",e[0]),n.download(null==(t=e[0].file)?void 0:t.uri)})),i=[];return r.forEach((e,t)=>{var n;null==(n=null==e?void 0:e.sentences)||n.forEach(e=>{i.push({session_index:t,index:i.length,start_time:e.start_time,end_time:e.end_time,text:e.text,speaker_name:e.speaker_name,speaker_index:e.speaker_index,speaker_id:void 0,speaker_pictureSrc:void 0})})}),Promise.resolve(i)}return Promise.resolve([])},[t,d.data]),{state:b,dispatch:_}=ep(Object(o.a)(Object(o.a)({},Zm),{},{hasFetchRequest:!1}),y);Object(a.useEffect)(()=>{d.data&&_({type:$m.FETCH})},[d.data,_]);const w=Object(a.useMemo)(()=>u.isLoading||d.isLoading||p.isLoading||g.isLoading,[u.isLoading,d.isLoading,p.isLoading,g.isLoading]),E=Object(a.useMemo)(()=>{if(u.data&&d.data&&p.data&&g.data)return{event:u.data,sessions:d.data,eventMinutesItems:p.data,votes:g.data}},[u.data,d.data,p.data,g.data]),S=Object(a.useMemo)(()=>{const e=[u.error,d.error,p.error,g.error].map(e=>(null==e?void 0:e.message)||"").filter(e=>e.length>0);return e.length>0?new Error(e.join("\n")):null},[u.error,d.error,p.error,g.error]);return K(Xm,{isLoading:w,error:S,children:E&&K(Og,Object(o.a)(Object(o.a)({},E),{},{sentences:b,searchQuery:r,initialSession:i>0&&i<E.sessions.length?i:0,initialSeconds:s}))})};var Lg=(e=>(e.FAILURE="FAILURE",e.SUCCESS="SUCCESS",e.FETCH_MODELS="FETCH_MODELS",e))(Lg||{});function Vg(e,t){const[n,r]=Object(a.useReducer)((e,t)=>{switch(t.type){case"SUCCESS":return Object(o.a)(Object(o.a)({},e),{},{models:e.fetchModels?t.payload:[...e.models,...t.payload],fetchModels:!1,showMoreModels:!1,hasMoreModels:t.payload.length===e.batchSize});case"FAILURE":return Object(o.a)(Object(o.a)({},e),{},{error:t.payload,fetchModels:!1,showMoreModels:!1});case"FETCH_MODELS":return Object(o.a)(Object(o.a)({},e),{},{error:null,fetchModels:t.payload,showMoreModels:!t.payload});default:return e}},e);return Object(a.useEffect)(()=>{let e=!1;return(n.fetchModels||n.showMoreModels)&&(async()=>{try{const i=await t(n)();e||r({type:"SUCCESS",payload:i})}catch(i){if(!e){const e=Um(i);r({type:"FAILURE",payload:e})}}})(),()=>{e=!0}},[n,n.batchSize,n.models,n.fetchModels,n.showMoreModels,t,r]),{state:n,dispatch:r}}const Bg=e=>{let{bodies:t,initialSelectedBodies:n}=e;const{firebaseConfig:r,municipality:s}=Z(),{language:o}=te(),c=Ie({name:re.date,initialState:{start:"",end:""},defaultDataValue:"",textRepFunction:Pp(o,s.timeZone)}),u=Ie({name:re.committee,initialState:t.reduce((e,t)=>(e[t.id]=n[t.id]||!1,e),{}),defaultDataValue:!1,textRepFunction:ve,limit:10}),h=Ie({name:"Sort",initialState:{by:"event_datetime",order:Wm.desc,label:re.newest_first},defaultDataValue:"",textRepFunction:Lp}),d=Object(a.useCallback)(e=>async()=>{const t=!e.fetchModels&&e.models.length>0?e.models[e.models.length-1].event_datetime:void 0,n=new ap(r),i=await n.getEvents(e.batchSize,be(u.state),{start:Op(new Date(c.state.start),s.timeZone),end:Op(new Date(c.state.end),s.timeZone)},{by:h.state.by,order:h.state.order},t),o=await Promise.all(i.map(e=>n.getRenderableEvent(e)));return Promise.resolve(o)},[r,u.state,c.state,h.state,s.timeZone]),m=Object(I.useMediaQuery)({query:"(min-width: ".concat(ae,")")}),{state:p,dispatch:f}=Vg({batchSize:4-(m?1:0),models:[],fetchModels:!0,showMoreModels:!1,hasMoreModels:!1,error:null},d),g=Object(l.g)(),[y,v]=Object(a.useState)(""),_=Object(a.useCallback)(()=>{f({type:Lg.FETCH_MODELS,payload:!0})},[f]),w=Object(a.useCallback)(()=>f({type:Lg.FETCH_MODELS,payload:!1}),[f]),E=Object(a.useMemo)(()=>{if(p.fetchModels)return K(b.a,{active:!0,size:"massive"});if(p.error)return K(qp,{children:p.error.toString()});if(0===p.models.length)return K(qp,{children:re.no_results_found});{const e=p.models.map(e=>{let{keyGrams:t}=e,n=Object(i.a)(e,D);return{link:"/".concat(fe.EVENT,"/").concat(n.id),jsx:K(Ip,{event:n,tags:t})}});return K(Yp,{cards:e})}},[p.fetchModels,p.error,p.models]);return Q(Gp,{children:[Q(Wp,{children:[K("h1",{className:"mzp-u-title-sm",children:re.events}),K(Hp,{placeholder:re.search_topic_placeholder,query:y,setQuery:v,handleSearch:()=>{const e="?q=".concat(y.trim().replace(/\s+/g,"+"));g.push({pathname:"/".concat(fe.EVENT,"/search"),search:e,state:{query:y.trim(),committees:u.state,dateRange:c.state}})}})]}),K(Vp,{allBodies:t,filters:[u,c,h],sortOptions:[{by:"event_datetime",order:Wm.desc,label:re.newest_first},{by:"event_datetime",order:Wm.asc,label:re.oldest_first}],handlePopupClose:_}),E,K(Kp,{isVisible:p.hasMoreModels&&!p.fetchModels,children:Q("button",{className:"mzp-c-button mzp-t-secondary mzp-t-lg",onClick:w,children:[K("span",{children:re.show_more}),K(b.a,{inline:!0,active:p.showMoreModels,size:"tiny"})]})})]})},Fg=()=>{const{firebaseConfig:e}=Z();ne(re.events);const t=Object(l.h)(),n=Object(a.useMemo)(()=>{if(t.state)return t.state;const{body:e}=v.a.parse(t.search),n={};return e&&"string"===typeof e&&(n[e]=!0),{committees:n}},[t]),r=Object(a.useCallback)(async()=>{const t=new Ym(e),n=await t.getAllBodies();return Promise.resolve({bodies:n})},[e]),{state:i}=ep({isLoading:!1,error:null,hasFetchRequest:!0},r);return K(Xm,{isLoading:i.isLoading,error:i.error,children:i.data&&K(Bg,Object(o.a)(Object(o.a)({},i.data),{},{initialSelectedBodies:n.committees}))})};class Ug extends Gm{constructor(e){super(jm.Person,e)}async getPersonById(e){const t=new Bm(jm.File,Lm.PersonPictureRef),n=this.networkService.getDocument(e,jm.Person,new Fm([t]));return this.createModel(n,uf,"getPersonById(".concat(e,")"))}}class zg{constructor(e){this.id=e.id,this.name=e.name,e.external_source_id&&(this.external_source_id=e.external_source_id),e.electoral_area&&(this.electoral_area=e.electoral_area),e.electoral_type&&(this.electoral_type=e.electoral_type),e.image_ref&&(e.image_ref instanceof Kh?this.image_ref=e.image_ref.id:"object"===typeof e.image_ref&&(this.image=new rp(e.image_ref)))}}class qg{constructor(e){this.id=e.id,this.title=e.title,this.person_ref=e.person_ref.id,this.seat_ref=e.seat_ref.id,this.start_datetime=Km(e.start_datetime),e.end_datetime&&(this.end_datetime=Km(e.end_datetime)),"object"!==typeof e.person_ref||e.person_ref instanceof Kh||(this.person=new uf(e.person_ref)),e.body_ref&&(e.body_ref instanceof Kh?this.body_ref=e.body_ref.id:"object"===typeof e.body_ref&&(this.body=new Qm(e.body_ref))),"object"!==typeof e.seat_ref||e.seat_ref instanceof Kh||(this.seat=new zg(e.seat_ref)),e.external_source_id&&(this.external_source_id=e.external_source_id)}}class Gg extends Gm{constructor(e){super(jm.Role,e)}async getPopulatedRolesByPersonId(e){const t=new Bm(jm.Body,Lm.RoleBodyRef),n=this.networkService.getDocuments(jm.Role,[Cd(Lm.RolePersonRef,Hm.eq,Jh(zm.getDb(),jm.Person,e)),kd("start_datetime",Wm.desc)],new Fm([t]));return this.createModels(n,qg,"getPopulatedRolesByPersonId(".concat(e,")"))}async getCouncilMemberRolesByPersonId(e){const t=new Bm(jm.Seat,Lm.RoleSeatRef),n=this.networkService.getDocuments(jm.Role,[Cd(Lm.RolePersonRef,Hm.eq,Jh(zm.getDb(),jm.Person,e)),Cd("title",Hm.eq,mg.COUNCILMEMBER),kd("start_datetime",Wm.desc)],new Fm([t]));return this.createModels(n,qg,"getCouncilMemberRolesByPersonId(".concat(e,")"))}async getMostRecentCouncilMemberRoleBySeat(e){const t=new Bm(jm.Person,Lm.RolePersonRef),n=this.networkService.getDocuments(jm.Role,[Cd(Lm.RoleSeatRef,Hm.eq,Jh(zm.getDb(),jm.Seat,e)),Cd("end_datetime",Hm.eq,null),Nd(1),kd("start_datetime",Wm.desc)],new Fm([t])),r=await this.createModels(n,qg,"getMostRecentCouncilMemberRoleBySeatWithNullEndDates");if(r[0])return Promise.resolve(r[0]);const i=this.networkService.getDocuments(jm.Role,[Cd(Lm.RoleSeatRef,Hm.eq,Jh(zm.getDb(),jm.Seat,e)),Nd(1),kd("end_datetime",Wm.desc)],new Fm([t])),s=await this.createModels(i,qg,"getMostRecentCouncilMemberRoleBySeat");return s[0]?Promise.resolve(s[0]):Promise.resolve(null)}}var Hg=h.a.h2(e=>({display:e.isInline?"inline":"block",paddingBottom:e.hasBorderBottom?8:0,borderBottom:e.hasBorderBottom?"1px solid ".concat(yp):0}));const Wg=h.a.div({"& > address > a:nth-of-type(2)":{marginTop:8},"& a":{display:"flex",alignItems:"center",columnGap:8},"& svg":{width:Fp,height:Fp,color:vp}}),Kg=e=>{let{person:t}=e;return t.phone||t.email||t.website?Q(Wg,{children:[K(Hg,{hasBorderBottom:!0,className:"mzp-u-title-xs",children:re.contact}),(t.phone||t.email)&&Q("address",{children:[t.email&&Q("a",{className:"mzp-c-cta-link",href:"mailto:".concat(t.email),children:[K("svg",{width:16,height:16,xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:K("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),t.email]}),t.phone&&Q("a",{className:"mzp-c-cta-link",href:"tel:".concat(t.phone),children:[K("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:K("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),t.phone]})]}),t.website&&Q(Y,{children:[K("br",{}),K("a",{className:"mzp-c-cta-link",target:"_blank",rel:"noopener noreferrer",href:t.website,children:re.visit_persons_website.replace("{person_name}",t.name)})]})]}):null},Qg=h.a.div({position:"relative",height:150,"& img":{objectFit:"cover"},["@media (min-width:".concat(oe,")")]:{height:400}}),Yg=h.a.img({width:"100%",height:"100%"}),Jg=h.a.img(e=>({visibility:e.isLoading?"hidden":"visible",position:"absolute",left:-5,bottom:-35,width:100,height:100,borderRadius:"50%",["@media (min-width:".concat(oe,")")]:{left:-25,width:200,height:200}})),Xg=e=>{let{personName:t,personPictureSrc:n,seatPictureSrc:r,electoralArea:i}=e;const[s,o]=Object(a.useState)(!0),[c,l]=Object(a.useState)(!0);return Object(a.useEffect)(()=>{null===n.data&&o(!1),null===r.data&&l(!1)},[n.data,r.data]),Q(Qg,{children:[K(fp,{contentIsLoading:c||s,children:K(Yg,{className:"mzp-c-card-image",src:r.data||"",alt:"".concat(i||""),onLoad:()=>l(!1)})}),n.data&&K(Jg,{isLoading:c||s,className:"mzp-c-card-image",src:n.data,alt:"Picture of ".concat(t),onLoad:()=>o(!1)})]})};class Zg{constructor(e){this.id=e.id,this.person_ref=e.person_ref.id,this.matter_ref=e.matter_ref.id,e.external_source_id&&(this.external_source_id=e.external_source_id),"object"!==typeof e.person_ref||e.person_ref instanceof Kh||(this.person=new uf(e.person_ref)),"object"!==typeof e.matter_ref||e.matter_ref instanceof Kh||(this.matter=new rf(e.matter_ref))}}class $g extends Gm{constructor(e){super(jm.MatterSponsor,e)}async getMatterSponsorByMatterId(e){const t=new Bm(jm.MatterSponsor,Lm.MatterSponsorPersonRef),n=this.networkService.getDocuments(jm.MatterSponsor,[Cd(Lm.MatterSponsorMatterRef,Hm.eq,Jh(zm.getDb(),jm.Matter,e))],new Fm([t]));return this.createModels(n,Zg,"getMatterSponsorByMatterId(".concat(e,")"))}async getMattersSponsoredByPersonId(e,t,n){const r=new Bm(jm.Matter,Lm.MatterSponsorMatterRef),i=[];if(i.push(Cd(Lm.MatterSponsorPersonRef,Hm.eq,Jh(zm.getDb(),jm.Person,e))),i.push(kd(Lm.MatterSponsorMatterRef,Wm.asc)),n){const e=Jh(zm.getDb(),jm.MatterSponsor,n),t=await Ud(e);i.push(Rd(t))}i.push(Nd(t));const s=this.networkService.getDocuments(jm.MatterSponsor,i,new Fm([r]));return this.createModels(s,Zg,"getMattersSponsoredByPersonId(".concat(e,")"))}}const ey=h.a.summary(e=>({"&::before":{content:"none"},cursor:"pointer",paddingRight:0,paddingBottom:e.hasBorderBottom?8:0,borderBottom:e.hasBorderBottom?"1px solid ".concat(yp):0})),ty=e=>{let{summaryContent:t,hiddenContent:n,defaultOpen:r,hasBorderBottom:i}=e;return Q("details",{open:r,children:[K(ey,{hasBorderBottom:i,children:t}),n]})};var ny=h.a.ul(e=>({marginLeft:"1.25rem","& > li":{marginTop:e.gap}}));const ry=e=>{let{personId:t}=e;const{firebaseConfig:n}=Z(),r=Object(a.useCallback)(e=>async()=>{const r=!e.fetchModels&&e.models.length>0?e.models[e.models.length-1].id:void 0,i=new $g(n),s=await i.getMattersSponsoredByPersonId(t,e.batchSize,r);return Promise.resolve(s)},[n,t]),{state:i,dispatch:s}=Vg({batchSize:25,models:[],fetchModels:!0,showMoreModels:!1,hasMoreModels:!1,error:null},r),o=Object(a.useCallback)(()=>s({type:Lg.FETCH_MODELS,payload:!1}),[s]),c=Object(a.useMemo)(()=>Q(ff,{data:"legislations",isLoading:i.fetchModels,error:i.error,notFound:!i.fetchModels&&0===i.models.length,children:[K(ny,{gap:8,children:i.models.map(e=>{var t,n,r,i;return K("li",{children:Q("dl",{children:[K("dt",{children:K(u.b,{to:"/matters/".concat(null==(t=e.matter)?void 0:t.id),children:K("strong",{children:null==(n=e.matter)?void 0:n.name})},null==(r=e.matter)?void 0:r.id)}),K("dd",{children:null==(i=e.matter)?void 0:i.title})]})},e.id)})}),K("br",{}),K(Kp,{isVisible:!i.fetchModels&&i.hasMoreModels,children:Q("button",{className:"mzp-c-button mzp-t-secondary mzp-t-lg",onClick:o,children:[K("span",{children:re.show_more}),K(b.a,{inline:!0,active:i.showMoreModels,size:"tiny"})]})})]}),[i,o]);return K("div",{style:{marginTop:16},children:K(ty,{hasBorderBottom:!0,defaultOpen:!1,summaryContent:K(Hg,{className:"mzp-u-title-xs",isInline:!0,children:re.legislation_sponsored}),hiddenContent:c})})};const iy=e=>{let{hasBorderBottom:t,roles:n,defaultOpen:r,title:i}=e;return K(ty,{hasBorderBottom:t,defaultOpen:r,summaryContent:i,hiddenContent:K(ny,{gap:4,children:n.map(e=>{var t,n,r;return Q("li",{children:[K("strong",{children:"".concat(re[e.title.toLowerCase().replace(" ","_")],": ")}),K(u.b,{to:{pathname:"/events",search:"?body=".concat(null==(t=e.body)?void 0:t.id),state:{committees:{[null==(n=e.body)?void 0:n.id]:!0}}},children:K("strong",{children:"".concat(null==(r=e.body)?void 0:r.name)})})]},e.id)})})})},sy=e=>{let{councilMemberRoles:t,allRoles:n}=e;const{municipality:r}=Z(),{language:i}=te(),[s,o,c]=Object(a.useMemo)(()=>{const e=function(e){function t(e,t){return"".concat(e.toISOString()).concat(null==t?void 0:t.toISOString())}return[...new Map(e.map(e=>[t(e.start_datetime,e.end_datetime),e])).values()].sort((e,t)=>t.start_datetime.getTime()-e.start_datetime.getTime())}(t),[r,i]=function(e,t){const n=e.filter(e=>e.title!==mg.COUNCILMEMBER),r=[mg.COUNCILPRESIDENT,mg.CHAIR,mg.VICE_CHAIR,mg.SUPERVISOR,mg.MEMBER,mg.ALTERNATE];n.sort((e,t)=>r.indexOf(e.title)-r.indexOf(t.title));const i=t.reduce((e,t)=>(e[t.id]=[[],[]],e),{}),s=new Date;for(const o of n){const e=o.end_datetime||s;for(const n of t){const t=n.end_datetime||s;e>=n.start_datetime&&e<=t&&(e>s?i[n.id][0].push(o):i[n.id][1].push(o))}}return[i,n]}(n,e);return[e,r,i]},[t,n]);return 0===n.length?null:0===s.length&&c.length>0?K(iy,{hasBorderBottom:!0,roles:c,defaultOpen:!1,title:K(Hg,{isInline:!0,className:"mzp-u-title-xs",children:re.committees})}):Q("div",{children:[K(Hg,{hasBorderBottom:!0,className:"mzp-u-title-xs",children:re.terms}),K(ny,{gap:16,children:s.map(e=>{var t,n;const s=!e.end_datetime||e.end_datetime>new Date;return K("li",{children:K(ty,{defaultOpen:s,summaryContent:Q("span",{style:{fontSize:Up},children:[K("strong",{children:"".concat(re[e.title.toLowerCase().replace(" ","_")],": ")})," ","".concat(null==(t=e.seat)?void 0:t.name," // ").concat(null==(n=e.seat)?void 0:n.electoral_area," (").concat(e.start_datetime.toLocaleDateString(i,{timeZone:r.timeZone})," - ").concat(e.end_datetime?e.end_datetime.toLocaleDateString(i,{timeZone:r.timeZone}):"",")")]}),hiddenContent:Q(ny,{gap:8,children:[o[e.id][0].length>0&&K("li",{children:K(iy,{hasBorderBottom:!1,roles:o[e.id][0],defaultOpen:s,title:re.committee_membership})}),o[e.id][1].length>0&&K("li",{children:K(iy,{hasBorderBottom:!1,roles:o[e.id][1],defaultOpen:!s,title:re.former_committee_membership})})]})})},e.id)})})]})},oy=e=>{let{index:t,legislationLink:n,legislationName:r,legislationTags:i,voteDecision:s,councilDecision:o,meetingDate:a,meetingLink:l,committeeName:h,columnNames:d,columnDistribution:m}=e;const{municipality:p}=Z(),{language:f}=te(),g=i&&i.length>0?i.join(_p):"",y=null==a?void 0:a.toLocaleDateString(f,{timeZone:p.timeZone,month:"long",day:"numeric",year:"numeric"}),v=Object(I.useMediaQuery)({query:"(max-width: ".concat(oe,")")});return Q(bg,{index:t,columnNames:d,columnDistribution:m,children:[Q(c.a.Fragment,{children:[K(u.b,{to:n,children:K("p",{className:"mzp-c-card-desc",style:{fontWeight:600,marginBottom:0},children:r})}),!v&&K("p",{className:"mzp-c-card-desc",children:g})]}),K(yg,{result:s}),K(yg,{result:o}),Q(c.a.Fragment,{children:[K(u.b,{to:l,children:y}),!v&&K("p",{className:"mzp-c-card-desc",children:h})]})]},"voting-table-row-".concat(t))};const ay=e=>{let{name:t,votesPage:n}=e;const r=[re.legislation,re.persons_vote.replace("{name}",t),re.council_decision,re.meeting],i=["30%","15%","20%","35%"];return K(Cg,{data:n,columnDistribution:i,columnNames:r,renderRow:function(e,t){var n;if(!e.matter||!e.decision||!e.event)return function(e){return K(vg,{index:e},"empty-table-row-".concat(e))}(t);const s=e.matter.name,o=e.decision,a=null==(n=e.event_minutes_item)?void 0:n.decision,c="/matters/".concat(e.matter.id),l=e.matter.keywords,u=e.event.event_datetime,h="/events/".concat(e.event.id),d=e.event.body.name;return K(oy,{index:t,legislationName:s,voteDecision:o,councilDecision:a,legislationLink:c,legislationTags:l,meetingDate:u,meetingLink:h,committeeName:d,columnNames:r,columnDistribution:i},"voting-table-row-".concat(t))}})},cy=e=>{let{personId:t,personName:n}=e;const{firebaseConfig:r}=Z(),i=Object(a.useCallback)(e=>async()=>{const n=!e.fetchModels&&e.models.length>0?e.models[e.models.length-1].id:void 0,i=new df(r),s=await i.getFullyPopulatedVotesByPersonId(t,e.batchSize,n);return Promise.resolve(s)},[r,t]),{state:s,dispatch:o}=Vg({batchSize:25,models:[],fetchModels:!0,showMoreModels:!1,hasMoreModels:!1,error:null},i),c=Object(a.useCallback)(()=>o({type:Lg.FETCH_MODELS,payload:!1}),[o]),l=Object(a.useMemo)(()=>Q(ff,{data:"votes",isLoading:s.fetchModels,error:s.error,notFound:!s.fetchModels&&0===s.models.length,children:[K(ay,{name:n,votesPage:s.models}),K("br",{}),K(Kp,{isVisible:!s.fetchModels&&s.hasMoreModels,children:Q("button",{className:"mzp-c-button mzp-t-secondary mzp-t-lg",onClick:c,children:[K("span",{children:re.show_more}),K(b.a,{inline:!0,active:s.showMoreModels,size:"tiny"})]})})]}),[n,s,c]);return K(ty,{hasBorderBottom:!0,defaultOpen:!1,summaryContent:K(Hg,{className:"mzp-u-title-xs",isInline:!0,children:re.persons_voting_record.replace("{person_name}",n)}),hiddenContent:Q(Y,{children:[K("br",{}),l]})})},ly=h.a.div({display:"grid",gridTemplateColumns:"1fr",rowGap:64}),uy=h.a.h1({margin:0,"& > span:first-of-type":{fontSize:"inherit",fontWeight:"inherit"},"& > span:not(:first-of-type)":{fontSize:zp},"& > span:nth-of-type(2)":{marginLeft:16,padding:"0px 8px",borderRadius:4,fontWeight:300},"& > span:nth-of-type(3)":{marginTop:16,display:"block",fontWeight:400}}),hy=h.a.div(e=>({display:e.isVisible?"grid":"none",rowGap:64,gridTemplateColumns:"1fr",["@media (min-width:".concat(oe,")")]:{gridTemplateColumns:"auto 1fr",columnGap:128}})),dy=e=>{let{person:t,roles:n,councilMemberRoles:r,personPictureSrc:i,seatPictureSrc:s}=e;var o;const a=r.length>0?r[0]:void 0,c=!(null==a?void 0:a.end_datetime)||(null==a?void 0:a.end_datetime)>new Date,l=!!(t.phone||t.email||t.website),u=n.length>0;return ne(t.name),Q(ly,{children:[K(Xg,{personName:t.name,personPictureSrc:i,seatPictureSrc:s,electoralArea:null==(o=null==a?void 0:a.seat)?void 0:o.electoral_area}),Q(uy,{className:"mzp-u-title-sm",children:[K("span",{children:t.name}),a&&K("span",{className:c?"cdp-bg-neon-green":"cdp-bg-dark-grey",children:c?re.active:re.inactive}),(null==a?void 0:a.seat)&&K("span",{children:"".concat(null==a?void 0:a.seat.name," // ").concat(a.seat.electoral_area)})]}),Q(hy,{isVisible:l||u,children:[K(Kg,{person:t}),K(sy,{councilMemberRoles:r,allRoles:n})]}),K(ry,{personId:t.id}),K("div",{children:K(cy,{personId:t.id,personName:t.name})})]})},my=()=>{const{id:e}=Object(l.i)(),{firebaseConfig:t}=Z(),n=Object(a.useCallback)(async()=>{const n=new Ug(t),r=await n.getPersonById(e);return Promise.resolve(r)},[e,t]),{state:r}=ep(Object(o.a)({},Zm),n),i=Object(a.useCallback)(async()=>{var e;const n=new hp(t),{networkService:i}=n;if(null==(e=r.data)?void 0:e.picture){const e=await i.getDownloadUrl(r.data.picture.uri);return Promise.resolve(e)}return Promise.resolve(null)},[r.data,t]),{state:s,dispatch:c}=ep(Object(o.a)(Object(o.a)({},Zm),{},{hasFetchRequest:!1}),i);Object(a.useEffect)(()=>{r.data&&c({type:$m.FETCH})},[r.data,c]);const u=Object(a.useCallback)(async()=>{const n=new Gg(t),r=await n.getCouncilMemberRolesByPersonId(e);return Promise.resolve(r)},[e,t]),{state:h}=ep(Object(o.a)({},Zm),u),d=Object(a.useCallback)(async()=>{const e=new hp(t),{networkService:n}=e;if(h.data&&h.data.length>0&&h.data[0].seat&&h.data[0].seat.image_ref){const t=await e.getFileById(h.data[0].seat.image_ref),r=await n.getDownloadUrl(t.uri);return Promise.resolve(r)}return Promise.resolve(null)},[h.data,t]),{state:m,dispatch:p}=ep(Object(o.a)(Object(o.a)({},Zm),{},{hasFetchRequest:!1}),d);Object(a.useEffect)(()=>{h.data&&p({type:$m.FETCH})},[h.data,p]);const f=Object(a.useCallback)(async()=>{const n=new Gg(t),r=await n.getPopulatedRolesByPersonId(e);return Promise.resolve(r)},[e,t]),{state:g}=ep(Object(o.a)({},Zm),f),y=Object(a.useMemo)(()=>r.isLoading||h.isLoading||g.isLoading,[r.isLoading,h.isLoading,g.isLoading]),v=Object(a.useMemo)(()=>{if(r.data&&h.data&&g.data)return{person:r.data,councilMemberRoles:h.data,roles:g.data}},[r.data,h.data,g.data]),b=Object(a.useMemo)(()=>{const e=[r.error,h.error,g.error].map(e=>(null==e?void 0:e.message)||"").filter(e=>e.length>0);return e.length>0?new Error(e.join("\n")):null},[r.error,h.error,g.error]);return K(Xm,{isLoading:y,error:b,children:v&&K(dy,Object(o.a)(Object(o.a)({},v),{},{personPictureSrc:s,seatPictureSrc:m}))})},py=h.a.div({float:"right",marginRight:8,marginBottom:8,borderRadius:"10%",padding:"0 4px"}),fy=h.a.img(e=>({objectFit:"cover",left:"".concat(e.left," !important"),width:"".concat(e.width," !important"),height:"100%"})),gy=e=>{let{person:t,seat:n}=e;var r,i,s,o,c;const{firebaseConfig:l}=Z(),u=Object(a.useCallback)(async()=>{const e=new hp(l),{networkService:r}=e,i=[Promise.resolve(void 0),Promise.resolve(void 0)];n.image_ref&&(i[0]=e.getFileById(n.image_ref).then(e=>r.getDownloadUrl(e.uri)).catch(()=>Promise.resolve(void 0))),t.picture_ref&&(i[1]=e.getFileById(t.picture_ref).then(e=>r.getDownloadUrl(e.uri)).catch(()=>Promise.resolve(void 0)));const[s,o]=await Promise.all(i);return Promise.resolve({seatPictureSrc:s,personPictureSrc:o})},[t.picture_ref,n.image_ref,l]),{state:h}=ep({isLoading:!1,error:null,hasFetchRequest:!0},u),[d,m]=Object(a.useState)(!0),[p,f]=Object(a.useState)(!0);return Object(a.useEffect)(()=>{var e,t;h.isLoading||void 0!==(null==(e=h.data)?void 0:e.personPictureSrc)||m(!1),h.isLoading||void 0!==(null==(t=h.data)?void 0:t.seatPictureSrc)||f(!1)},[h]),K("section",{className:"mzp-c-card mzp-c-card-medium mzp-has-aspect-16-9",children:Q("div",{className:"mzp-c-card-block-link",children:[K("div",{className:"mzp-c-card-media-wrapper",children:K(dp,{children:Q(fp,{contentIsLoading:d||p,children:[(null==(r=h.data)?void 0:r.personPictureSrc)&&K(fy,{className:"mzp-c-card-image",src:h.data.personPictureSrc,width:(null==(i=h.data)?void 0:i.seatPictureSrc)?"40%":"100%",left:"0",alt:t.name,onLoad:()=>m(!1)}),K(fy,{className:"mzp-c-card-image",src:null==(s=h.data)?void 0:s.seatPictureSrc,width:(null==(o=h.data)?void 0:o.personPictureSrc)?"60%":"100%",left:(null==(c=h.data)?void 0:c.personPictureSrc)?"40%":"0",alt:"".concat(n.name," - ").concat(n.electoral_area),onLoad:()=>f(!1)})]})})}),Q("div",{className:"mzp-c-card-content",children:[K("h2",{className:"mzp-c-card-title",children:t.name}),K(py,{className:t.is_active?"cdp-bg-neon-green":"cdp-bg-dark-grey",children:t.is_active?re.active:re.inactive}),Q("p",{className:"mzp-c-card-desc",children:[n.name," \u2022 ",n.electoral_area]})]})]})})},yy=e=>{let{roles:t,seats:n}=e;const r=t.reduce((e,t,r)=>(t.person&&e.push({link:"/people/".concat(t.person.id),jsx:K(gy,{person:t.person,seat:n[r]},"person-card-".concat(t.person.name))}),e),[]);return Q("div",{children:[K("h1",{className:"mzp-u-title-sm",children:"Current Councilmembers"}),K(Yp,{cards:r})]})};class vy extends Gm{constructor(e){super(jm.Seat,e)}async getAllSeats(){const e=this.networkService.getDocuments(jm.Seat,[kd("name")]);return this.createModels(e,zg,"getAllSeats")}}const by=()=>{const{firebaseConfig:e}=Z(),t=Object(a.useCallback)(async()=>{const t=new vy(e),n=new Gg(e),r=await t.getAllSeats(),i=r.map(e=>n.getMostRecentCouncilMemberRoleBySeat(e.id)),s=await Promise.all(i),o=s.reduce((e,t,n)=>(null===t&&e.push(n),e),[]),a=s.reduce((e,t)=>(null!==t&&e.push(t),e),[]);for(let e=o.length-1;e>=0;e--)r.splice(o[e],1);return{seats:r,roles:a}},[e]),{state:n}=ep({isLoading:!1,error:null,hasFetchRequest:!0},t);return K(Xm,{isLoading:n.isLoading,error:n.error,children:n.data&&K(yy,{roles:n.data.roles,seats:n.data.seats})})},_y=h.a.b(e=>({overflow:"hidden","text-overflow":"ellipsis",display:"-webkit-box","-webkit-line-clamp":e.minified?"".concat(e.linesToShow):"none","line-clamp":e.minified?"".concat(e.linesToShow):"none","-webkit-box-orient":"vertical"})),wy=e=>{let{matterStatus:t,indexedMatterGrams:n}=e;var r,i;const[s,o]=Object(a.useState)(!0),c=Object(I.useMediaQuery)({query:"(max-width: ".concat(oe,")")})?4:2;return Q("div",{children:[K("h1",{className:"mzp-u-title-sm",children:null==(r=t.matter)?void 0:r.name}),K(_y,{onClick:()=>{o(!s)},minified:s,linesToShow:c,children:null==(i=t.matter)?void 0:i.title}),Q("div",{style:{display:"flex",flexDirection:"row",justifyContent:"start",marginTop:12,marginBottom:12},children:[K(yg,{result:t.status,style:{display:"flex",alignItems:"center",flex:0,whiteSpace:"nowrap"}}),K("div",{style:{display:"flex",flexDirection:"row",justifyContent:"left",alignItems:"center",flex:1},children:n&&n.map(e=>Q("div",{children:[K("p",{style:{display:"inline",paddingLeft:11,paddingRight:11},children:"\u2022"}),K("p",{style:{display:"inline"},children:e.unstemmed_gram})]},e.id))})]})]})},Ey=h.a.div({width:20,height:20,borderRadius:"50%",zIndex:1}),Sy="calc(50% + ".concat(10,"px + ").concat(8,"px)"),Iy=h.a.div({height:29,position:"relative"}),Cy=h.a.div(e=>({position:"absolute",top:0,left:0,height:29,width:e.width,borderTopLeftRadius:"50em",borderBottomLeftRadius:"50em",borderTopRightRadius:"50em",borderBottomRightRadius:"50em",display:"flex",justifyContent:"space-between",alignItems:"center",zIndex:e.zIndex,"& > div:first-of-type":{marginLeft:6},"& > div:last-of-type":{marginRight:6}})),Ty=h.a.div({display:"flex",justifyContent:"space-between","& > div":{fontWeight:500}}),ky={[fg.ADOPTED]:["cdp-bg-acceptance-green","cdp-bg-light-acceptance_green"],[fg.REJECTED]:["cdp-bg-rejected-red","cdp-bg-light-rejected_red"],[fg.IN_PROGRESS]:["cdp-bg-in-progress_orange","cdp-bg-light-in_progress_orange"]},xy=e=>{let{status:t}=e;const n=ky[t],r=t===fg.IN_PROGRESS;return Q("div",{children:[Q(Iy,{children:[Q(Cy,{className:n[1],width:r?Sy:"100%",zIndex:2,children:[K(Ey,{className:n[0]}),K(Ey,{className:n[0]}),!r&&K(Ey,{className:n[0]})]}),Q(Cy,{className:"cdp-bg-light-neutral_grey",width:"100%",zIndex:1,children:[K(Ey,{className:"cdp-bg-neutral-grey"}),K(Ey,{className:"cdp-bg-neutral-grey"}),K(Ey,{className:"cdp-bg-neutral-grey"})]})]}),Q(Ty,{children:[K("div",{children:"Introduced"}),K("div",{children:fg.IN_PROGRESS}),K("div",{style:{opacity:r?"0.75":"1"},children:r?fg.ADOPTED:t})]})]})},Ny=Object(h.a)(Hg)({display:"flex",justifyContent:"space-between",alignItems:"flex-end","& > em":{fontSize:Up,fontWeight:400}}),Ay=h.a.div({display:"flex",flexWrap:"wrap"}),Ry=h.a.dl({fontSize:Up,display:"flex",flexDirection:"column",rowGap:16,"& > div:not(:nth-of-type(2))":{display:"flex",columnGap:4,flexWrap:"wrap"},"& > div:nth-of-type(2)":{margin:"16px 0"},"& > div:nth-of-type(2) > dt":{width:0,height:0,overflow:"hidden"},"& dt":{fontWeight:600},"& dd":{fontWeight:400}}),Dy=e=>{let{matterStatus:t,event:n,sponsors:r,document:i}=e;const{municipality:s}=Z(),{language:o}=te();return Q("div",{children:[Q(Ny,{hasBorderBottom:!0,className:"mzp-u-title-xs",children:[K("span",{children:"Legislation Overview"}),K("em",{children:"Last Updated ".concat(t.update_datetime.toLocaleDateString(o,{timeZone:s.timeZone,month:"long",day:"numeric",year:"numeric"}))})]}),Q(Ry,{children:[Q("div",{children:[K("dt",{children:"Legislation Status:"}),K("dd",{children:K(yg,{result:t.status})})]}),Q("div",{children:[K("dt",{children:"Progress bar"}),K("dd",{children:K(xy,{status:t.status})})]}),n&&Q("div",{children:[K("dt",{children:"Latest Meeting:"}),K("dd",{children:K(u.b,{to:"/events/".concat(n.id),children:n.event_datetime.toLocaleDateString(o,{timeZone:s.timeZone,month:"short",day:"numeric",year:"numeric"})})})]}),i&&Q("div",{children:[K("dt",{children:"Latest Document:"}),K("dd",{children:K("a",{target:"_blank",rel:"noopener noreferrer",href:i.url,children:i.name})})]}),Q("div",{children:[K("dt",{children:"Sponsored by:"}),K("dd",{children:K(Ay,{children:r.map((e,t)=>[t>0&&K("span",{style:{whiteSpace:"pre-wrap"},children:",  "}),K(u.b,{to:"/people/".concat(e.id),children:e.name},e.id)])})})]})]})]})},Oy=h.a.div({flex:4}),Py=h.a.div(e=>({position:"absolute",top:0,left:0,height:e.height,width:e.width,borderTopLeftRadius:"50em",borderBottomLeftRadius:"50em",borderTopRightRadius:"50em",borderBottomRightRadius:"50em",zIndex:e.zIndex})),My=e=>{let{statusColor:t,percentage:n,height:r,votes:i,label:s}=e;const[o,c]=Object(a.useState)(!1),l=Object(I.useMediaQuery)({query:"(max-width: ".concat(oe,")")}),h=i.map((e,t)=>{var n;return Q("div",{style:{marginTop:4,display:"flex"},children:[K(u.b,{to:"/people/".concat(e.id),style:{marginLeft:12,flex:1},children:null==(n=e.person)?void 0:n.name}),K(yg,{result:e.decision}),!l&&K(Oy,{style:{flex:4}})]},"".concat(t,"_").concat(e.id,"_vote"))}),d=l?"100%":"20%";return Q("div",{style:{display:"flex",flexDirection:"column",marginTop:16},children:[Q("div",{style:{display:"flex",flexDirection:l?"column":"row",flex:1,alignItems:"center"},children:[Q("div",{style:{height:r,position:"relative",width:l?"100%":"80%",cursor:"pointer"},onClick:()=>{c(!o)},children:[K(Py,{className:t,width:"".concat(n,"%"),height:r,zIndex:2}),K(Py,{className:"cdp-bg-neutral-grey",width:"100%",height:r,zIndex:1})]}),K("b",{style:{marginLeft:16,width:d},children:s})]}),o&&h]})};const jy=e=>{let{votes:t}=e;const{inFavor:n,against:r,abstained:i}=function(e){const t=[],n=[],r=[];return e.forEach(e=>{[pg.ABSENT_APPROVE,pg.ABSTAIN_APPROVE,pg.APPROVE].includes(e.decision)&&t.push(e),[pg.ABSENT_REJECT,pg.ABSTAIN_REJECT,pg.REJECT].includes(e.decision)&&n.push(e),[pg.ABSENT_NON_VOTING,pg.ABSTAIN_NON_VOTING].includes(e.decision)&&r.push(e)}),{inFavor:t,against:n,abstained:r}}(t),s=re.number_approved.replace("{number}","".concat(n.length)),o=re.number_rejected.replace("{number}","".concat(r.length)),a=re.number_non_voting.replace("{number}","".concat(i.length)),c=[K(My,{statusColor:"cdp-bg-acceptance-green",votes:n,percentage:n.length/t.length*100,height:16,label:s},"inFavorVoteBar"),K(My,{statusColor:"cdp-bg-rejected-red",votes:r,percentage:r.length/t.length*100,height:16,label:o},"againstVoteBar"),K(My,{statusColor:"cdp-bg-light-purple",votes:i,percentage:i.length/t.length*100,height:16,label:a},"abstainedVoteBar")];return K("div",{style:{display:"flex",flexDirection:"column"},children:c})},Ly=e=>{let{votes:t}=e;return K("div",{style:{marginTop:16},children:K(ty,{hasBorderBottom:!0,defaultOpen:!1,summaryContent:K(Hg,{className:"mzp-u-title-xs",isInline:!0,children:re.latest_vote}),hiddenContent:K(jy,{votes:t})})})},Vy=e=>{let{eventMinutesItem:t,isLastIndex:n}=e;var r,i,s,c,l,d,m,p;const{municipality:f}=Z(),g=Object(I.useMediaQuery)({query:"(max-width: ".concat(oe,")")}),y=g?4:12,v=h.a.div({position:"relative"}),b=h.a.div({margin:y,display:"flex",flexDirection:"row",gap:3*y}),_=h.a.div({flex:1}),w=h.a.div({display:"flex",flexDirection:"row"}),E=h.a.div(()=>({flex:1,marginTop:y,marginLeft:g?0:2*y})),S=h.a.div({position:"absolute",top:y+20,left:10+y,height:"100%",width:2,zIndex:0,backgroundColor:"grey"}),{firebaseConfig:C}=Z(),{language:T}=te(),k=null==(r=t.event)?void 0:r.event_datetime.toLocaleDateString(T,{timeZone:f.timeZone,month:"long",day:"numeric",year:"numeric"}),x=Object(a.useCallback)(async()=>{const e={votes:[],files:[]},n=new lf(C),r=await n.getEventMinutesItemFilesByEventMinutesItemId(t.id);if(e.files=r.map(e=>{let{name:t,uri:n}=e;return{label:t,url:n}}),t.decision){const n=new df(C);e.votes=await n.getVotesByEventMinutesItemId(t.id)}return Promise.resolve(e)},[t.id,t.decision,C]),{state:N}=ep(Object(o.a)({},Zm),x);return Q(v,{children:[Q(b,{children:[K(Ey,{className:"cdp-bg-neutral-grey"}),Q(_,{children:[Q(w,{children:[K(u.b,{to:"/events/".concat(null==(i=t.event)?void 0:i.id),children:k}),t.decision&&K(yg,{result:t.decision,style:{marginLeft:y,display:"flex",flex:1,alignItems:"center"}})]}),Q(ff,{data:"votes and documents associated with this event",isLoading:N.isLoading,error:N.error,notFound:!N.data,children:[(null==(s=N.data)?void 0:s.votes)&&(null==(c=N.data)?void 0:c.votes.length)>0&&K(ty,{summaryContent:re.votes,hiddenContent:K(E,{children:K(jy,{votes:null==(l=N.data)?void 0:l.votes})}),defaultOpen:!1,hasBorderBottom:!1}),(null==(d=N.data)?void 0:d.files)&&(null==(m=N.data)?void 0:m.files.length)>0&&K(og,{documents:null==(p=N.data)?void 0:p.files})]})]})]}),!n&&K(S,{})]})},By=h.a.div({marginTop:16}),Fy=h.a.div({display:"flex",flexDirection:"column"}),Uy=e=>{let{eventMinutesItems:t}=e;return K(By,{children:K(ty,{hasBorderBottom:!0,defaultOpen:!1,summaryContent:K(Hg,{className:"mzp-u-title-xs",isInline:!0,children:re.history}),hiddenContent:K(Fy,{children:t.map((e,n)=>K(Vy,{isLastIndex:n===t.length-1,eventMinutesItem:e},"leg_hist_node_".concat(e.id,"_").concat(n)))})})})},zy=h.a.div({display:"grid",gridTemplateColumns:"1fr",rowGap:64}),qy=e=>{let{matterStatus:t,indexedMatterGrams:n,event:r,sponsors:i,votes:s,legislationHistory:o}=e;return Q(zy,{children:[K(wy,{matterStatus:t,indexedMatterGrams:n}),K(Dy,{matterStatus:t,event:r,sponsors:i}),s&&K(Ly,{votes:s}),o&&K(Uy,{eventMinutesItems:o})]})};class Gy extends Gm{constructor(e){super(jm.Matter,e)}async getMatterById(e){const t=this.networkService.getDocument(e,jm.Matter);return this.createModel(t,rf,"getMatterById(".concat(e,")"))}}class Hy{constructor(e){this.id=e.id,this.matter_ref=e.matter_ref.id,this.status=e.status,this.update_datetime=Km(e.update_datetime),e.event_minutes_item_ref&&(e.event_minutes_item_ref instanceof Kh?this.event_minutes_item_ref=e.event_minutes_item_ref.id:"object"===typeof e.event_minutes_item_ref&&(this.event_minutes_item=new of(e.event_minutes_item_ref))),e.external_source_id&&(this.external_source_id=e.external_source_id),"object"!==typeof e.matter_ref||e.matter_ref instanceof Kh||(this.matter=new rf(e.matter_ref))}}class Wy extends Gm{constructor(e){super(jm.MatterStatus,e)}async getMatterStatusesByMatterId(e){const t=new Bm(jm.EventMinutesItem,Lm.EventMinutesItemEventRef),n=new Bm(jm.MatterStatus,Lm.MatterStatusEventMinutesItemRef,new Fm([t])),r=this.networkService.getDocuments(jm.MatterStatus,[Cd(Lm.MatterStatusMatterRef,Hm.eq,Jh(zm.getDb(),jm.Matter,e)),kd("update_datetime",Wm.desc)],new Fm([n]));return this.createModels(r,Hy,"getMatterStatusByMatterId(".concat(e,")"))}}const Ky=()=>{const{firebaseConfig:e}=Z(),{id:t}=Object(l.i)(),n=Object(a.useCallback)(async()=>{const n=new Gy(e),r=new Wy(e),i=new $g(e),s=new ap(e),o=n.getMatterById(t),a=i.getMatterSponsorByMatterId(t),c=r.getMatterStatusesByMatterId(t),l=await Promise.all([o,a,c]),[u,h,d]=l,m=h.filter(e=>e.person).map(e=>e.person),p=d.reduce((e,t)=>(t.event_minutes_item&&e.push(t.event_minutes_item),e),[]),f=d[0];f.matter=u;const g={matterStatus:f,indexedMatterGrams:[],sponsors:m,legislationHistory:p};let y;for(const e of d)if(e.event_minutes_item){y=e.event_minutes_item;break}if(y){const t=new df(e),n=await Promise.all([t.getVotesByEventMinutesItemId(y.id),s.getEventById(y.event_ref)]);g.votes=n[0],g.event=n[1]}return g},[e,t]),{state:r}=ep({isLoading:!1,error:null,hasFetchRequest:!0},n);return K(Xm,{isLoading:r.isLoading,error:r.error,children:r.data&&K(qy,{indexedMatterGrams:r.data.indexedMatterGrams,matterStatus:r.data.matterStatus,sponsors:r.data.sponsors,event:r.data.event,votes:r.data.votes,legislationHistory:r.data.legislationHistory})})};const Qy=h.a.div({minHeight:"100vh",display:"flex",flexDirection:"column"}),Yy=h.a.main({boxSizing:"border-box",width:"100%",padding:"16px",flex:1,alignSelf:"center",display:"flex",flexDirection:"column",["@media (min-width:".concat(oe,")")]:{padding:"32px",maxWidth:"1280px"}}),Jy=e=>{let{municipalityName:t}=e;return K(f.a,{municipalityName:t})},Xy=()=>K(g.a,{}),Zy=e=>{let{municipalityName:t}=e;return Q(a.Fragment,{children:[K(Jy,{municipalityName:t}),K(Yy,{children:Q(l.d,{children:[K(l.b,{exact:!0,path:"/",children:K(Fg,{})}),K(l.b,{exact:!0,path:"/".concat(fe.EVENT),children:K(Fg,{})}),K(l.b,{exact:!0,path:"/".concat(fe.EVENT,"/search"),children:K(Zp,{})}),K(l.b,{exact:!0,path:"/".concat(fe.EVENT,"/:id"),children:K(jg,{})}),K(l.b,{exact:!0,path:"/people",children:K(l.a,{to:"/events"})}),K(l.b,{exact:!0,path:"/people/:id",children:K(l.a,{to:"/events"})}),K(l.b,{exact:!0,path:"/matters/:id",children:K(l.a,{to:"/events"})}),K(l.b,{path:"*",children:K(l.a,{to:"/events"})})]})}),K(Xy,{})]})};function $y(){var e;const{municipality:t,features:n}=Z();ne("Council Data Project | ".concat(null!==(e=null===t||void 0===t?void 0:t.name)&&void 0!==e?e:"Searchable"," - Searchable"));const r=!(!n||!n.singlePageEvents),[i,o]=Object(a.useState)(Jp[0]);return K(Y,{children:K(ee,{languageConfig:{language:i,setLanguage:o},children:Q(u.a,{basename:"/",children:[K(d.a,{styles:Object(d.b)(L||(L=Object(s.a)(["\n              html,\n              body {\n                font-size: 100%;\n              }\n\n              body {\n                font-family: Inter, X-LocaleSpecific, sans-serif;\n              }\n            "])))}),K(Qy,{children:r?K(Zy,{municipalityName:t.name}):Q(a.Fragment,{children:[K(me,{municipalityName:t.name}),K(Yy,{children:Q(l.d,{children:[K(l.b,{exact:!0,path:"/",children:K(Me,{})}),K(l.b,{exact:!0,path:"/".concat(fe.EVENT),children:K(Fg,{})}),K(l.b,{exact:!0,path:"/".concat(fe.EVENT,"/search"),children:K(Zp,{})}),K(l.b,{exact:!0,path:"/".concat(fe.EVENT,"/:id"),children:K(jg,{})}),K(l.b,{exact:!0,path:"/people",children:K(by,{})}),K(l.b,{exact:!0,path:"/people/:id",children:K(my,{})}),K(l.b,{exact:!0,path:"/matters/:id",children:K(Ky,{})}),K(l.b,{path:"*",component:Jm})]})}),K(pe,{footerLinksSections:t.footerLinksSections})]})})]})})})}h.a.div({display:"flex",flexWrap:"wrap","& > span":{whiteSpace:"pre-wrap"}}),h.a.div({marginBottom:16,display:"flex",flexDirection:"column",["@media (min-width:".concat(oe,")")]:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},"& > h1":{marginBottom:0},"& > :last-child":{fontSize:Up}})}).call(this,n(48),n(157))},171:function(e,t,n){"use strict";(function(e){n.d(t,"a",function(){return c});var r=n(0),i=n.n(r),s=n(11),o=n(28),a=n(15);function c(t){let{municipalityName:n}=t;const r=("undefined"!==typeof e&&Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}),""),c="".concat(r,"/wayne-county-courthouse-hero.webp"),l=Object(s.h)(),u=function(e){const t=[{to:"/",label:"Home"}],n=String(e||"/").split("/").filter(Boolean);if(0===n.length)return t;const[r,i]=n;if("events"===r)return t.push({to:"/events",label:"Events"}),"search"===i?t.push({to:"/events/search",label:"Search"}):i&&t.push({to:"/events/".concat(i),label:"Meeting"}),t;if("people"===r)return t.push({to:"/people",label:"People"}),i&&t.push({to:"/people/".concat(i),label:"Person"}),t;if("matters"===r)return t.push({to:"/matters",label:"Matters"}),i&&t.push({to:"/matters/".concat(i),label:"Matter"}),t;const s=decodeURIComponent(r).replace(/[-_]+/g," ");return t.push({to:"/".concat(r),label:s.charAt(0).toUpperCase()+s.slice(1)}),t}(l&&l.pathname);return Object(a.jsxs)(i.a.Fragment,{children:[Object(a.jsxs)("section",{className:"cdp-local-hero",style:{position:"relative",backgroundColor:"#0b1b26",backgroundImage:"url(".concat(c,")"),backgroundSize:"cover",backgroundPosition:"center"},children:[Object(a.jsx)("div",{"aria-hidden":"true",style:{position:"absolute",inset:0,background:"linear-gradient(180deg, rgba(11,27,38,0.72) 0%, rgba(11,27,38,0.84) 55%, rgba(11,27,38,0.92) 100%)"}}),Object(a.jsx)("div",{className:"mzp-l-content",style:{position:"relative",paddingTop:56,paddingBottom:56},children:Object(a.jsxs)("div",{style:{maxWidth:980},children:[Object(a.jsx)("p",{className:"mzp-u-title-2xs",style:{color:"rgba(255,255,255,0.85)",marginTop:0,marginBottom:12,letterSpacing:"0.08em",textTransform:"uppercase"},children:n}),Object(a.jsx)("h1",{className:"mzp-u-title-lg",style:{color:"white",marginTop:0,marginBottom:12,textShadow:"0 1px 18px rgba(0,0,0,0.35)"},children:"Public Meetings"}),Object(a.jsx)("p",{className:"mzp-u-body-lg",style:{color:"rgba(255,255,255,0.88)",margin:0,maxWidth:760},children:"Search recent meetings and transcripts."}),Object(a.jsx)("p",{style:{marginTop:28,marginBottom:0,fontSize:12,lineHeight:1.4,color:"rgba(255,255,255,0.70)",maxWidth:760},children:"Unofficial community project \u2022 Transcripts are auto-generated and may contain errors."})]})})]}),Object(a.jsx)("div",{style:{borderBottom:"1px solid rgba(0,0,0,0.08)",background:"#f9f9fb"},children:Object(a.jsx)("div",{className:"mzp-l-content",style:{paddingTop:12,paddingBottom:12},children:Object(a.jsx)("div",{style:{maxWidth:980},children:Object(a.jsx)("nav",{"aria-label":"Breadcrumb",style:{display:"flex",flexWrap:"wrap",gap:10,alignItems:"center"},children:u.map((e,t)=>{const n=t===u.length-1;return Object(a.jsxs)(i.a.Fragment,{children:[t>0?Object(a.jsx)("span",{style:{color:"rgba(0,0,0,0.35)"},"aria-hidden":"true",children:"/"}):null,n?Object(a.jsx)("span",{style:{color:"rgba(0,0,0,0.78)",fontSize:14},children:e.label}):Object(a.jsx)(o.b,{to:e.to,style:{color:"rgba(0,0,0,0.82)",fontSize:14,textDecoration:"none",borderBottom:"1px solid rgba(0,0,0,0.25)",paddingBottom:1},children:e.label})]},"".concat(e.to,":").concat(e.label))})})})})})]})}}).call(this,n(157))},172:function(e,t,n){"use strict";n.d(t,"a",function(){return i});n(0);var r=n(15);function i(){return Object(r.jsx)("footer",{className:"mzp-c-footer cdp-local-footer",style:{marginTop:48,paddingTop:40,paddingBottom:40},children:Object(r.jsx)("div",{className:"mzp-l-content",children:Object(r.jsxs)("div",{style:{maxWidth:980,margin:"0 auto"},children:[Object(r.jsx)("h2",{className:"mzp-u-title-sm",style:{marginTop:0,marginBottom:16,color:"inherit"},children:"About this project"}),Object(r.jsxs)("p",{style:{marginTop:0,marginBottom:12,fontSize:"1.05em"},children:["This is a public tool for browsing recent local government meetings in Richmond and Wayne County, Indiana. It is powered by the open-source"," ",Object(r.jsx)("a",{href:"https://councildataproject.org",target:"_blank",rel:"noopener noreferrer external",children:"Council Data Project"})," ","and maintained independently."]}),Object(r.jsxs)("p",{style:{marginTop:0,marginBottom:12},children:["View the source code or contribute on"," ",Object(r.jsx)("a",{href:"https://github.com/jbax1899/cdp-richmond-indiana",target:"_blank",rel:"noopener noreferrer external",children:"GitHub"}),"."]}),Object(r.jsxs)("p",{style:{marginTop:0,marginBottom:20},children:["Have feedback or corrections?"," ",Object(r.jsx)("a",{href:"mailto:richmondmeetings@protonmail.com",children:"Reach out via email"})," or"," ",Object(r.jsx)("a",{href:"https://github.com/jbax1899/cdp-richmond-indiana/issues",target:"_blank",rel:"noopener noreferrer external",children:"Open an issue on GitHub"}),"."]}),Object(r.jsx)("hr",{style:{border:0,borderTop:"1px solid rgba(255,255,255,0.18)",marginTop:24,marginBottom:24}}),Object(r.jsxs)("div",{style:{fontSize:"0.93em",opacity:.9,lineHeight:1.55},children:[Object(r.jsx)("p",{style:{marginTop:0,marginBottom:10},children:"Transcripts are auto-generated and may contain errors."}),Object(r.jsx)("p",{style:{marginTop:0,marginBottom:10},children:"Content \xa9 individual contributors."}),Object(r.jsxs)("p",{style:{marginTop:0,marginBottom:10},children:["Site source code licensed under"," ",Object(r.jsx)("a",{href:"https://www.mozilla.org/MPL/2.0/",target:"_blank",rel:"noopener noreferrer external",children:"MPL-2.0"}),"."]}),Object(r.jsx)("p",{style:{marginTop:0,marginBottom:10},children:"Meeting media is hosted on Internet Archive; rights and licensing are determined by the original publishers and the source item pages."}),Object(r.jsxs)("p",{style:{marginTop:0,marginBottom:10},children:["Styled using"," ",Object(r.jsx)("a",{href:"https://protocol.mozilla.org",target:"_blank",rel:"noopener noreferrer external",children:"Mozilla Protocol"}),". Artwork by"," ",Object(r.jsx)("a",{href:"https://undraw.co",target:"_blank",rel:"noopener noreferrer external",children:"unDraw"}),"."]}),Object(r.jsxs)("p",{style:{marginTop:16,marginBottom:0},children:["Hero image:"," ",Object(r.jsx)("a",{href:"https://commons.wikimedia.org/wiki/File:WayneCountyCourthouse.jpg",target:"_blank",rel:"noopener noreferrer external",children:"WayneCountyCourthouse.jpg"})," ","by"," ",Object(r.jsx)("a",{href:"https://commons.wikimedia.org/wiki/User:Greg5030",target:"_blank",rel:"noopener noreferrer external",children:"Greg Hume"}),", licensed under"," ",Object(r.jsx)("a",{href:"https://creativecommons.org/licenses/by-sa/3.0/",target:"_blank",rel:"noopener noreferrer external",children:"CC BY-SA 3.0"}),"."]})]})]})})})}},184:function(e,t,n){"use strict";n.r(t);n(0);var r=n(49),i=n.n(r),s=n(145),o=(n(293),n(15));i.a.render(Object(o.jsx)("div",{children:Object(o.jsx)(s.b,{appConfig:{firebaseConfig:{options:{projectId:"cdp-richmond-in-jvrzndvq",storageBucket:"cdp-richmond-in-jvrzndvq.appspot.com"},settings:{}},municipality:{name:"Richmond & Wayne County, Indiana",timeZone:"America/Indiana/Indianapolis",footerLinksSections:[]},features:{singlePageEvents:!0}},children:Object(o.jsx)(s.a,{})})}),document.getElementById("root"))},275:function(e,t){}},[[184,1,2]]]);
//# sourceMappingURL=main.2d0b5118.chunk.js.map